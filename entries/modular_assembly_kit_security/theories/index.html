<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1"><title>Session Modular_Assembly_Kit_Security - Archive of Formal Proofs</title><meta name=description content="A collection of proof libraries, examples, and larger scientific developments, mechanically checked in the theorem prover Isabelle."><meta property="og:title" content="Session Modular_Assembly_Kit_Security">
<meta property="og:description" content>
<meta property="og:type" content="article">
<meta property="og:url" content="/entries/modular_assembly_kit_security/theories/"><meta property="og:image" content="/images/afp.png"><meta property="article:section" content="theories">
<meta property="og:site_name" content="Archive of Formal Proofs">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="/images/afp.png">
<meta name=twitter:title content="Session Modular_Assembly_Kit_Security">
<meta name=twitter:description content>
<link rel=stylesheet type=text/css href=/css/front.min.css><link rel=stylesheet type=text/css href=/css/isabelle.css>
<link rel=icon href=/images/favicon.ico type=image/icon><script src=/js/flexsearch.min.js></script>
<script src=/js/banner.js></script><script src=/js/header-search.js></script></head>
<body class=mathjax_ignore>
<aside>
<div>
<div>
<a href=/>
<img src=/images/afp.png alt="Logo of the Archive of Formal Proofs" class=logo>
</a>
<ul>
<li><a href=/entries/modular_assembly_kit_security>Return to entry</a></li>
</ul>
<hr>
<ul><li><a href=#Projection>Projection</a>
<ul>
<li><a href=#Projection-projection_on_union>projection_on_union</a></li>
<li><a href=#Projection-projection_on_empty_trace>projection_on_empty_trace</a></li>
<li><a href=#Projection-projection_to_emptyset_is_empty_trace>projection_to_emptyset_is_empty_trace</a></li>
<li><a href=#Projection-projection_idempotent>projection_idempotent</a></li>
<li><a href=#Projection-projection_empty_implies_absence_of_events>projection_empty_implies_absence_of_events</a></li>
<li><a href=#Projection-disjoint_projection>disjoint_projection</a></li>
<li><a href=#Projection-projection_concatenation_commute>projection_concatenation_commute</a></li>
<li><a href=#Projection-projection_subset_eq_from_superset_eq>projection_subset_eq_from_superset_eq</a></li>
<li><a href=#Projection-list_subset_iff_projection_neutral>list_subset_iff_projection_neutral</a></li>
<li><a href=#Projection-projection_split_last>projection_split_last</a></li>
<li><a href=#Projection-projection_rev_commute>projection_rev_commute</a></li>
<li><a href=#Projection-projection_split_first>projection_split_first</a></li>
<li><a href=#Projection-projection_split_first_with_suffix>projection_split_first_with_suffix</a></li>
<li><a href=#Projection-projection_split_arbitrary_element>projection_split_arbitrary_element</a></li>
<li><a href=#Projection-projection_on_intersection>projection_on_intersection</a></li>
<li><a href=#Projection-projection_on_subset>projection_on_subset</a></li>
<li><a href=#Projection-projection_on_subset2>projection_on_subset2</a></li>
<li><a href=#Projection-non_empty_projection_on_subset>non_empty_projection_on_subset</a></li>
<li><a href=#Projection-projection_intersection_neutral>projection_intersection_neutral</a></li>
<li><a href=#Projection-projection_commute>projection_commute</a></li>
<li><a href=#Projection-projection_subset_elim>projection_subset_elim</a></li>
<li><a href=#Projection-projection_sequence>projection_sequence</a></li>
<li><a href=#Projection-merge_property>merge_property</a></li>
</ul>
</li><li><a href=#Prefix>Prefix</a>
<ul>
<li><a href=#Prefix-empty_prefix_of_all>empty_prefix_of_all</a></li>
<li><a href=#Prefix-empty_trace_contained>empty_trace_contained</a></li>
<li><a href=#Prefix-transitive_prefix>transitive_prefix</a></li>
</ul>
</li><li><a href=#EventSystems>EventSystems</a>
<ul>
<li><a href=#EventSystems-totality>totality</a></li>
<li><a href=#EventSystems-composeES_yields_ES>composeES_yields_ES</a></li>
</ul>
</li><li><a href=#StateEventSystems>StateEventSystems</a>
<ul>
<li><a href=#StateEventSystems-none_remains_none>none_remains_none</a></li>
<li><a href=#StateEventSystems-path_trans_single_neg>path_trans_single_neg</a></li>
<li><a href=#StateEventSystems-path_split_single>path_split_single</a></li>
<li><a href=#StateEventSystems-path_trans_single>path_trans_single</a></li>
<li><a href=#StateEventSystems-path_split>path_split</a></li>
<li><a href=#StateEventSystems-path_trans>path_trans</a></li>
<li><a href=#StateEventSystems-enabledPrefixSingle>enabledPrefixSingle</a></li>
<li><a href=#StateEventSystems-enabledPrefix>enabledPrefix</a></li>
<li><a href=#StateEventSystems-enabledPrefixSingleFinalStep>enabledPrefixSingleFinalStep</a></li>
<li><a href=#StateEventSystems-induceES_yields_ES>induceES_yields_ES</a></li>
</ul>
</li><li><a href=#Views>Views</a>
</li><li><a href=#FlowPolicies>FlowPolicies</a>
</li><li><a href=#BasicSecurityPredicates>BasicSecurityPredicates</a>
<ul>
<li><a href=#BasicSecurityPredicates-BSP_valid_R>BSP_valid_R</a></li>
<li><a href=#BasicSecurityPredicates-BSP_valid_D>BSP_valid_D</a></li>
<li><a href=#BasicSecurityPredicates-BSP_valid_I>BSP_valid_I</a></li>
<li><a href=#BasicSecurityPredicates-BSP_valid_IA>BSP_valid_IA</a></li>
<li><a href=#BasicSecurityPredicates-BSP_valid_BSD>BSP_valid_BSD</a></li>
<li><a href=#BasicSecurityPredicates-BSP_valid_BSI>BSP_valid_BSI</a></li>
<li><a href=#BasicSecurityPredicates-BSP_valid_BSIA>BSP_valid_BSIA</a></li>
<li><a href=#BasicSecurityPredicates-BSP_valid_FCD>BSP_valid_FCD</a></li>
<li><a href=#BasicSecurityPredicates-BSP_valid_FCI>BSP_valid_FCI</a></li>
<li><a href=#BasicSecurityPredicates-BSP_valid_FCIA>BSP_valid_FCIA</a></li>
</ul>
</li><li><a href=#InformationFlowProperties>InformationFlowProperties</a>
</li><li><a href=#BSPTaxonomy>BSPTaxonomy</a>
<ul>
<li><a href=#BSPTaxonomy-SR_implies_R>SR_implies_R</a></li>
<li><a href=#BSPTaxonomy-SD_implies_BSD>SD_implies_BSD</a></li>
<li><a href=#BSPTaxonomy-BSD_implies_D>BSD_implies_D</a></li>
<li><a href=#BSPTaxonomy-SD_implies_SR>SD_implies_SR</a></li>
<li><a href=#BSPTaxonomy-D_implies_R>D_implies_R</a></li>
<li><a href=#BSPTaxonomy-SR_implies_R_for_modified_view>SR_implies_R_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-R_implies_SR_for_modified_view>R_implies_SR_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-SD_implies_BSD_for_modified_view>SD_implies_BSD_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-BSD_implies_SD_for_modified_view>BSD_implies_SD_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-SD_implies_FCD>SD_implies_FCD</a></li>
<li><a href=#BSPTaxonomy-SI_implies_BSI>SI_implies_BSI</a></li>
<li><a href=#BSPTaxonomy-BSI_implies_I>BSI_implies_I</a></li>
<li><a href=#BSPTaxonomy-SIA_implies_BSIA>SIA_implies_BSIA</a></li>
<li><a href=#BSPTaxonomy-BSIA_implies_IA>BSIA_implies_IA</a></li>
<li><a href=#BSPTaxonomy-SI_implies_SIA>SI_implies_SIA</a></li>
<li><a href=#BSPTaxonomy-BSI_implies_BSIA>BSI_implies_BSIA</a></li>
<li><a href=#BSPTaxonomy-I_implies_IA>I_implies_IA</a></li>
<li><a href=#BSPTaxonomy-SI_implies_BSI_for_modified_view>SI_implies_BSI_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-BSI_implies_SI_for_modified_view>BSI_implies_SI_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-SIA_implies_BSIA_for_modified_view>SIA_implies_BSIA_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-BSIA_implies_SIA_for_modified_view>BSIA_implies_SIA_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-Adm_implies_Adm_for_modified_rho>Adm_implies_Adm_for_modified_rho</a></li>
<li><a href=#BSPTaxonomy-SI_implies_FCI>SI_implies_FCI</a></li>
<li><a href=#BSPTaxonomy-SIA_implies_FCIA>SIA_implies_FCIA</a></li>
<li><a href=#BSPTaxonomy-FCI_implies_FCIA>FCI_implies_FCIA</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_SR_C_empty>Trivially_fulfilled_SR_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_R_C_empty>Trivially_fulfilled_R_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_SD_C_empty>Trivially_fulfilled_SD_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_BSD_C_empty>Trivially_fulfilled_BSD_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_D_C_empty>Trivially_fulfilled_D_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCD_C_empty>Trivially_fulfilled_FCD_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fullfilled_R_V_empty>Trivially_fullfilled_R_V_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_BSD_V_empty>Trivially_fulfilled_BSD_V_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_D_V_empty>Trivially_fulfilled_D_V_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCD_V_empty>Trivially_fulfilled_FCD_V_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCD_Nabla_%ce%a5_empty>Trivially_fulfilled_FCD_Nabla_Υ_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCD_N_subseteq_%ce%94_and_BSD>Trivially_fulfilled_FCD_N_subseteq_Δ_and_BSD</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_SI_C_empty>Trivially_fulfilled_SI_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_BSI_C_empty>Trivially_fulfilled_BSI_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_I_C_empty>Trivially_fulfilled_I_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCI_C_empty>Trivially_fulfilled_FCI_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_SIA_C_empty>Trivially_fulfilled_SIA_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_BSIA_C_empty>Trivially_fulfilled_BSIA_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_IA_C_empty>Trivially_fulfilled_IA_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCIA_C_empty>Trivially_fulfilled_FCIA_C_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCI_V_empty>Trivially_fulfilled_FCI_V_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCIA_V_empty>Trivially_fulfilled_FCIA_V_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_BSIA_V_empty_rho_subseteq_C_N>Trivially_fulfilled_BSIA_V_empty_rho_subseteq_C_N</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_IA_V_empty_rho_subseteq_C_N>Trivially_fulfilled_IA_V_empty_rho_subseteq_C_N</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_BSI_V_empty_total_ES_C>Trivially_fulfilled_BSI_V_empty_total_ES_C</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_I_V_empty_total_ES_C>Trivially_fulfilled_I_V_empty_total_ES_C</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCI_Nabla_%ce%a5_empty>Trivially_fulfilled_FCI_Nabla_Υ_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCIA_Nabla_%ce%a5_empty>Trivially_fulfilled_FCIA_Nabla_Υ_empty</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCI_N_subseteq_%ce%94_and_BSI>Trivially_fulfilled_FCI_N_subseteq_Δ_and_BSI</a></li>
<li><a href=#BSPTaxonomy-Trivially_fulfilled_FCIA_N_subseteq_%ce%94_and_BSIA>Trivially_fulfilled_FCIA_N_subseteq_Δ_and_BSIA</a></li>
<li><a href=#BSPTaxonomy-R_implies_R_for_modified_view>R_implies_R_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-BSD_implies_BSD_for_modified_view>BSD_implies_BSD_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-D_implies_D_for_modified_view>D_implies_D_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-FCD_implies_FCD_for_modified_view_gamma>FCD_implies_FCD_for_modified_view_gamma</a></li>
<li><a href=#BSPTaxonomy-SI_implies_SI_for_modified_view>SI_implies_SI_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-BSI_implies_BSI_for_modified_view>BSI_implies_BSI_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-I_implies_I_for_modified_view>I_implies_I_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-SIA_implies_SIA_for_modified_view>SIA_implies_SIA_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-BSIA_implies_BSIA_for_modified_view>BSIA_implies_BSIA_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-IA_implies_IA_for_modified_view>IA_implies_IA_for_modified_view</a></li>
<li><a href=#BSPTaxonomy-FCI_implies_FCI_for_modified_view_gamma>FCI_implies_FCI_for_modified_view_gamma</a></li>
<li><a href=#BSPTaxonomy-FCIA_implies_FCIA_for_modified_view_rho_gamma>FCIA_implies_FCIA_for_modified_view_rho_gamma</a></li>
</ul>
</li><li><a href=#PropertyLibrary>PropertyLibrary</a>
<ul>
<li><a href=#PropertyLibrary-GNI_valid>GNI_valid</a></li>
<li><a href=#PropertyLibrary-IBGNI_valid>IBGNI_valid</a></li>
<li><a href=#PropertyLibrary-FC_valid>FC_valid</a></li>
<li><a href=#PropertyLibrary-NDO_valid>NDO_valid</a></li>
<li><a href=#PropertyLibrary-NF_valid>NF_valid</a></li>
<li><a href=#PropertyLibrary-GNF_valid>GNF_valid</a></li>
<li><a href=#PropertyLibrary-SEP_valid>SEP_valid</a></li>
<li><a href=#PropertyLibrary-PSP_valid>PSP_valid</a></li>
</ul>
</li><li><a href=#SecureSystems>SecureSystems</a>
</li><li><a href=#UnwindingConditions>UnwindingConditions</a>
</li><li><a href=#AuxiliaryLemmas>AuxiliaryLemmas</a>
<ul>
<li><a href=#AuxiliaryLemmas-osc_property>osc_property</a></li>
<li><a href=#AuxiliaryLemmas-path_state_closure>path_state_closure</a></li>
<li><a href=#AuxiliaryLemmas-state_from_induceES_trace>state_from_induceES_trace</a></li>
<li><a href=#AuxiliaryLemmas-path_split2>path_split2</a></li>
<li><a href=#AuxiliaryLemmas-path_split_single2>path_split_single2</a></li>
<li><a href=#AuxiliaryLemmas-modified_view_valid>modified_view_valid</a></li>
</ul>
</li><li><a href=#UnwindingResults>UnwindingResults</a>
</li><li><a href=#CompositionBase>CompositionBase</a>
<ul>
<li><a href=#CompositionBase-Vv_is_Vv1_union_Vv2>Vv_is_Vv1_union_Vv2</a></li>
<li><a href=#CompositionBase-disjoint_Nv1_Vv2>disjoint_Nv1_Vv2</a></li>
<li><a href=#CompositionBase-disjoint_Nv2_Vv1>disjoint_Nv2_Vv1</a></li>
<li><a href=#CompositionBase-merge_property%27>merge_property'</a></li>
<li><a href=#CompositionBase-Nv1_union_Nv2_subsetof_Nv>Nv1_union_Nv2_subsetof_Nv</a></li>
</ul>
</li><li><a href=#CompositionSupport>CompositionSupport</a>
<ul>
<li><a href=#CompositionSupport-BSD_in_subsystem>BSD_in_subsystem</a></li>
<li><a href=#CompositionSupport-BSD_in_subsystem2>BSD_in_subsystem2</a></li>
</ul>
</li><li><a href=#GeneralizedZippingLemma>GeneralizedZippingLemma</a>
<ul>
<li><a href=#GeneralizedZippingLemma-generalized_zipping_lemma1>generalized_zipping_lemma1</a></li>
<li><a href=#GeneralizedZippingLemma-generalized_zipping_lemma2>generalized_zipping_lemma2</a></li>
<li><a href=#GeneralizedZippingLemma-generalized_zipping_lemma3>generalized_zipping_lemma3</a></li>
<li><a href=#GeneralizedZippingLemma-generalized_zipping_lemma4>generalized_zipping_lemma4</a></li>
<li><a href=#GeneralizedZippingLemma-generalized_zipping_lemma>generalized_zipping_lemma</a></li>
</ul>
</li><li><a href=#CompositionalityResults>CompositionalityResults</a>
</li>
</ul>
</div>
<ul>
<li><a href=https://www.isa-afp.org/browser_info/current/AFP/Modular_Assembly_Kit_Security/outline.pdf>Proof
outline</a></li>
<li><a href=https://www.isa-afp.org/browser_info/current/AFP/Modular_Assembly_Kit_Security/document.pdf>Proof
document</a></li>
<li><a href=https://www.isa-afp.org/browser_info/current/AFP/Modular_Assembly_Kit_Security/session_graph.pdf>Theory dependencies</a></li>
</ul>
</div>
</aside>
<div class="content theories"><header>
<form action=/search>
<div class=form-container>
<input id=searchInput type=search size=31 maxlength=255 aria-label="Search the AFP" list=autocomplete><button id=searchButton type=button><img src=/images/search.svg alt=Search></button>
<datalist id=autocomplete>
</datalist>
</div>
</form>
<h1><span class=first>S</span>ession <span class=first>M</span>odular_<span class=first>A</span>ssembly_<span class=first>K</span>it_<span class=first>S</span>ecurity</h1>
<div>
</div>
</header><div id=banner data-id=0>
<p>This is an unofficial reimagining of the <a href=https://isa-afp.org target=_blank rel="noreferrer noopener">Archive of Formal Proofs</a></p><button style=display:none id=close title=close><svg viewBox="0 0 6.718 6.718" aria-hidden="true" focusable="false"><rect transform="rotate(45)" x="4" y="-4" width="1.5" height="8"/><rect transform="rotate(45)" x=".75" y="-.75" width="8" height="1.5"/></svg></button>
</div>
<div><main>
<div id=Projection>
<div class=head>
<h1>Theory Projection</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> Projection
<span class=keyword2><span class=keyword>imports</span></span> <a href=https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/HOL/HOL/Main.html>Main</a>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* Projection of an event list onto a subset of the events *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>projection</span><span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> list <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> list"</span></span> <span class=main>(</span><span class=keyword2><span class=keyword>infixl</span></span> <span class=quoted>"<span class=keyword1>↿</span>"</span> 100<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free><span class=bound><span class=entity>l</span></span></span> <span class=main><span class=free>↿</span></span> <span class=free><span class=bound><span class=entity>E</span></span></span> <span class=main>≡</span> filter <span class=main>(</span><span class=main>λ</span><span class=bound>x</span> <span class=main>.</span> <span class=bound>x</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>E</span></span></span><span class=main>)</span> <span class=free><span class=bound><span class=entity>l</span></span></span>"</span></span>

<span class=comment1>(* If projecting on Y yields the empty sequence, then projecting
  on X ∪ Y yields the projection on X. *)</span>
<span class=keyword1 id=Projection-projection_on_union><span class=command>lemma</span></span> projection_on_union<span class=main>:</span> 
  <span class=quoted><span class=quoted>"<span class=free>l</span> <span class=main>↿</span> <span class=free>Y</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>⟹</span> <span class=free>l</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∪</span> <span class=free>Y</span><span class=main>)</span> <span class=main>=</span> <span class=free>l</span> <span class=main>↿</span> <span class=free>X</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>l</span></span><span class=main>)</span>
  <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>a</span> <span class=skolem>b</span><span class=main>)</span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=quoted>"<span class=skolem>a</span> <span class=main>∈</span> <span class=free>Y</span>"</span></span><span class=main>)</span>
    <span class=keyword3><span class=command>case</span></span> True <span class=keyword1><span class=command>from</span></span> Cons <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>a</span> <span class=main>∈</span> <span class=free>Y</span> <span class=main>⟹</span> <span class=main>(</span><span class=skolem>a</span> <span class=main>#</span> <span class=skolem>b</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∪</span> <span class=free>Y</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>a</span> <span class=main>#</span> <span class=skolem>b</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
  <span class=keyword1><span class=command>next</span></span>
    <span class=keyword3><span class=command>case</span></span> False <span class=keyword1><span class=command>from</span></span> Cons <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>a</span> <span class=main>∉</span> <span class=free>Y</span> <span class=main>⟹</span> <span class=main>(</span><span class=skolem>a</span> <span class=main>#</span> <span class=skolem>b</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∪</span> <span class=free>Y</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>a</span> <span class=main>#</span> <span class=skolem>b</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(*projection on the empty trace yields the empty trace*)</span>
<span class=keyword1 id=Projection-projection_on_empty_trace><span class=command>lemma</span></span> projection_on_empty_trace<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span><span class=main>[]</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>

<span class=comment1>(*projection to the empty set yields the empty trace*)</span>
<span class=keyword1 id=Projection-projection_to_emptyset_is_empty_trace><span class=command>lemma</span></span> projection_to_emptyset_is_empty_trace<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>l</span> <span class=main>↿</span><span class=main>{}</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>

<span class=comment1>(*projection is idempotent*)</span>
<span class=keyword1 id=Projection-projection_idempotent><span class=command>lemma</span></span> projection_idempotent<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>l</span> <span class=main>↿</span> <span class=free>X</span><span class=main>=</span> <span class=main>(</span><span class=free>l</span> <span class=main>↿</span><span class=free>X</span><span class=main>)</span> <span class=main>↿</span><span class=free>X</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span> 

<span class=comment1>(*empty projection implies that the trace contains no events of the set the trace is projected to*)</span>
<span class=keyword1 id=Projection-projection_empty_implies_absence_of_events><span class=command>lemma</span></span> projection_empty_implies_absence_of_events<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>l</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>⟹</span>  <span class=free>X</span> <span class=main>∩</span> <span class=main>(</span>set <span class=free>l</span><span class=main>)</span> <span class=main>=</span> <span class=main>{}</span>"</span></span> 
 <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> empty_set inter_set_filter projection_def<span class=main>)</span>

<span class=comment1>(*subsequently projecting to two disjoint sets yields the empty trace*)</span>
<span class=keyword1 id=Projection-disjoint_projection><span class=command>lemma</span></span> disjoint_projection<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>X</span> <span class=main>∩</span> <span class=free>Y</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> <span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>↿</span> <span class=free>Y</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> X_Y_disjoint<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>X</span> <span class=main>∩</span> <span class=free>Y</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
  <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>↿</span> <span class=free>Y</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> <span class=keyword1><span class=command>unfolding</span></span> projection_def 
  <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>l</span></span><span class=main>)</span>
    <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
  <span class=keyword1><span class=command>next</span></span>
    <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> <span class=free>X</span>"</span></span><span class=main>)</span>
      <span class=keyword3><span class=command>case</span></span> True
      <span class=keyword1><span class=command>with</span></span> X_Y_disjoint <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∉</span> <span class=free>Y</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=bound>x</span><span class=main>←</span><span class=main>[</span><span class=bound>x</span><span class=main>←</span><span class=skolem>x</span> <span class=main>#</span> <span class=skolem>xs</span> <span class=main>.</span> <span class=bound>x</span> <span class=main>∈</span> <span class=free>X</span><span class=main>]</span> <span class=main>.</span> <span class=bound>x</span> <span class=main>∈</span> <span class=free>Y</span><span class=main>]</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> <span class=keyword1><span class=command>using</span></span> Cons.hyps <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> False <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=bound>x</span><span class=main>←</span><span class=main>[</span><span class=bound>x</span><span class=main>←</span><span class=skolem>x</span> <span class=main>#</span> <span class=skolem>xs</span> <span class=main>.</span> <span class=bound>x</span> <span class=main>∈</span> <span class=free>X</span><span class=main>]</span> <span class=main>.</span> <span class=bound>x</span> <span class=main>∈</span> <span class=free>Y</span><span class=main>]</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> <span class=keyword1><span class=command>using</span></span> Cons.hyps False <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>qed</span></span>  
<span class=keyword1><span class=command>qed</span></span>      

<span class=comment1>(* auxiliary lemmas for projection *)</span>
<span class=keyword1 id=Projection-projection_concatenation_commute><span class=command>lemma</span></span> projection_concatenation_commute<span class=main>:</span>
  <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>l1</span> <span class=main>@</span> <span class=free>l2</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>(</span><span class=free>l1</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=free>l2</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold</span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

<span class=comment1>(* Lists that are equal under projection on a set will remain 
equal under projection on a subset. *)</span>
<span class=keyword1 id=Projection-projection_subset_eq_from_superset_eq><span class=command>lemma</span></span> projection_subset_eq_from_superset_eq<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=free>xs</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∪</span> <span class=free>Y</span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ys</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∪</span> <span class=free>Y</span><span class=main>)</span><span class=main>)</span><span class=main>)</span> <span class=main>⟹</span> <span class=main>(</span><span class=main>(</span><span class=free>xs</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ys</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span><span class=main>)</span>"</span></span>
<span class=main>(</span><span class=keyword2><span class=keyword>is</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L1</span> <span class=main>=</span> <span class=var>?L2</span><span class=main>)</span> <span class=main>⟹</span> <span class=main>(</span><span class=var>?L3</span> <span class=main>=</span> <span class=var>?L4</span><span class=main>)</span>"</span></span><span class=main>)</span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> prem<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?L1</span> <span class=main>=</span> <span class=var>?L2</span>"</span></span>  
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?L1</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=var>?L3</span> <span class=main>∧</span> <span class=var>?L2</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=var>?L4</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⋀</span> <span class=bound>a</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>a</span> <span class=main>∈</span> <span class=free>X</span> <span class=main>∨</span> <span class=bound>a</span> <span class=main>∈</span> <span class=free>Y</span><span class=main>)</span> <span class=main>∧</span> <span class=bound>a</span> <span class=main>∈</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>a</span> <span class=main>∈</span> <span class=free>X</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>   
  <span class=keyword1><span class=command>with</span></span> prem <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* All elements of a list l are in a set X if and only if
 the projection of l onto X yields l. *)</span>
<span class=keyword1 id=Projection-list_subset_iff_projection_neutral><span class=command>lemma</span></span> list_subset_iff_projection_neutral<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=free>l</span> <span class=main>⊆</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=free>l</span><span class=main>)</span>"</span></span>
<span class=main>(</span><span class=keyword2><span class=keyword>is</span></span> <span class=quoted><span class=quoted>"<span class=var>?A</span> <span class=main>=</span> <span class=var>?B</span>"</span></span><span class=main>)</span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?A</span> <span class=main>⟹</span> <span class=var>?B</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=var>?A</span>"</span></span>
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>x</span><span class=main>.</span> <span class=bound>x</span> <span class=main>∈</span> <span class=main>(</span>set <span class=free>l</span><span class=main>)</span> <span class=main>⟹</span> <span class=bound>x</span> <span class=main>∈</span> <span class=free>X</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>moreover</span></span> 
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?B</span> <span class=main>⟹</span> <span class=var>?A</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=var>?B</span>"</span></span>
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> set <span class=free>l</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>..</span></span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* If the projection of τ onto a set X is not the empty trace, then 
there is x ∈ X that is the last occurrence of all elements of X in τ. 
τ can then be split around x.

Expressing non-emptiness in terms of list length is quite useful
for inductive proofs. *)</span>
<span class=keyword1 id=Projection-projection_split_last><span class=command>lemma</span></span> projection_split_last<span class=main>:</span> <span class=quoted><span class=quoted>"Suc <span class=free>n</span> <span class=main>=</span> length <span class=main>(</span><span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>⟹</span> 
<span class=main>∃</span> <span class=bound>β</span> <span class=bound>x</span> <span class=bound>α</span><span class=main>.</span> <span class=main>(</span><span class=bound>x</span> <span class=main>∈</span> <span class=free>X</span> <span class=main>∧</span> <span class=free>τ</span> <span class=main>=</span> <span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>x</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α</span> <span class=main>∧</span> <span class=bound>α</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=free>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> Suc_n_is_len_τX<span class=main>:</span> <span class=quoted><span class=quoted>"Suc <span class=free>n</span> <span class=main>=</span> length <span class=main>(</span><span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span>

  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?L</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span>"</span></span>
  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?RL</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"filter <span class=main>(</span><span class=main>λ</span><span class=bound>x</span> <span class=main>.</span> <span class=bound>x</span> <span class=main>∈</span> <span class=free>X</span><span class=main>)</span> <span class=main>(</span>rev <span class=free>τ</span><span class=main>)</span>"</span></span>

  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Suc <span class=free>n</span> <span class=main>=</span> length <span class=var>?RL</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"rev <span class=var>?L</span> <span class=main>=</span> <span class=var>?RL</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> rev_filter<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"rev <span class=main>(</span>rev <span class=var>?L</span><span class=main>)</span> <span class=main>=</span> rev <span class=var>?RL</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=var>?L</span> <span class=main>=</span> rev <span class=var>?RL</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> Suc_n_is_len_τX <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>with</span></span> Suc_length_conv<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=free>n</span></span> <span class=var><span class=quoted><span class=var>?RL</span></span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>x</span></span> <span class=skolem><span class=skolem>xs</span></span>
    <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=var>?RL</span> <span class=main>=</span> <span class=skolem>x</span> <span class=main>#</span> <span class=skolem>xs</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>#</span> <span class=skolem>xs</span> <span class=main>=</span> <span class=var>?RL</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  
  <span class=keyword1><span class=command>from</span></span> Cons_eq_filterD<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>revα</span></span> <span class=skolem><span class=skolem>revβ</span></span>
    <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>rev <span class=free>τ</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>revα</span> <span class=main>@</span> <span class=skolem>x</span> <span class=main>#</span> <span class=skolem>revβ</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> revα_no_x<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>a</span> <span class=main>∈</span> set <span class=skolem>revα</span><span class=main>.</span> <span class=bound>a</span> <span class=main>∉</span> <span class=free>X</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> x_in_X<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> <span class=free>X</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"rev <span class=main>(</span>rev <span class=free>τ</span><span class=main>)</span> <span class=main>=</span> rev <span class=main>(</span><span class=skolem>revα</span> <span class=main>@</span> <span class=skolem>x</span> <span class=main>#</span> <span class=skolem>revβ</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=free>τ</span> <span class=main>=</span> <span class=main>(</span>rev <span class=skolem>revβ</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span>rev <span class=skolem>revα</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β</span></span> <span class=skolem><span class=skolem>α</span></span>
    <span class=keyword2><span class=keyword>where</span></span> τ_is_βxα<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>τ</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> α_is_revrevα<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>=</span> <span class=main>(</span>rev <span class=skolem>revα</span><span class=main>)</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> β_is_revrevβ<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>=</span> <span class=main>(</span>rev <span class=skolem>revβ</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> α_no_x<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> α_is_revrevα revα_no_x <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>a</span> <span class=main>∈</span> set <span class=skolem>α</span><span class=main>.</span> <span class=bound>a</span> <span class=main>∉</span> <span class=free>X</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>

  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> α_no_x <span class=keyword1><span class=command>have</span></span> αX_zero_len<span class=main>:</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=main>0</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> x_in_X <span class=keyword1><span class=command>have</span></span> xX_one_len<span class=main>:</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=main>1</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> τ_is_βxα <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"length <span class=var>?L</span> <span class=main>=</span> length <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>+</span> length <span class=main>(</span><span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>+</span> length <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>            
    <span class=keyword1><span class=command>with</span></span> αX_zero_len <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"length <span class=var>?L</span> <span class=main>=</span> length <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>+</span> length <span class=main>(</span><span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> xX_one_len Suc_n_is_len_τX <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>n</span> <span class=main>=</span> length <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> αX_zero_len <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>with</span></span> x_in_X τ_is_βxα α_no_x <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=Projection-projection_rev_commute><span class=command>lemma</span></span> projection_rev_commute<span class=main>:</span>
  <span class=quoted><span class=quoted>"rev <span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span>rev <span class=free>l</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>l</span></span><span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>

<span class=comment1>(* Same as the previous lemma except that we split around the FIRST
    occurrence.

    Note that we do not express non-emptiness via the length function
    simply because there is no need for it in the theories relying on
    this lemma. *)</span>
<span class=keyword1 id=Projection-projection_split_first><span class=command>lemma</span></span> projection_split_first<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=main>(</span><span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=free>x</span> <span class=main>#</span> <span class=free>xs</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>(</span><span class=free>τ</span> <span class=main>=</span> <span class=bound>α</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=bound>β</span> <span class=main>∧</span> <span class=bound>α</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> τX_is_x_xs<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=free>x</span> <span class=main>#</span> <span class=free>xs</span>"</span></span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>0</span> <span class=main>≠</span> length <span class=main>(</span><span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>0</span> <span class=main>≠</span> length <span class=main>(</span>rev <span class=main>(</span><span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>0</span> <span class=main>≠</span> length <span class=main>(</span><span class=main>(</span>rev <span class=free>τ</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_rev_commute<span class=main>)</span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>n</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"Suc <span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span>rev <span class=free>τ</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Suc_pred length_greater_0_conv that<span class=main>)</span>
  <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β'</span></span> <span class=skolem><span class=skolem>x'</span></span> <span class=skolem><span class=skolem>α'</span></span> 
    <span class=keyword2><span class=keyword>where</span></span> x'_in_X<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x'</span> <span class=main>∈</span> <span class=free>X</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> revτ_is_β'x'α'<span class=main>:</span> <span class=quoted><span class=quoted>"rev <span class=free>τ</span> <span class=main>=</span> <span class=skolem>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> α'X_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

  <span class=keyword1><span class=command>from</span></span> revτ_is_β'x'α' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"rev <span class=main>(</span>rev <span class=free>τ</span><span class=main>)</span> <span class=main>=</span> rev <span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
  <span class=keyword1><span class=command>hence</span></span> τ_is_revα'_x'_revβ'<span class=main>:</span><span class=quoted><span class=quoted>"<span class=free>τ</span> <span class=main>=</span> rev <span class=skolem>α'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x'</span><span class=main>]</span> <span class=main>@</span> rev <span class=skolem>β'</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>from</span></span> α'X_empty <span class=keyword1><span class=command>have</span></span> revα'X_empty<span class=main>:</span> <span class=quoted><span class=quoted>"rev <span class=skolem>α'</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_rev_commute rev_is_Nil_conv<span class=main>)</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>note</span></span> x'_in_X
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>x'</span> <span class=main>#</span> <span class=main>(</span><span class=main>(</span>rev <span class=skolem>β'</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> τX_is_x_xs <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>x</span> <span class=main>=</span> <span class=skolem>x'</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>with</span></span> τ_is_revα'_x'_revβ' <span class=keyword1><span class=command>have</span></span> τ_is_revα'_x_revβ'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>τ</span> <span class=main>=</span> rev <span class=skolem>α'</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> rev <span class=skolem>β'</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>with</span></span> revα'X_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* this lemma extends the previous lemma by also concluding that the suffix of the splitted trace
   projected is equal to the projection of the initial trace without the first element *)</span>
<span class=keyword1 id=Projection-projection_split_first_with_suffix><span class=command>lemma</span></span> projection_split_first_with_suffix<span class=main>:</span> 
  <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=main>(</span><span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=free>x</span> <span class=main>#</span> <span class=free>xs</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>(</span><span class=free>τ</span> <span class=main>=</span> <span class=bound>α</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=bound>β</span> <span class=main>∧</span> <span class=bound>α</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>β</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=free>xs</span><span class=main>)</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> tau_proj_X<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=free>x</span> <span class=main>#</span> <span class=free>xs</span>"</span></span>
  <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
    <span class=keyword1><span class=command>from</span></span>   tau_proj_X <span class=keyword1><span class=command>have</span></span> x_in_X<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>x</span> <span class=main>∈</span> <span class=free>X</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> IntE inter_set_filter list.set_intros<span class=main><span class=main>(</span></span>1<span class=main><span class=main>)</span></span> projection_def<span class=main>)</span>
    <span class=keyword1><span class=command>from</span></span>  tau_proj_X <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=free>τ</span> <span class=main>=</span> <span class=bound>α</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=bound>β</span> <span class=main>∧</span> <span class=bound>α</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> projection_split_first <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α</span></span> <span class=skolem><span class=skolem>β</span></span> <span class=keyword2><span class=keyword>where</span></span> tau_split<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>τ</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>β</span>"</span></span>
                      <span class=keyword2><span class=keyword>and</span></span> X_empty_prefix<span class=main>:</span><span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> tau_split tau_proj_X  <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>β</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span><span class=free>x</span> <span class=main>#</span> <span class=free>xs</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span>  X_empty_prefix <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>β</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span><span class=free>x</span> <span class=main>#</span> <span class=free>xs</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>   
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>x</span> <span class=main>#</span> <span class=skolem>β</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span><span class=free>x</span> <span class=main>#</span> <span class=free>xs</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span>  x_in_X <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=free>xs</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>with</span></span>  tau_split X_empty_prefix <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>   
<span class=keyword1><span class=command>qed</span></span>




<span class=keyword1 id=Projection-projection_split_arbitrary_element><span class=command>lemma</span></span> projection_split_arbitrary_element<span class=main>:</span> 
  <span class=quoted><span class=quoted>"<span class=main>⟦</span><span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>(</span><span class=free>α</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=free>β</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span><span class=main>;</span> <span class=free>x</span> <span class=main>∈</span> <span class=free>X</span> <span class=main>⟧</span> 
      <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> <span class=main>(</span><span class=free>τ</span> <span class=main>=</span> <span class=bound>α'</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=bound>β'</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=free>α</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>∧</span> <span class=bound>β'</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=free>β</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>(</span><span class=free>α</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=free>β</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>" <span class=free>x</span> <span class=main>∈</span> <span class=free>X</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>n</span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span><span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>(</span><span class=free>α</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=free>β</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span><span class=main>;</span> <span class=free>x</span> <span class=main>∈</span> <span class=free>X</span><span class=main>;</span> <span class=skolem>n</span> <span class=main>=</span> length<span class=main>(</span><span class=free>α</span><span class=main>↿</span><span class=free>X</span><span class=main>)</span> <span class=main>⟧</span>
          <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> <span class=main>(</span><span class=free>τ</span> <span class=main>=</span> <span class=bound>α'</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=bound>β'</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=free>α</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>∧</span> <span class=bound>β'</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=free>β</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>n</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=free>τ</span></span> <span class=quoted><span class=free>α</span></span> <span class=main>)</span>
      <span class=keyword3><span class=command>case</span></span> 0
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>with</span></span> <span class=quoted>"0.prems"</span><span class=main>(</span>1<span class=main>)</span> <span class=quoted>"0.prems"</span><span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=free>x</span> <span class=main>#</span> <span class=free>β</span><span class=main>↿</span><span class=free>X</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
        <span class=keyword1><span class=command>using</span></span> projection_split_first_with_suffix <span class=keyword1><span class=command>by</span></span> <span class=operator>fastforce</span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>
      <span class=keyword1><span class=command>from</span></span> <span class=quoted>"Suc.prems"</span><span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span><span class=main>↿</span><span class=free>X</span><span class=main>=</span><span class=skolem>α</span><span class=main>↿</span><span class=free>X</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=free>β</span><span class=main>)</span> <span class=main>↿</span><span class=free>X</span>"</span></span>
        <span class=keyword1><span class=command>using</span></span> projection_concatenation_commute <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>from</span></span> <span class=quoted>"Suc.prems"</span><span class=main>(</span>3<span class=main>)</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>x'</span></span> <span class=skolem><span class=skolem>xs'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span><span class=free>X</span><span class=main>=</span> <span class=skolem>x'</span> <span class=main>#</span><span class=skolem>xs'</span>"</span></span>
                                            <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x'</span> <span class=main>∈</span> <span class=free>X</span>"</span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> filter_eq_ConsD length_Suc_conv projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>a<span class=hidden>⇩</span><sub>1</sub></span></span> <span class=skolem><span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>a<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span>"</span></span> 
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>a<span class=hidden>⇩</span><sub>1</sub></span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=skolem>xs'</span>"</span></span> 
        <span class=keyword1><span class=command>using</span></span> projection_split_first_with_suffix <span class=keyword1><span class=command>by</span></span> <span class=operator>metis</span>
      <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>x'</span> <span class=main>∈</span> <span class=free>X</span>›</span></span> <span class=quoted>"Suc.prems"</span><span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span><span class=main>↿</span><span class=free>X</span><span class=main>=</span> <span class=skolem>x'</span> <span class=main>#</span>  <span class=main>(</span><span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=free>β</span><span class=main>)</span> <span class=main>↿</span><span class=free>X</span>"</span></span> 
        <span class=keyword1><span class=command>unfolding</span></span> projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span> 
      <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t<span class=hidden>⇩</span><sub>1</sub></span></span> <span class=skolem><span class=skolem>t<span class=hidden>⇩</span><sub>2</sub></span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span><span class=main>=</span> <span class=skolem>t<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t<span class=hidden>⇩</span><sub>2</sub></span>"</span></span>
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t<span class=hidden>⇩</span><sub>1</sub></span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t<span class=hidden>⇩</span><sub>2</sub></span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=free>β</span><span class=main>)</span> <span class=main>↿</span><span class=free>X</span>"</span></span>
        <span class=keyword1><span class=command>using</span></span> projection_split_first_with_suffix <span class=keyword1><span class=command>by</span></span> <span class=operator>metis</span>
      <span class=keyword1><span class=command>from</span></span> Suc.prems<span class=main>(</span>3<span class=main>)</span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span><span class=free>X</span><span class=main>=</span> <span class=skolem>x'</span> <span class=main>#</span> <span class=skolem>xs'</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>a<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>a<span class=hidden>⇩</span><sub>1</sub></span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=skolem>xs'</span>›</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span><span class=main>=</span>length<span class=main>(</span><span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span><span class=main>↿</span><span class=free>X</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>               
      <span class=keyword1><span class=command>with</span></span> <span class=quoted>"Suc.hyps"</span><span class=main>(</span>1<span class=main>)</span> <span class=quoted>"Suc.prems"</span><span class=main>(</span>2<span class=main>)</span> <span class=quoted><span class=quoted>‹<span class=skolem>t<span class=hidden>⇩</span><sub>2</sub></span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=free>β</span><span class=main>)</span> <span class=main>↿</span><span class=free>X</span>›</span></span> 
        <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t<span class=hidden>⇩</span><sub>2</sub>'</span></span> <span class=skolem><span class=skolem>t<span class=hidden>⇩</span><sub>3</sub>'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t<span class=hidden>⇩</span><sub>2</sub></span><span class=main>=</span><span class=skolem>t<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t<span class=hidden>⇩</span><sub>3</sub>'</span>"</span></span>
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span><span class=main>↿</span><span class=free>X</span>"</span></span>
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t<span class=hidden>⇩</span><sub>3</sub>'</span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=free>β</span><span class=main>↿</span><span class=free>X</span>"</span></span>
          <span class=keyword1><span class=command>using</span></span> projection_concatenation_commute <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?α'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=skolem>t<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t<span class=hidden>⇩</span><sub>2</sub>'</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=var><span class=quoted><span class=var>?β'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=skolem>t<span class=hidden>⇩</span><sub>3</sub>'</span>"</span></span>
      <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ</span><span class=main>=</span> <span class=skolem>t<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t<span class=hidden>⇩</span><sub>2</sub></span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>t<span class=hidden>⇩</span><sub>2</sub></span><span class=main>=</span><span class=skolem>t<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t<span class=hidden>⇩</span><sub>3</sub>'</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span><span class=main>=</span><span class=var>?α'</span><span class=main>@</span><span class=main>[</span><span class=free>x</span><span class=main>]</span><span class=main>@</span><span class=var>?β'</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span><span class=free>X</span><span class=main>=</span> <span class=skolem>x'</span> <span class=main>#</span> <span class=skolem>xs'</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>t<span class=hidden>⇩</span><sub>1</sub></span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>x'</span> <span class=main>∈</span> <span class=free>X</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>t<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span><span class=main>↿</span><span class=free>X</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>a<span class=hidden>⇩</span><sub>2</sub></span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=skolem>xs'</span>›</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?α'</span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span><span class=free>X</span>"</span></span>
        <span class=keyword1><span class=command>using</span></span> projection_concatenation_commute <span class=keyword1><span class=command>unfolding</span></span> projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span> 
      <span class=keyword1><span class=command>ultimately</span></span>
      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>t<span class=hidden>⇩</span><sub>3</sub>'</span><span class=main>↿</span><span class=free>X</span> <span class=main>=</span> <span class=free>β</span><span class=main>↿</span><span class=free>X</span>›</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>qed</span></span>    
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹<span class=free>τ</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>(</span><span class=free>α</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span> <span class=main>@</span> <span class=free>β</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span>›</span></span> <span class=quoted><span class=quoted>‹ <span class=free>x</span> <span class=main>∈</span> <span class=free>X</span>›</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
<span class=keyword1><span class=command>qed</span></span>
        
<span class=comment1>(* If the projection of a list l onto a set X is empty, it
    will remain empty when projecting further. *)</span>
<span class=keyword1 id=Projection-projection_on_intersection><span class=command>lemma</span></span> projection_on_intersection<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>l</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>⟹</span> <span class=free>l</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∩</span> <span class=free>Y</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
<span class=main>(</span><span class=keyword2><span class=keyword>is</span></span> <span class=quoted><span class=quoted>"<span class=var>?L1</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>⟹</span> <span class=var>?L2</span> <span class=main>=</span> <span class=main>[]</span>"</span></span><span class=main>)</span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=var>?L1</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=var>?L1</span> <span class=main>=</span> <span class=main>{}</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?L2</span> <span class=main>⊆</span> set <span class=var>?L1</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?L2</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* The previous lemma expressed with subsets. *)</span>
<span class=keyword1 id=Projection-projection_on_subset><span class=command>lemma</span></span> projection_on_subset<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=free>Y</span> <span class=main>⊆</span> <span class=free>X</span><span class=main>;</span> <span class=free>l</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=free>l</span> <span class=main>↿</span> <span class=free>Y</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> subset<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>Y</span> <span class=main>⊆</span> <span class=free>X</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> proj_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>l</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=free>l</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∩</span> <span class=free>Y</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_on_intersection<span class=main>)</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>from</span></span> subset <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>X</span> <span class=main>∩</span> <span class=free>Y</span> <span class=main>=</span> <span class=free>Y</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Another variant that is used in proofs of BSP compositionality theorems. *)</span>
<span class=keyword1 id=Projection-projection_on_subset2><span class=command>lemma</span></span> projection_on_subset2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> set <span class=free>l</span> <span class=main>⊆</span> <span class=free>L</span><span class=main>;</span> <span class=free>l</span> <span class=main>↿</span> <span class=free>X'</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> <span class=free>X</span> <span class=main>∩</span> <span class=free>L</span> <span class=main>⊆</span> <span class=free>X'</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=free>l</span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> setl_subset_L<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=free>l</span> <span class=main>⊆</span> <span class=free>L</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> l_no_X'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>l</span> <span class=main>↿</span> <span class=free>X'</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> X_inter_L_subset_X'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>X</span> <span class=main>∩</span> <span class=free>L</span> <span class=main>⊆</span> <span class=free>X'</span>"</span></span>

  <span class=keyword1><span class=command>from</span></span> X_inter_L_subset_X' l_no_X' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>l</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∩</span> <span class=free>L</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_on_subset<span class=main>)</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>l</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∩</span> <span class=free>L</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>L</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute projection_def<span class=main>)</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>note</span></span> setl_subset_L
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>  

<span class=comment1>(*If the projection of two lists l1 and l2  onto a set Y is equal then its also equal for all X ⊆ Y*)</span>
<span class=keyword1 id=Projection-non_empty_projection_on_subset><span class=command>lemma</span></span> non_empty_projection_on_subset<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>X</span> <span class=main>⊆</span> <span class=free>Y</span> <span class=main>∧</span> <span class=free>l<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span> <span class=free>Y</span> <span class=main>=</span> <span class=free>l<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span> <span class=free>Y</span> <span class=main>⟹</span>  <span class=free>l<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span> <span class=free>X</span> <span class=main>=</span> <span class=free>l<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span> <span class=free>X</span>"</span></span> 
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_subset_eq_from_superset_eq subset_Un_eq<span class=main>)</span>

<span class=comment1>(* Intersecting a projection set with a list's elements does not change the result
    of the projection. *)</span>
<span class=keyword1 id=Projection-projection_intersection_neutral><span class=command>lemma</span></span> projection_intersection_neutral<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=free>l</span> <span class=main>⊆</span> <span class=free>X</span><span class=main>)</span> <span class=main>⟹</span> <span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∩</span> <span class=free>Y</span><span class=main>)</span> <span class=main>=</span> <span class=free>l</span> <span class=main>↿</span> <span class=free>Y</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"set <span class=free>l</span> <span class=main>⊆</span> <span class=free>X</span>"</span></span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>=</span> <span class=free>l</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>↿</span> <span class=free>Y</span> <span class=main>=</span> <span class=free>l</span> <span class=main>↿</span> <span class=free>Y</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>↿</span> <span class=free>Y</span> <span class=main>=</span> <span class=free>l</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∩</span> <span class=free>Y</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=Projection-projection_commute><span class=command>lemma</span></span> projection_commute<span class=main>:</span>
  <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>↿</span> <span class=free>Y</span> <span class=main>=</span> <span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>Y</span><span class=main>)</span> <span class=main>↿</span> <span class=free>X</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def conj_commute<span class=main>)</span>


<span class=keyword1 id=Projection-projection_subset_elim><span class=command>lemma</span></span> projection_subset_elim<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>Y</span> <span class=main>⊆</span> <span class=free>X</span> <span class=main>⟹</span> <span class=main>(</span><span class=free>l</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>↿</span> <span class=free>Y</span> <span class=main>=</span> <span class=free>l</span> <span class=main>↿</span> <span class=free>Y</span>"</span></span>
<span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Diff_subset list_subset_iff_projection_neutral
    minus_coset_filter order_trans projection_commute projection_def<span class=main>)</span>


<span class=keyword1 id=Projection-projection_sequence><span class=command>lemma</span></span> projection_sequence<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>xs</span> <span class=main>↿</span> <span class=free>X</span><span class=main>)</span> <span class=main>↿</span> <span class=free>Y</span> <span class=main>=</span> <span class=main>(</span><span class=free>xs</span> <span class=main>↿</span> <span class=main>(</span><span class=free>X</span> <span class=main>∩</span> <span class=free>Y</span><span class=main>)</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_absorb inf_sup_ord<span class=main><span class=main>(</span></span>1<span class=main><span class=main>)</span></span> list_subset_iff_projection_neutral
    projection_intersection_neutral projection_subset_elim<span class=main>)</span>


<span class=comment1>(* This function yields a possible interleaving for given 
  traces t1 and t2.
  The set A (B) shall denote the the set of events for t1 (t2).
  Non-synchronization events in trace t1 are prioritized. *)</span>
<span class=keyword1><span class=command>fun</span></span> <span class=entity>merge</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> list <span class=main>⇒</span> <span class=tfree>'e</span> list <span class=main>⇒</span> <span class=tfree>'e</span> list"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>merge</span> <span class=free><span class=bound><span class=entity>A</span></span></span> <span class=free><span class=bound><span class=entity>B</span></span></span> <span class=main>[]</span> <span class=free><span class=bound><span class=entity>t2</span></span></span> <span class=main>=</span> <span class=free><span class=bound><span class=entity>t2</span></span></span>"</span></span> <span class=main>|</span>
<span class=quoted><span class=quoted>"<span class=free>merge</span> <span class=free><span class=bound><span class=entity>A</span></span></span> <span class=free><span class=bound><span class=entity>B</span></span></span> <span class=free><span class=bound><span class=entity>t1</span></span></span> <span class=main>[]</span> <span class=main>=</span> <span class=free><span class=bound><span class=entity>t1</span></span></span>"</span></span> <span class=main>|</span>
<span class=quoted><span class=quoted>"<span class=free>merge</span> <span class=free><span class=bound><span class=entity>A</span></span></span> <span class=free><span class=bound><span class=entity>B</span></span></span> <span class=main>(</span><span class=free><span class=bound><span class=entity>e1</span></span></span> <span class=main>#</span> <span class=free><span class=bound><span class=entity>t1'</span></span></span><span class=main>)</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>e2</span></span></span> <span class=main>#</span> <span class=free><span class=bound><span class=entity>t2'</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=keyword1>if</span> <span class=free><span class=bound><span class=entity>e1</span></span></span> <span class=main>=</span> <span class=free><span class=bound><span class=entity>e2</span></span></span> <span class=keyword1>then</span> 
                                          <span class=free><span class=bound><span class=entity>e1</span></span></span> <span class=main>#</span> <span class=main>(</span><span class=free>merge</span> <span class=free><span class=bound><span class=entity>A</span></span></span> <span class=free><span class=bound><span class=entity>B</span></span></span> <span class=free><span class=bound><span class=entity>t1'</span></span></span> <span class=free><span class=bound><span class=entity>t2'</span></span></span><span class=main>)</span>
                                        <span class=keyword1>else</span> <span class=main>(</span><span class=keyword1>if</span> <span class=free><span class=bound><span class=entity>e1</span></span></span> <span class=main>∈</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>A</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>B</span></span></span><span class=main>)</span> <span class=keyword1>then</span>
                                               <span class=free><span class=bound><span class=entity>e2</span></span></span> <span class=main>#</span> <span class=main>(</span><span class=free>merge</span> <span class=free><span class=bound><span class=entity>A</span></span></span> <span class=free><span class=bound><span class=entity>B</span></span></span> <span class=main>(</span><span class=free><span class=bound><span class=entity>e1</span></span></span> <span class=main>#</span> <span class=free><span class=bound><span class=entity>t1'</span></span></span><span class=main>)</span> <span class=free><span class=bound><span class=entity>t2'</span></span></span><span class=main>)</span>
                                             <span class=keyword1>else</span> <span class=free><span class=bound><span class=entity>e1</span></span></span> <span class=main>#</span> <span class=main>(</span><span class=free>merge</span> <span class=free><span class=bound><span class=entity>A</span></span></span> <span class=free><span class=bound><span class=entity>B</span></span></span> <span class=free><span class=bound><span class=entity>t1'</span></span></span> <span class=main>(</span><span class=free><span class=bound><span class=entity>e2</span></span></span> <span class=main>#</span> <span class=free><span class=bound><span class=entity>t2'</span></span></span><span class=main>)</span><span class=main>)</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=comment1>(* If two traces can be interleaved, then merge yields such an interleaving  *)</span>
<span class=keyword1 id=Projection-merge_property><span class=command>lemma</span></span> merge_property<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span>set <span class=free>t1</span> <span class=main>⊆</span> <span class=free>A</span><span class=main>;</span> set <span class=free>t2</span> <span class=main>⊆</span> <span class=free>B</span><span class=main>;</span> <span class=free>t1</span> <span class=main>↿</span> <span class=free>B</span> <span class=main>=</span> <span class=free>t2</span> <span class=main>↿</span> <span class=free>A</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> <span class=keyword1>let</span> <span class=bound>t</span> <span class=main>=</span> <span class=main>(</span>merge <span class=free>A</span> <span class=free>B</span> <span class=free>t1</span> <span class=free>t2</span><span class=main>)</span> <span class=keyword1>in</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> <span class=free>A</span> <span class=main>=</span> <span class=free>t1</span> <span class=main>∧</span> <span class=bound>t</span> <span class=main>↿</span> <span class=free>B</span> <span class=main>=</span> <span class=free>t2</span> <span class=main>∧</span> set <span class=bound>t</span> <span class=main>⊆</span> <span class=main>(</span><span class=main>(</span>set <span class=free>t1</span><span class=main>)</span> <span class=main>∪</span> <span class=main>(</span>set <span class=free>t2</span><span class=main>)</span><span class=main>)</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>unfolding</span></span> Let_def
<span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>A</span></span> <span class=quoted><span class=free>B</span></span> <span class=quoted><span class=free>t1</span></span> <span class=quoted><span class=free>t2</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> merge.induct<span class=main>)</span>
  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>1 <span class=skolem>A</span> <span class=skolem>B</span> <span class=skolem>t2</span><span class=main>)</span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Un_empty_left empty_subsetI list_subset_iff_projection_neutral 
      merge.simps<span class=main><span class=main>(</span></span>1<span class=main><span class=main>)</span></span> set_empty subset_iff_psubset_eq<span class=main>)</span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>2 <span class=skolem>A</span> <span class=skolem>B</span> <span class=skolem>t1</span><span class=main>)</span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Un_empty_right empty_subsetI list_subset_iff_projection_neutral 
      merge.simps<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> set_empty subset_refl<span class=main>)</span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>3 <span class=skolem>A</span> <span class=skolem>B</span> <span class=skolem>e1</span> <span class=skolem>t1'</span> <span class=skolem>e2</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span><span class=main>)</span>
    <span class=keyword3><span class=command>assume</span></span> e1_is_e2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e1</span> <span class=main>=</span> <span class=skolem>e2</span>"</span></span>
    
    <span class=keyword1><span class=command>note</span></span> e1_is_e2 
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>4<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t1'</span> <span class=main>⊆</span> <span class=skolem>A</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>5<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t2'</span> <span class=main>⊆</span> <span class=skolem>B</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> e1_is_e2 3<span class=main>(</span>4-6<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> <span class=skolem>B</span> <span class=main>=</span> <span class=skolem>t2'</span> <span class=main>↿</span> <span class=skolem>A</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> 3<span class=main>(</span>1<span class=main>)</span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> ind1<span class=main>:</span> <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=skolem>t1'</span> <span class=skolem>t2'</span> <span class=main>↿</span> <span class=skolem>A</span> <span class=main>=</span> <span class=skolem>t1'</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> ind2<span class=main>:</span> <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=skolem>t1'</span> <span class=skolem>t2'</span> <span class=main>↿</span> <span class=skolem>B</span> <span class=main>=</span> <span class=skolem>t2'</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> ind3<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span>merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=skolem>t1'</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>set <span class=skolem>t1'</span><span class=main>)</span> <span class=main>∪</span> <span class=main>(</span>set <span class=skolem>t2'</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>from</span></span> e1_is_e2 <span class=keyword1><span class=command>have</span></span> merge_eq<span class=main>:</span> 
      <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>e1</span> <span class=main>#</span> <span class=main>(</span>merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=skolem>t1'</span> <span class=skolem>t2'</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>4<span class=main>)</span> ind1 <span class=keyword1><span class=command>have</span></span> goal1<span class=main>:</span> 
      <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>↿</span> <span class=skolem>A</span> <span class=main>=</span> <span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> merge_eq projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> e1_is_e2 3<span class=main>(</span>5<span class=main>)</span> ind2 <span class=keyword1><span class=command>have</span></span> goal2<span class=main>:</span> 
      <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>↿</span> <span class=skolem>B</span> <span class=main>=</span> <span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> merge_eq projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> ind3 <span class=keyword1><span class=command>have</span></span> goal3<span class=main>:</span> 
      <span class=quoted><span class=quoted>"set <span class=main>(</span>merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span><span class=main>)</span> <span class=main>⊆</span> set <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>∪</span> set <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> merge_eq<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> <span class=comment1>(* case (3 e1 t1' e2 t2') for e1 = e2 *)</span>
  <span class=keyword1><span class=command>next</span></span>
    <span class=keyword3><span class=command>assume</span></span> e1_isnot_e2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e1</span> <span class=main>≠</span> <span class=skolem>e2</span>"</span></span>
    <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span><span class=main>)</span>
      <span class=keyword3><span class=command>assume</span></span> e1_in_A_inter_B<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e1</span> <span class=main>∈</span> <span class=skolem>A</span> <span class=main>∩</span> <span class=skolem>B</span>"</span></span>
      
      <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>6<span class=main>)</span> e1_isnot_e2 e1_in_A_inter_B <span class=keyword1><span class=command>have</span></span> e2_notin_A<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e2</span> <span class=main>∉</span> <span class=skolem>A</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      
      <span class=keyword1><span class=command>note</span></span> e1_isnot_e2 e1_in_A_inter_B 3<span class=main>(</span>4<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>5<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t2'</span> <span class=main>⊆</span> <span class=skolem>B</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>6<span class=main>)</span> e1_isnot_e2 e1_in_A_inter_B <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>↿</span> <span class=skolem>B</span> <span class=main>=</span> <span class=skolem>t2'</span> <span class=main>↿</span> <span class=skolem>A</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> 3<span class=main>(</span>2<span class=main>)</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> ind1<span class=main>:</span> <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=skolem>t2'</span> <span class=main>↿</span> <span class=skolem>A</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> ind2<span class=main>:</span> <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=skolem>t2'</span> <span class=main>↿</span> <span class=skolem>B</span> <span class=main>=</span> <span class=skolem>t2'</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> ind3<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span>merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>⊆</span> set <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>∪</span> set <span class=skolem>t2'</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      
      <span class=keyword1><span class=command>from</span></span> e1_isnot_e2 e1_in_A_inter_B 
      <span class=keyword1><span class=command>have</span></span> merge_eq<span class=main>:</span> 
        <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>e2</span> <span class=main>#</span> <span class=main>(</span>merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=skolem>t2'</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
 
      <span class=keyword1><span class=command>from</span></span> e1_isnot_e2 ind1 e2_notin_A <span class=keyword1><span class=command>have</span></span> goal1<span class=main>:</span> 
        <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>↿</span> <span class=skolem>A</span> <span class=main>=</span> <span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> merge_eq projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>5<span class=main>)</span> ind2 <span class=keyword1><span class=command>have</span></span> goal2<span class=main>:</span> <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>↿</span> <span class=skolem>B</span> <span class=main>=</span> <span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> merge_eq projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>5<span class=main>)</span> ind3 <span class=keyword1><span class=command>have</span></span> goal3<span class=main>:</span> 
        <span class=quoted><span class=quoted>"set <span class=main>(</span>merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span><span class=main>)</span> <span class=main>⊆</span> set <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>∪</span> set <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> merge_eq<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> <span class=comment1>(* case (3 e1 t1' e2 t2') for e1 ≠ e2 e1 ∈ A ∩ B *)</span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>assume</span></span> e1_notin_A_inter_B<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e1</span> <span class=main>∉</span> <span class=skolem>A</span> <span class=main>∩</span> <span class=skolem>B</span>"</span></span>
      
      <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>4<span class=main>)</span> e1_notin_A_inter_B <span class=keyword1><span class=command>have</span></span> e1_notin_B<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e1</span> <span class=main>∉</span> <span class=skolem>B</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      
      <span class=keyword1><span class=command>note</span></span> e1_isnot_e2 e1_notin_A_inter_B
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>4<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t1'</span> <span class=main>⊆</span> <span class=skolem>A</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> 3<span class=main>(</span>5<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>6<span class=main>)</span> e1_notin_B <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> <span class=skolem>B</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>↿</span> <span class=skolem>A</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> 3<span class=main>(</span>3<span class=main>)</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> ind1<span class=main>:</span> <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=skolem>t1'</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>↿</span> <span class=skolem>A</span> <span class=main>=</span> <span class=skolem>t1'</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> ind2<span class=main>:</span> <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=skolem>t1'</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>↿</span> <span class=skolem>B</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> ind3<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span>merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=skolem>t1'</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span><span class=main>)</span> <span class=main>⊆</span> set <span class=skolem>t1'</span> <span class=main>∪</span> set <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      
      <span class=keyword1><span class=command>from</span></span> e1_isnot_e2 e1_notin_A_inter_B 
      <span class=keyword1><span class=command>have</span></span> merge_eq<span class=main>:</span> <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>e1</span> <span class=main>#</span> <span class=main>(</span>merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=skolem>t1'</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      
      <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>4<span class=main>)</span> ind1 <span class=keyword1><span class=command>have</span></span> goal1<span class=main>:</span> <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>↿</span> <span class=skolem>A</span> <span class=main>=</span> <span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> merge_eq projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> ind2 e1_notin_B <span class=keyword1><span class=command>have</span></span> goal2<span class=main>:</span> 
        <span class=quoted><span class=quoted>"merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>↿</span> <span class=skolem>B</span> <span class=main>=</span> <span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> merge_eq projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> 3<span class=main>(</span>4<span class=main>)</span> ind3 <span class=keyword1><span class=command>have</span></span> goal3<span class=main>:</span> 
        <span class=quoted><span class=quoted>"set <span class=main>(</span>merge <span class=skolem>A</span> <span class=skolem>B</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span><span class=main>)</span> <span class=main>⊆</span> set <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>∪</span> set <span class=main>(</span><span class=skolem>e2</span> <span class=main>#</span> <span class=skolem>t2'</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> merge_eq<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> <span class=comment1>(* case (3 e1 t1' e2 t2') for e1 ≠ e2 e1 ∉ A ∩ B *)</span>
    <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=Prefix>
<div class=head>
<h1>Theory Prefix</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> Prefix
<span class=keyword2><span class=keyword>imports</span></span> <a href=https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/HOL/HOL/Main.html>Main</a>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* 
  Prefixes and Prefix Closure of traces 
*)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>prefix</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> list <span class=main>⇒</span> <span class=tfree>'e</span> list <span class=main>⇒</span> bool"</span></span> <span class=main>(</span><span class=keyword2><span class=keyword>infixl</span></span> <span class=quoted>"<span class=keyword1>≼</span>"</span> 100<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=main>(</span><span class=free><span class=bound><span class=entity>l1</span></span></span> <span class=main><span class=free>≼</span></span> <span class=free><span class=bound><span class=entity>l2</span></span></span><span class=main>)</span> <span class=main>≡</span> <span class=main>(</span><span class=main>∃</span><span class=bound>l3</span><span class=main>.</span> <span class=free><span class=bound><span class=entity>l1</span></span></span> <span class=main>@</span> <span class=bound>l3</span> <span class=main>=</span> <span class=free><span class=bound><span class=entity>l2</span></span></span><span class=main>)</span>"</span></span> 

<span class=keyword1><span class=command>definition</span></span> <span class=entity>prefixclosed</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>prefixclosed</span> <span class=free><span class=bound><span class=entity>tr</span></span></span> <span class=main>≡</span> <span class=main>(</span><span class=main>∀</span><span class=bound>l1</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>tr</span></span></span><span class=main>.</span> <span class=main>∀</span><span class=bound>l2</span><span class=main>.</span> <span class=bound>l2</span> <span class=main>≼</span> <span class=bound>l1</span> <span class=main>⟶</span> <span class=bound>l2</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>tr</span></span></span><span class=main>)</span>"</span></span>

<span class=comment1>(* the empty list is a prefix of every list *)</span>
<span class=keyword1 id=Prefix-empty_prefix_of_all><span class=command>lemma</span></span> empty_prefix_of_all<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>≼</span> <span class=free>l</span>"</span></span> 
  <span class=keyword1><span class=command>using</span></span> prefix_def <span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"<span class=main>[]</span>"</span></span> <span class=quoted><span class=free>l</span></span><span class=main>]</span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>

<span class=comment1>(* the empty list is in any non-empty prefix-closed set *)</span>
<span class=keyword1 id=Prefix-empty_trace_contained><span class=command>lemma</span></span> empty_trace_contained<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> prefixclosed <span class=free>tr</span> <span class=main>;</span> <span class=free>tr</span> <span class=main>≠</span> <span class=main>{}</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=main>[]</span> <span class=main>∈</span> <span class=free>tr</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> 1<span class=main>:</span> <span class=quoted><span class=quoted>"prefixclosed <span class=free>tr</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span>
         2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>tr</span> <span class=main>≠</span> <span class=main>{}</span>"</span></span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>l1</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>l1</span> <span class=main>∈</span> <span class=free>tr</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>with</span></span> 1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>l2</span><span class=main>.</span> <span class=bound>l2</span> <span class=main>≼</span> <span class=skolem>l1</span> <span class=main>⟶</span> <span class=bound>l2</span> <span class=main>∈</span> <span class=free>tr</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> prefixclosed_def<span class=main>)</span>
  <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>∈</span> <span class=free>tr</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> empty_prefix_of_all<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* the prefix-predicate is transitive *)</span>
<span class=keyword1 id=Prefix-transitive_prefix><span class=command>lemma</span></span> transitive_prefix<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=free>l1</span> <span class=main>≼</span> <span class=free>l2</span> <span class=main>;</span> <span class=free>l2</span> <span class=main>≼</span> <span class=free>l3</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=free>l1</span> <span class=main>≼</span> <span class=free>l3</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> prefix_def<span class=main>)</span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=EventSystems>
<div class=head>
<h1>Theory EventSystems</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> EventSystems
<span class=keyword2><span class=keyword>imports</span></span> <span class=quoted>"<a href=#Prefix>../Basics/Prefix</a>"</span> <span class=quoted>"<a href=#Projection>../Basics/Projection</a>"</span>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* structural representation of event systems *)</span>
<span class=keyword1><span class=command>record</span></span> <span class=tfree>'e</span> ES_rec <span class=main>=</span>
  E_ES <span class=main>::</span>  <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>
  I_ES <span class=main>::</span>  <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>
  O_ES <span class=main>::</span>  <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>
  Tr_ES <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set"</span></span>

<span class=comment1>(* syntax abbreviations for ES_rec *)</span>
<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>ESrecEES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>E⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>1000<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>E_ES <span class=free><span class=bound><span class=entity>ES</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>ESrecIES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>I⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>1000<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>I_ES <span class=free><span class=bound><span class=entity>ES</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>ESrecOES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>O⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>1000<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>O_ES <span class=free><span class=bound><span class=entity>ES</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>ESrecTrES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>Tr⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>1000<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>Tr_ES <span class=free><span class=bound><span class=entity>ES</span></span></span><span class=main>)</span>"</span></span>

<span class=comment1>(* side conditions for event systems *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>es_inputs_are_events</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>es_inputs_are_events</span> <span class=free><span class=bound><span class=entity>ES</span></span></span> <span class=main>≡</span> I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>es_outputs_are_events</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>es_outputs_are_events</span> <span class=free><span class=bound><span class=entity>ES</span></span></span> <span class=main>≡</span> O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>es_inputs_outputs_disjoint</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>es_inputs_outputs_disjoint</span> <span class=free><span class=bound><span class=entity>ES</span></span></span> <span class=main>≡</span> I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>traces_contain_events</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>traces_contain_events</span> <span class=free><span class=bound><span class=entity>ES</span></span></span> <span class=main>≡</span> <span class=main>∀</span><span class=bound>l</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>e</span> <span class=main>∈</span> <span class=main>(</span>set <span class=bound>l</span><span class=main>)</span><span class=main>.</span> <span class=bound>e</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>traces_prefixclosed</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>traces_prefixclosed</span> <span class=free><span class=bound><span class=entity>ES</span></span></span> <span class=main>≡</span> prefixclosed Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>ES_valid</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>ES_valid</span> <span class=free><span class=bound><span class=entity>ES</span></span></span> <span class=main>≡</span> 
  es_inputs_are_events <span class=free><span class=bound><span class=entity>ES</span></span></span> <span class=main>∧</span> es_outputs_are_events <span class=free><span class=bound><span class=entity>ES</span></span></span> 
  <span class=main>∧</span> es_inputs_outputs_disjoint <span class=free><span class=bound><span class=entity>ES</span></span></span> <span class=main>∧</span> traces_contain_events <span class=free><span class=bound><span class=entity>ES</span></span></span> 
  <span class=main>∧</span> traces_prefixclosed <span class=free><span class=bound><span class=entity>ES</span></span></span>"</span></span>

<span class=comment1>(* Event systems are instances of ES_rec that satisfy ES_valid. *)</span>

<span class=comment1>(* Totality of an event system ES with respect to a set E *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>total</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>total</span> <span class=free><span class=bound><span class=entity>ES</span></span></span> <span class=free><span class=bound><span class=entity>E</span></span></span> <span class=main>≡</span> <span class=free><span class=bound><span class=entity>E</span></span></span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=main>∀</span><span class=bound>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>e</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>E</span></span></span><span class=main>.</span> <span class=bound>τ</span> <span class=main>@</span> <span class=main>[</span><span class=bound>e</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=EventSystems-totality><span class=command>lemma</span></span> totality<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> total <span class=free>ES</span> <span class=free>E</span><span class=main>;</span> <span class=free>t</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> set <span class=free>t'</span> <span class=main>⊆</span> <span class=free>E</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=free>t</span> <span class=main>@</span> <span class=free>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>t'</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main><span class=keyword3>,</span></span> <span class=operator>force</span><span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> total_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>


<span class=comment1>(* structural representation of composed event systems (composition operator) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>composeES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> ES_rec"</span></span> 
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>composeES</span> <span class=free><span class=bound><span class=entity>ES1</span></span></span> <span class=free><span class=bound><span class=entity>ES2</span></span></span> <span class=main>≡</span>  
  <span class=main>⦇</span>  
    E_ES  <span class=main>=</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span><span class=main>,</span> 
    I_ES  <span class=main>=</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∪</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>,</span>
    O_ES  <span class=main>=</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∪</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>,</span>
    Tr_ES <span class=main>=</span> <span class=main>{</span><span class=bound>τ</span> <span class=main>.</span> <span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> 
                  <span class=main>∧</span> <span class=main>(</span>set <span class=bound>τ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>}</span> 
  <span class=main>⦈</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>composeESAbbrv</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> ES_rec"</span></span>
<span class=main>(</span><span class=quoted>"_ <span class=keyword1>∥</span> _"</span><span class=main>[</span>1000<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free><span class=bound><span class=entity>ES1</span></span></span> <span class=main><span class=free>∥</span></span> <span class=free><span class=bound><span class=entity>ES2</span></span></span> <span class=main>≡</span> <span class=main>(</span>composeES <span class=free><span class=bound><span class=entity>ES1</span></span></span> <span class=free><span class=bound><span class=entity>ES2</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>composable</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> ES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>composable</span> <span class=free><span class=bound><span class=entity>ES1</span></span></span> <span class=free><span class=bound><span class=entity>ES2</span></span></span> <span class=main>≡</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∪</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span>


<span class=comment1>(* composing two event systems yields an event system *)</span>
<span class=keyword1 id=EventSystems-composeES_yields_ES><span class=command>lemma</span></span> composeES_yields_ES<span class=main>:</span> 
  <span class=quoted><span class=quoted>"<span class=main>⟦</span> ES_valid <span class=free>ES1</span><span class=main>;</span> ES_valid <span class=free>ES2</span> <span class=main>⟧</span> <span class=main>⟹</span> ES_valid <span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def
<span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
  <span class=keyword3><span class=command>assume</span></span> ES1_inputs_are_events<span class=main>:</span> <span class=quoted><span class=quoted>"es_inputs_are_events <span class=free>ES1</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> ES2_inputs_are_events<span class=main>:</span> <span class=quoted><span class=quoted>"es_inputs_are_events <span class=free>ES2</span>"</span></span>
  <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"es_inputs_are_events <span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>unfolding</span></span> composeES_def es_inputs_are_events_def
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>simp</span><span class=main>)</span>
      <span class=keyword1><span class=command>have</span></span> subgoal11<span class=main>:</span> <span class=quoted><span class=quoted>"I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
        <span class=keyword3><span class=command>fix</span></span> <span class=skolem>x</span>
        <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>with</span></span> ES1_inputs_are_events  <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> es_inputs_are_events_def<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>have</span></span> subgoal12<span class=main>:</span> <span class=quoted><span class=quoted>"I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>    
      <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>rule</span> subsetI<span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> UnI2<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword3><span class=command>fix</span></span> <span class=skolem>x</span>
        <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>with</span></span> ES2_inputs_are_events <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> es_inputs_are_events_def<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>from</span></span> subgoal11 subgoal12 
      <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>assume</span></span> ES1_outputs_are_events<span class=main>:</span> <span class=quoted><span class=quoted>"es_outputs_are_events <span class=free>ES1</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> ES2_outputs_are_events<span class=main>:</span> <span class=quoted><span class=quoted>"es_outputs_are_events <span class=free>ES2</span>"</span></span>
  <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"es_outputs_are_events <span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> composeES_def es_outputs_are_events_def
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>simp</span><span class=main>)</span>
      <span class=keyword1><span class=command>have</span></span> subgoal21<span class=main>:</span> <span class=quoted><span class=quoted>"O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
        <span class=keyword3><span class=command>fix</span></span> <span class=skolem>x</span>
        <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>with</span></span> ES1_outputs_are_events  <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> es_outputs_are_events_def<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>have</span></span> subgoal22<span class=main>:</span> <span class=quoted><span class=quoted>"O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>    
      <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>rule</span> subsetI<span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> UnI2<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword3><span class=command>fix</span></span> <span class=skolem>x</span>
        <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>with</span></span> ES2_outputs_are_events <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> es_outputs_are_events_def<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>from</span></span> subgoal21 subgoal22 
      <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>assume</span></span> ES1_inputs_outputs_disjoint<span class=main>:</span> <span class=quoted><span class=quoted>"es_inputs_outputs_disjoint <span class=free>ES1</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> ES2_inputs_outputs_disjoint<span class=main>:</span> <span class=quoted><span class=quoted>"es_inputs_outputs_disjoint <span class=free>ES2</span>"</span></span>
  <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"es_inputs_outputs_disjoint <span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> composeES_def es_inputs_outputs_disjoint_def
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>simp</span><span class=main>)</span>
      <span class=keyword1><span class=command>have</span></span> subgoal31<span class=main>:</span>
        <span class=quoted><span class=quoted>"<span class=main>{}</span> <span class=main>⊆</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∩</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>have</span></span> subgoal32<span class=main>:</span>
        <span class=quoted><span class=quoted>"<span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∩</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>{}</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>rule</span> subsetI<span class=main><span class=keyword3>,</span></span> <span class=operator>erule</span> IntE<span class=main>)</span>
      <span class=keyword3><span class=command>fix</span></span> <span class=skolem>x</span>
      <span class=keyword3><span class=command>assume</span></span> ass1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>then</span></span> <span class=keyword1><span class=command>have</span></span> ass1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∨</span> <span class=skolem>x</span> <span class=main>∈</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword3><span class=command>assume</span></span> ass2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>then</span></span> <span class=keyword1><span class=command>have</span></span> ass2'<span class=main>:</span><span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∨</span> <span class=skolem>x</span> <span class=main>∈</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>note</span></span> ass1'
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> left1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>note</span></span> ass2'
        <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
          <span class=keyword3><span class=command>assume</span></span> left2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>with</span></span> left1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span><span class=main>∈</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
          <span class=keyword1><span class=command>with</span></span> ES1_inputs_outputs_disjoint <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span><span class=main>∈</span><span class=main>{}</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> es_inputs_outputs_disjoint_def<span class=main>)</span>
        <span class=keyword1><span class=command>}</span></span>
        <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
          <span class=keyword3><span class=command>assume</span></span> right2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>with</span></span> left1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span><span class=main>∈</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span><span class=main>∈</span><span class=main>{}</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>                
        <span class=keyword1><span class=command>}</span></span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span><span class=main>∈</span><span class=main>{}</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> right1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>note</span></span> ass2'
        <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
          <span class=keyword3><span class=command>assume</span></span> left2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>with</span></span> right1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span><span class=main>∈</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span><span class=main>∈</span><span class=main>{}</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>}</span></span>
        <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
          <span class=keyword3><span class=command>assume</span></span> right2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>with</span></span> right1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>with</span></span> ES2_inputs_outputs_disjoint <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span><span class=main>∈</span><span class=main>{}</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> es_inputs_outputs_disjoint_def<span class=main>)</span>
        <span class=keyword1><span class=command>}</span></span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span><span class=main>∈</span><span class=main>{}</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span><span class=main>∈</span><span class=main>{}</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
    <span class=keyword1><span class=command>qed</span></span>

    <span class=keyword1><span class=command>from</span></span> subgoal31 subgoal32 
    <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∩</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>O<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> I<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> <span class=main>{}</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"traces_contain_events <span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>unfolding</span></span> composeES_def traces_contain_events_def
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>clarsimp</span><span class=main>)</span>
      <span class=keyword3><span class=command>fix</span></span> <span class=skolem>l</span> <span class=skolem>e</span>
      <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> set <span class=skolem>l</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>l</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>then</span></span> <span class=keyword1><span class=command>have</span></span> e_in_union<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>with</span></span> e_in_union <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>assume</span></span> ES1_traces_prefixclosed<span class=main>:</span> <span class=quoted><span class=quoted>"traces_prefixclosed <span class=free>ES1</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> ES2_traces_prefixclosed<span class=main>:</span> <span class=quoted><span class=quoted>"traces_prefixclosed <span class=free>ES2</span>"</span></span>
  <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"traces_prefixclosed <span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> composeES_def traces_prefixclosed_def prefixclosed_def prefix_def
  <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>clarsimp</span><span class=main>)</span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>l2</span> <span class=skolem>l3</span>
    <span class=keyword1><span class=command>have</span></span> l2l3split<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>@</span> <span class=skolem>l3</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_concatenation_commute<span class=main>)</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>@</span> <span class=skolem>l3</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> l2l3split <span class=keyword1><span class=command>have</span></span> l2l3cattrace<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>have</span></span> theprefix<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>≼</span> <span class=main>(</span><span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> prefix_def<span class=main>)</span>
    <span class=keyword1><span class=command>have</span></span> prefixclosure<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>es1</span> <span class=main>∈</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> <span class=main>∀</span> <span class=bound>es2</span><span class=main>.</span> <span class=bound>es2</span> <span class=main>≼</span> <span class=bound>es1</span> <span class=main>⟶</span> <span class=bound>es2</span> <span class=main>∈</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>clarsimp</span><span class=main><span class=keyword3>,</span></span> <span class=operator>insert</span> ES1_traces_prefixclosed<span class=main><span class=keyword3>,</span></span> <span class=operator>unfold</span> traces_prefixclosed_def prefixclosed_def<span class=main><span class=keyword3>,</span></span> 
        <span class=operator>erule_tac</span> x<span class=main><span class=main>=</span></span><span class=quoted><span class=quoted>"<span class=improper>es1</span>"</span></span> <span class=keyword2><span class=keyword><span class=quasi_keyword>in</span></span></span> ballE<span class=main><span class=keyword3>,</span></span> <span class=operator>erule_tac</span> x<span class=main><span class=main>=</span></span><span class=quoted><span class=quoted>"<span class=improper>es2</span>"</span></span> <span class=keyword2><span class=keyword><span class=quasi_keyword>in</span></span></span> allE<span class=main><span class=keyword3>,</span></span> <span class=operator>erule</span> impE<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> 
      <span class=quoted><span class=quoted>" <span class=main>(</span><span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> <span class=main>∀</span> <span class=bound>es2</span><span class=main>.</span> <span class=bound>es2</span> <span class=main>≼</span> <span class=main>(</span><span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>
         <span class=main>⟶</span> <span class=bound>es2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
    <span class=keyword1><span class=command>with</span></span> l2l3cattrace <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>es2</span><span class=main>.</span> <span class=bound>es2</span> <span class=main>≼</span> <span class=main>(</span><span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>⟶</span> <span class=bound>es2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>≼</span> <span class=main>(</span><span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>⟶</span> <span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
    <span class=keyword1><span class=command>with</span></span> theprefix <span class=keyword1><span class=command>have</span></span> goal51<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>have</span></span> l2l3split<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>@</span> <span class=skolem>l3</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_concatenation_commute<span class=main>)</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>@</span> <span class=skolem>l3</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> l2l3split <span class=keyword1><span class=command>have</span></span> l2l3cattrace<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>have</span></span> theprefix<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>≼</span> <span class=main>(</span><span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> prefix_def<span class=main>)</span>
    <span class=keyword1><span class=command>have</span></span> prefixclosure<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>es1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>es2</span><span class=main>.</span> <span class=bound>es2</span> <span class=main>≼</span> <span class=bound>es1</span> <span class=main>⟶</span> <span class=bound>es2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>clarsimp</span><span class=main><span class=keyword3>,</span></span> <span class=operator>insert</span> ES2_traces_prefixclosed<span class=main><span class=keyword3>,</span></span> 
        <span class=operator>unfold</span> traces_prefixclosed_def prefixclosed_def<span class=main><span class=keyword3>,</span></span> 
        <span class=operator>erule_tac</span> x<span class=main><span class=main>=</span></span><span class=quoted><span class=quoted>"<span class=improper>es1</span>"</span></span> <span class=keyword2><span class=keyword><span class=quasi_keyword>in</span></span></span> ballE<span class=main><span class=keyword3>,</span></span> <span class=operator>erule_tac</span> x<span class=main><span class=main>=</span></span><span class=quoted><span class=quoted>"<span class=improper>es2</span>"</span></span> <span class=keyword2><span class=keyword><span class=quasi_keyword>in</span></span></span> allE<span class=main><span class=keyword3>,</span></span> <span class=operator>erule</span> impE<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>" <span class=main>(</span><span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
      <span class=main>⟹</span> <span class=main>∀</span> <span class=bound>es2</span><span class=main>.</span> <span class=bound>es2</span> <span class=main>≼</span> <span class=main>(</span><span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>⟶</span> <span class=bound>es2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
    <span class=keyword1><span class=command>with</span></span> l2l3cattrace <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>es2</span><span class=main>.</span> <span class=bound>es2</span> <span class=main>≼</span> <span class=main>(</span><span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>⟶</span> <span class=bound>es2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>≼</span> <span class=main>(</span><span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>l3</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>⟶</span> <span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
    <span class=keyword1><span class=command>with</span></span> theprefix <span class=keyword1><span class=command>have</span></span> goal52<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>from</span></span> goal51 goal52 <span class=keyword3><span class=command>show</span></span> goal5<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>l2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span> 
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword2><span class=keyword>end</span></span> 
</pre>
</div><div id=StateEventSystems>
<div class=head>
<h1>Theory StateEventSystems</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> StateEventSystems
<span class=keyword2><span class=keyword>imports</span></span> <a href=#EventSystems>EventSystems</a>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* structural representation of state event systems *)</span>
<span class=keyword1><span class=command>record</span></span> <span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>=</span> 
  S_SES <span class=main>::</span>  <span class=quoted><span class=quoted>"<span class=tfree>'s</span> set"</span></span>
  s0_SES <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'s</span>"</span></span>
  E_SES <span class=main>::</span>  <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>
  I_SES <span class=main>::</span>  <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>
  O_SES <span class=main>::</span>  <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>
  T_SES <span class=main>::</span>  <span class=quoted><span class=quoted>"<span class=tfree>'s</span> <span class=main>⇒</span> <span class=tfree>'e</span> <span class=main>⇀</span> <span class=tfree>'s</span>"</span></span>

<span class=comment1>(* syntax abbreviations for SES_rec *)</span>
<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>SESrecSSES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=tfree>'s</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>S⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>1000<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"S<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>S_SES <span class=free><span class=bound><span class=entity>SES</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>SESrecs0SES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=tfree>'s</span>"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>s0⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>1000<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>s0_SES <span class=free><span class=bound><span class=entity>SES</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>SESrecESES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>E⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>1000<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>E_SES <span class=free><span class=bound><span class=entity>SES</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>SESrecISES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>I⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>1000<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>I_SES <span class=free><span class=bound><span class=entity>SES</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>SESrecOSES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>O⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>1000<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>O_SES <span class=free><span class=bound><span class=entity>SES</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>SESrecTSES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'s</span> <span class=main>⇒</span> <span class=tfree>'e</span> <span class=main>⇀</span> <span class=tfree>'s</span><span class=main>)</span>"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>T⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>1000<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"T<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>T_SES <span class=free><span class=bound><span class=entity>SES</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>TSESpred</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'s</span> <span class=main>⇒</span> <span class=tfree>'e</span> <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=tfree>'s</span> <span class=main>⇒</span> bool"</span></span>
<span class=main>(</span><span class=quoted>"_ _<span class=keyword1>⟶⇘</span>_<span class=keyword1>⇙</span> _"</span> <span class=main>[</span>100<span class=main>,</span>100<span class=main>,</span>100<span class=main>,</span>100<span class=main>]</span> 100<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free><span class=bound><span class=entity>s</span></span></span> <span class=free><span class=bound><span class=entity>e</span></span></span>⟶<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=free><span class=bound><span class=entity>s'</span></span></span> <span class=main>≡</span> <span class=main>(</span>T<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=free><span class=bound><span class=entity>s</span></span></span> <span class=free><span class=bound><span class=entity>e</span></span></span> <span class=main>=</span> Some <span class=free><span class=bound><span class=entity>s'</span></span></span><span class=main>)</span>"</span></span>

<span class=comment1>(* side conditions for state event systems *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>s0_is_state</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>s0_is_state</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>≡</span> s0<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>ses_inputs_are_events</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>ses_inputs_are_events</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>≡</span> I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>ses_outputs_are_events</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>ses_outputs_are_events</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>≡</span> O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>ses_inputs_outputs_disjoint</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>ses_inputs_outputs_disjoint</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>≡</span> I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>correct_transition_relation</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>correct_transition_relation</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>≡</span>
 <span class=main>∀</span><span class=bound>x</span> <span class=bound>y</span> <span class=bound>z</span><span class=main>.</span> <span class=bound>x</span> <span class=bound>y</span>⟶<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=bound>z</span> <span class=main>⟶</span> <span class=main>(</span><span class=main>(</span><span class=bound>x</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>y</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>z</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=comment1>(* State event systems are instances of SES_rec that satisfy SES_valid. *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>SES_valid</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>SES_valid</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>≡</span> 
  s0_is_state <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>∧</span> ses_inputs_are_events <span class=free><span class=bound><span class=entity>SES</span></span></span> 
  <span class=main>∧</span> ses_outputs_are_events <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>∧</span> ses_inputs_outputs_disjoint <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>∧</span>
  correct_transition_relation <span class=free><span class=bound><span class=entity>SES</span></span></span>"</span></span>

<span class=comment1>(* auxiliary definitions for state event systems *)</span>

<span class=comment1>(* Paths in state event systems *)</span>
<span class=keyword1><span class=command>primrec</span></span> <span class=entity>path</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=tfree>'s</span> <span class=main>⇒</span> <span class=tfree>'e</span> list <span class=main>⇀</span> <span class=tfree>'s</span>"</span></span> 
<span class=keyword2><span class=keyword>where</span></span>
path_empt<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>path</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=free><span class=bound><span class=entity>s1</span></span></span> <span class=main>[]</span> <span class=main>=</span> <span class=main>(</span>Some <span class=free><span class=bound><span class=entity>s1</span></span></span><span class=main>)</span>"</span></span> <span class=main>|</span>
path_nonempt<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>path</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=free><span class=bound><span class=entity>s1</span></span></span> <span class=main>(</span><span class=free><span class=bound><span class=entity>e</span></span></span> <span class=main>#</span> <span class=free><span class=bound><span class=entity>t</span></span></span><span class=main>)</span> <span class=main>=</span> 
  <span class=main>(</span><span class=keyword1>if</span> <span class=main>(</span><span class=main>∃</span><span class=bound>s2</span><span class=main>.</span> <span class=free><span class=bound><span class=entity>s1</span></span></span> <span class=free><span class=bound><span class=entity>e</span></span></span>⟶<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=bound>s2</span><span class=main>)</span> 
  <span class=keyword1>then</span> <span class=main>(</span><span class=free>path</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>(</span>the <span class=main>(</span>T<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=free><span class=bound><span class=entity>s1</span></span></span> <span class=free><span class=bound><span class=entity>e</span></span></span><span class=main>)</span><span class=main>)</span> <span class=free><span class=bound><span class=entity>t</span></span></span><span class=main>)</span> 
  <span class=keyword1>else</span> None<span class=main>)</span>"</span></span> 

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>pathpred</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'s</span> <span class=main>⇒</span> <span class=tfree>'e</span> list <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=tfree>'s</span> <span class=main>⇒</span> bool"</span></span>
<span class=main>(</span><span class=quoted>"_ _<span class=keyword1>⟹⇘</span>_<span class=keyword1>⇙</span> _"</span> <span class=main>[</span>100<span class=main>,</span> 100<span class=main>,</span> 100<span class=main>,</span> 100<span class=main>]</span> 100<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free><span class=bound><span class=entity>s</span></span></span> <span class=free><span class=bound><span class=entity>t</span></span></span>⟹<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=free><span class=bound><span class=entity>s'</span></span></span> <span class=main>≡</span> path <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=free><span class=bound><span class=entity>s</span></span></span> <span class=free><span class=bound><span class=entity>t</span></span></span> <span class=main>=</span> Some <span class=free><span class=bound><span class=entity>s'</span></span></span>"</span></span>

<span class=comment1>(* A state s is reachable in a state event system if there is a path from the initial state
of the state event system to state s. *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>reachable</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=tfree>'s</span> <span class=main>⇒</span> bool"</span></span> 
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>reachable</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=free><span class=bound><span class=entity>s</span></span></span> <span class=main>≡</span> <span class=main>(</span><span class=main>∃</span><span class=bound>t</span><span class=main>.</span> s0<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=bound>t</span>⟹<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=free><span class=bound><span class=entity>s</span></span></span><span class=main>)</span>"</span></span>

<span class=comment1>(* A trace t is enabled in a state s if there is a path t from s to some other state.*)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>enabled</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=tfree>'s</span> <span class=main>⇒</span> <span class=tfree>'e</span> list <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>enabled</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=free><span class=bound><span class=entity>s</span></span></span> <span class=free><span class=bound><span class=entity>t</span></span></span> <span class=main>≡</span> <span class=main>(</span><span class=main>∃</span><span class=bound>s'</span><span class=main>.</span> <span class=free><span class=bound><span class=entity>s</span></span></span> <span class=free><span class=bound><span class=entity>t</span></span></span>⟹<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=bound>s'</span><span class=main>)</span>"</span></span>

<span class=comment1>(* The set of possible traces in a state event system SES is the set of traces that are enabled in
the initial state of SES. *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>possible_traces</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>possible_traces</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>≡</span> <span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>enabled <span class=free><span class=bound><span class=entity>SES</span></span></span> s0<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span> <span class=bound>t</span><span class=main>)</span><span class=main>}</span>"</span></span>

<span class=comment1>(* structural representation of the event system induced by a state event system *)</span> 
<span class=keyword1><span class=command>definition</span></span> <span class=entity>induceES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec <span class=main>⇒</span> <span class=tfree>'e</span> ES_rec"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>induceES</span> <span class=free><span class=bound><span class=entity>SES</span></span></span> <span class=main>≡</span> 
 <span class=main>⦇</span> 
  E_ES <span class=main>=</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span><span class=main>,</span> 
  I_ES <span class=main>=</span> I<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span><span class=main>,</span> 
  O_ES  <span class=main>=</span> O<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>SES</span></span></span></sub><span class=hidden>⇙</span><span class=main>,</span> 
  Tr_ES <span class=main>=</span> possible_traces <span class=free><span class=bound><span class=entity>SES</span></span></span> 
 <span class=main>⦈</span>"</span></span>
<span class=comment1>(* auxiliary lemmas for state event systems *)</span>

<span class=comment1>(* If some event sequence is not enabled in a state,
  then it will not become possible by appending events. *)</span>
<span class=keyword1 id=StateEventSystems-none_remains_none><span class=command>lemma</span></span> none_remains_none <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⋀</span> <span class=bound>s</span> <span class=bound>e</span><span class=main>.</span> <span class=main>(</span>path <span class=free>SES</span> <span class=bound>s</span> <span class=free>t</span><span class=main>)</span> <span class=main>=</span> None 
  <span class=main>⟹</span> <span class=main>(</span>path <span class=free>SES</span> <span class=bound>s</span> <span class=main>(</span><span class=free>t</span> <span class=main>@</span> <span class=main>[</span><span class=bound>e</span><span class=main>]</span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> None"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>t</span></span><span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

<span class=comment1>(* If some event sequence t is enabled in a state s in which
 some event e is not enabled, then the event sequence
 obtained by appending e to t is not enabled in s. *)</span>
<span class=keyword1 id=StateEventSystems-path_trans_single_neg><span class=command>lemma</span></span> path_trans_single_neg<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⋀</span> <span class=bound>s1</span><span class=main>.</span> <span class=main>⟦</span><span class=bound>s1</span> <span class=free>t</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s2</span><span class=main>;</span> <span class=main>¬</span> <span class=main>(</span><span class=free>s2</span> <span class=free>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>sn</span><span class=main>)</span><span class=main>⟧</span> 
     <span class=main>⟹</span> <span class=main>¬</span> <span class=main>(</span><span class=bound>s1</span> <span class=main>(</span><span class=free>t</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>sn</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>t</span></span><span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

<span class=comment1>(* If the event sequence t:e is enabled in some state, then 
  the event sequence t is also enabled and results in some state t' *)</span>
<span class=keyword1 id=StateEventSystems-path_split_single><span class=command>lemma</span></span> path_split_single<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>s1</span> <span class=main>(</span><span class=free>t</span><span class=main>@</span><span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>sn</span> 
  <span class=main>⟹</span> <span class=main>∃</span><span class=bound>s'</span><span class=main>.</span> <span class=free>s1</span> <span class=free>t</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span>  <span class=main>∧</span> <span class=bound>s'</span> <span class=free>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>sn</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=quoted>"path <span class=free>SES</span> <span class=free>s1</span> <span class=free>t</span>"</span></span><span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> none_remains_none<span class=main><span class=keyword3>,</span></span>
    <span class=operator>simp</span><span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> ccontr<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> path_trans_single_neg<span class=main>)</span>


<span class=comment1>(* If an event sequence results in a state s', from which the event e results in sn,
  then the combined event sequence also results in sn *)</span>
<span class=keyword1 id=StateEventSystems-path_trans_single><span class=command>lemma</span></span> path_trans_single<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>s</span><span class=main>.</span> <span class=main>⟦</span> <span class=bound>s</span> <span class=free>t</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s'</span><span class=main>;</span> <span class=free>s'</span> <span class=free>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>sn</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> <span class=bound>s</span> <span class=main>(</span><span class=free>t</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>sn</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>t</span></span><span class=main>)</span>
  <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>a</span> <span class=skolem>t</span><span class=main>)</span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> Cons <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1'</span></span> <span class=keyword2><span class=keyword>where</span></span> trans_s_a_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s</span> <span class=skolem>a</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span><span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> Cons <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>(</span><span class=skolem>t</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>sn</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> trans_s_a_s1' <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* We can split a path from s1 to sn via the event sequence t1:t2
 into two paths from s1 to s2 via t1 and from s2 to sn via t2  *)</span>
<span class=keyword1 id=StateEventSystems-path_split><span class=command>lemma</span></span> path_split<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⋀</span> <span class=bound>sn</span><span class=main>.</span> <span class=main>⟦</span> <span class=free>s1</span> <span class=main>(</span><span class=free>t1</span> <span class=main>@</span> <span class=free>t2</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>sn</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> <span class=main>(</span><span class=main>∃</span><span class=bound>s2</span><span class=main>.</span> <span class=main>(</span><span class=free>s1</span> <span class=free>t1</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s2</span> <span class=main>∧</span> <span class=bound>s2</span> <span class=free>t2</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>sn</span><span class=main>)</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>t2</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
  <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>a</span> <span class=skolem>t</span><span class=main>)</span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> snoc <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>s1</span> <span class=main>(</span><span class=free>t1</span> <span class=main>@</span> <span class=skolem>t</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>a</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>sn'</span><span class=main>.</span> <span class=free>s1</span> <span class=main>(</span><span class=free>t1</span> <span class=main>@</span> <span class=skolem>t</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>sn'</span> <span class=main>∧</span> <span class=bound>sn'</span> <span class=skolem>a</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> path_split_single<span class=main>)</span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>sn'</span></span> <span class=keyword2><span class=keyword>where</span></span> path_t1_t_trans_a<span class=main>:</span> 
      <span class=quoted><span class=quoted>"<span class=free>s1</span> <span class=main>(</span><span class=free>t1</span> <span class=main>@</span> <span class=skolem>t</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn'</span> <span class=main>∧</span> <span class=skolem>sn'</span> <span class=skolem>a</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> snoc <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s2</span></span> <span class=keyword2><span class=keyword>where</span></span> path_t1_t<span class=main>:</span> 
      <span class=quoted><span class=quoted>"<span class=free>s1</span> <span class=free>t1</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span> <span class=main>∧</span> <span class=skolem>s2</span> <span class=skolem>t</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> path_t1_t_trans_a <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>(</span><span class=skolem>t</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>a</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> path_trans_single<span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> path_t1_t <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Two paths can be concatenated. *)</span>
<span class=keyword1 id=StateEventSystems-path_trans><span class=command>lemma</span></span> path_trans<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>sn</span><span class=main>.</span> <span class=main>⟦</span> <span class=free>s1</span> <span class=free>l1</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s2</span><span class=main>;</span> <span class=free>s2</span> <span class=free>l2</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>sn</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=free>s1</span> <span class=main>(</span><span class=free>l1</span> <span class=main>@</span> <span class=free>l2</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>sn</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>l2</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
  <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>a</span> <span class=skolem>l</span><span class=main>)</span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword3><span class=command>assume</span></span> path_l1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>s1</span> <span class=free>l1</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s2</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=free>s2</span> <span class=main>(</span><span class=skolem>l</span><span class=main>@</span><span class=main>[</span><span class=skolem>a</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn</span>"</span></span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>sn'</span><span class=main>.</span> <span class=free>s2</span> <span class=skolem>l</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>sn'</span> <span class=main>∧</span> <span class=bound>sn'</span> <span class=main>[</span><span class=skolem>a</span><span class=main>]</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> path_split <span class=quasi_keyword>del</span><span class=main><span class=main>:</span></span> path_nonempt<span class=main>)</span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>sn'</span></span> <span class=keyword2><span class=keyword>where</span></span> path_l_a<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>s2</span> <span class=skolem>l</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn'</span> <span class=main>∧</span> <span class=skolem>sn'</span> <span class=main>[</span><span class=skolem>a</span><span class=main>]</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> snoc path_l1 <span class=keyword1><span class=command>have</span></span> path_l1_l<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>s1</span> <span class=main>(</span><span class=free>l1</span><span class=main>@</span><span class=skolem>l</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> path_l_a <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>sn'</span> <span class=skolem>a</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span><span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> path_l1_l <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=free>s1</span> <span class=main>(</span><span class=free>l1</span> <span class=main>@</span> <span class=skolem>l</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>a</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> append_assoc<span class=main><span class=main>[</span></span><span class=operator>symmetric</span><span class=main><span class=main>]</span></span><span class=main><span class=keyword3>,</span></span> <span class=operator>rule_tac</span> s'<span class=main><span class=main>=</span></span><span class=quoted><span class=quoted>"<span class=skolem>sn'</span>"</span></span> <span class=keyword2><span class=keyword><span class=quasi_keyword>in</span></span></span> path_trans_single<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>	


<span class=comment1>(* The prefix of an enabled trace is also enabled. (This lemma cuts of the last element.) *)</span>
<span class=keyword1 id=StateEventSystems-enabledPrefixSingle><span class=command>lemma</span></span> enabledPrefixSingle <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> enabled <span class=free>SES</span> <span class=free>s</span> <span class=main>(</span><span class=free>t</span><span class=main>@</span><span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span> <span class=main>⟧</span> <span class=main>⟹</span> enabled <span class=free>SES</span> <span class=free>s</span> <span class=free>t</span>"</span></span>
<span class=keyword1><span class=command>unfolding</span></span> enabled_def
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> ass<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s'</span><span class=main>.</span> <span class=free>s</span> <span class=main>(</span><span class=free>t</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span>"</span></span>
  <span class=keyword1><span class=command>from</span></span> ass <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=free>s</span> <span class=main>(</span><span class=free>t</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>t'</span><span class=main>.</span> <span class=main>(</span><span class=free>s</span> <span class=free>t</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>t'</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t'</span> <span class=free>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_split_single<span class=main>)</span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=free>s</span> <span class=free>t</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>t'</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
  <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s'</span><span class=main>.</span> <span class=free>s</span> <span class=free>t</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(* The prefix of an enabled trace is also enabled.
    (This lemma cuts of a suffix trace.) *)</span>
<span class=keyword1 id=StateEventSystems-enabledPrefix><span class=command>lemma</span></span> enabledPrefix <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> enabled <span class=free>SES</span> <span class=free>s</span> <span class=main>(</span><span class=free>t1</span> <span class=main>@</span> <span class=free>t2</span><span class=main>)</span> <span class=main>⟧</span> <span class=main>⟹</span> enabled <span class=free>SES</span> <span class=free>s</span> <span class=free>t1</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> enabled_def
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
  <span class=keyword3><span class=command>assume</span></span> ass<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s'</span><span class=main>.</span> <span class=free>s</span> <span class=main>(</span><span class=free>t1</span> <span class=main>@</span> <span class=free>t2</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span>"</span></span>
  <span class=keyword1><span class=command>from</span></span> ass <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=free>s</span> <span class=main>(</span><span class=free>t1</span> <span class=main>@</span> <span class=free>t2</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=free>s</span> <span class=free>t1</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>t</span> <span class=main>∧</span> <span class=bound>t</span> <span class=free>t2</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_split<span class=main>)</span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=free>s</span> <span class=free>t1</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>t</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s'</span><span class=main>.</span> <span class=free>s</span> <span class=free>t1</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(* The last element of an enabled trace makes a transition between two states. *)</span>
<span class=keyword1 id=StateEventSystems-enabledPrefixSingleFinalStep><span class=command>lemma</span></span> enabledPrefixSingleFinalStep <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> enabled <span class=free>SES</span> <span class=free>s</span> <span class=main>(</span><span class=free>t</span><span class=main>@</span><span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>t'</span> <span class=bound>t''</span><span class=main>.</span> <span class=bound>t'</span> <span class=free>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>t''</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> enabled_def
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> ass<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s'</span><span class=main>.</span> <span class=free>s</span> <span class=main>(</span><span class=free>t</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span>"</span></span> 
  <span class=keyword1><span class=command>from</span></span> ass <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=free>s</span> <span class=main>(</span><span class=free>t</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span>"</span></span> <span class=keyword1><span class=command>..</span></span> 
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>t'</span><span class=main>.</span> <span class=main>(</span><span class=free>s</span> <span class=free>t</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>t'</span><span class=main>)</span>  <span class=main>∧</span> <span class=main>(</span><span class=bound>t'</span> <span class=free>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_split_single<span class=main>)</span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=free>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
  <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>t'</span> <span class=bound>t''</span><span class=main>.</span> <span class=bound>t'</span> <span class=free>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>t''</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(* applying induceES on a state event system yields an event system *)</span>
<span class=keyword1 id=StateEventSystems-induceES_yields_ES><span class=command>lemma</span></span> induceES_yields_ES<span class=main>:</span> 
  <span class=quoted><span class=quoted>"SES_valid <span class=free>SES</span> <span class=main>⟹</span> ES_valid <span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> SES_valid_def ES_valid_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword3><span class=command>assume</span></span> SES_inputs_are_events<span class=main>:</span> <span class=quoted><span class=quoted>"ses_inputs_are_events <span class=free>SES</span>"</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"es_inputs_are_events <span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def ses_inputs_are_events_def es_inputs_are_events_def<span class=main>)</span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>assume</span></span> SES_outputs_are_events<span class=main>:</span> <span class=quoted><span class=quoted>"ses_outputs_are_events <span class=free>SES</span>"</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"es_outputs_are_events <span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def ses_outputs_are_events_def es_outputs_are_events_def<span class=main>)</span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>assume</span></span> SES_inputs_outputs_disjoint<span class=main>:</span> <span class=quoted><span class=quoted>"ses_inputs_outputs_disjoint <span class=free>SES</span>"</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"es_inputs_outputs_disjoint <span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def ses_inputs_outputs_disjoint_def es_inputs_outputs_disjoint_def<span class=main>)</span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>assume</span></span> SES_correct_transition_relation<span class=main>:</span> <span class=quoted><span class=quoted>"correct_transition_relation <span class=free>SES</span>"</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"traces_contain_events <span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> induceES_def traces_contain_events_def possible_traces_def
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>l</span> <span class=skolem>e</span>
    <span class=keyword3><span class=command>assume</span></span> enabled_l<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>l</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> e_in_l<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> set <span class=skolem>l</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> enabled_l e_in_l <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>l</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
      <span class=keyword3><span class=command>case</span></span> Nil 
        <span class=keyword3><span class=command>assume</span></span> e_in_empty_list<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> set <span class=main>[]</span>"</span></span> 
        <span class=keyword1><span class=command>hence</span></span> f<span class=main>:</span> <span class=quoted><span class=quoted>"False"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span> 
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>a</span> <span class=skolem>l</span><span class=main>)</span>
      <span class=keyword1><span class=command>from</span></span> snoc.prems <span class=keyword1><span class=command>have</span></span> l_enabled<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>l</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabledPrefixSingle<span class=main>)</span>
        <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
          <span class=keyword1><span class=command>proof</span></span>  <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> <span class=main>(</span>set <span class=skolem>l</span><span class=main>)</span>"</span></span><span class=main>)</span>
            <span class=keyword1><span class=command>from</span></span> snoc.hyps l_enabled <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> set <span class=skolem>l</span> <span class=main>⟹</span> <span class=skolem>e</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∉</span> set <span class=skolem>l</span> <span class=main>⟹</span> <span class=skolem>e</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∉</span> set <span class=skolem>l</span>"</span></span>
                <span class=keyword1><span class=command>with</span></span> snoc.prems <span class=keyword1><span class=command>have</span></span> e_eq_a <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span><span class=main>=</span><span class=skolem>a</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>from</span></span> snoc.prems <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>t</span> <span class=bound>t'</span><span class=main>.</span> <span class=bound>t</span> <span class=skolem>a</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>t'</span>"</span></span> 
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabledPrefixSingleFinalStep<span class=main>)</span>
                <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t</span></span> <span class=skolem><span class=skolem>t'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=skolem>a</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>t'</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>with</span></span> e_eq_a SES_correct_transition_relation <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span> 
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> correct_transition_relation_def<span class=main>)</span>
             <span class=keyword1><span class=command>qed</span></span>
         <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>qed</span></span>
   <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"traces_prefixclosed <span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>unfolding</span></span> traces_prefixclosed_def prefixclosed_def induceES_def possible_traces_def prefix_def
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>clarsimp</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabledPrefix<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=Views>
<div class=head>
<h1>Theory Views</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> Views
<span class=keyword2><span class=keyword>imports</span></span> <a href=https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/HOL/HOL/Main.html>Main</a>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* structural representation of views *)</span>
<span class=keyword1><span class=command>record</span></span> <span class=tfree>'e</span> V_rec <span class=main>=</span>
  V <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>
  N <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>
  C <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>

<span class=comment1>(* syntax abbreviations for V_rec *)</span>
<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>VrecV</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>V⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>100<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>v</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>V <span class=free><span class=bound><span class=entity>v</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>VrecN</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>N⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>100<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>v</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>N <span class=free><span class=bound><span class=entity>v</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>VrecC</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>C⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>100<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>v</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>C <span class=free><span class=bound><span class=entity>v</span></span></span><span class=main>)</span>"</span></span>

<span class=comment1>(* side conditions for views *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>VN_disjoint</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>VN_disjoint</span> <span class=free><span class=bound><span class=entity>v</span></span></span> <span class=main>≡</span> V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>v</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>v</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>VC_disjoint</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>VC_disjoint</span> <span class=free><span class=bound><span class=entity>v</span></span></span> <span class=main>≡</span> V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>v</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>v</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>NC_disjoint</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>NC_disjoint</span> <span class=free><span class=bound><span class=entity>v</span></span></span> <span class=main>≡</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>v</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>v</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>

<span class=comment1>(* Views are instances of V_rec that satisfy V_valid. *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>V_valid</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>V_valid</span>  <span class=free><span class=bound><span class=entity>v</span></span></span> <span class=main>≡</span> VN_disjoint <span class=free><span class=bound><span class=entity>v</span></span></span> <span class=main>∧</span> VC_disjoint <span class=free><span class=bound><span class=entity>v</span></span></span> <span class=main>∧</span> NC_disjoint <span class=free><span class=bound><span class=entity>v</span></span></span>"</span></span>

<span class=comment1>(* A view is a view on a set of events iff it covers exactly those events and is a valid view*)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>isViewOn</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> bool"</span></span> 
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>isViewOn</span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>E</span></span></span> <span class=main>≡</span> V_valid <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=main>∧</span> V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=free><span class=bound><span class=entity>E</span></span></span>"</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=FlowPolicies>
<div class=head>
<h1>Theory FlowPolicies</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> FlowPolicies
<span class=keyword2><span class=keyword>imports</span></span> <a href=#Views>Views</a>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* 
  Flow policies
*)</span>
<span class=keyword1><span class=command>record</span></span> <span class=tfree>'domain</span> FlowPolicy_rec <span class=main>=</span> 
  D <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'domain</span> set"</span></span>
  v_rel <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'domain</span> <span class=main>×</span> <span class=tfree>'domain</span><span class=main>)</span> set"</span></span>
  n_rel <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'domain</span> <span class=main>×</span> <span class=tfree>'domain</span><span class=main>)</span> set"</span></span>
  c_rel <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'domain</span> <span class=main>×</span> <span class=tfree>'domain</span><span class=main>)</span> set"</span></span>
<span class=comment1>(*
  The three relations of a flow policy form a partition of DxD.
  Moreover, the relation v_rel is reflexive.
*)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>FlowPolicy</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'domain</span> FlowPolicy_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>FlowPolicy</span> <span class=free><span class=bound><span class=entity>fp</span></span></span> <span class=main>≡</span> 
   <span class=main>(</span><span class=main>(</span>v_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span> <span class=main>∪</span> <span class=main>(</span>n_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span> <span class=main>∪</span> <span class=main>(</span>c_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>(</span>D <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span> <span class=main>×</span> <span class=main>(</span>D <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span><span class=main>)</span><span class=main>)</span>
 <span class=main>∧</span> <span class=main>(</span>v_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span> <span class=main>∩</span> <span class=main>(</span>n_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>{}</span>
 <span class=main>∧</span> <span class=main>(</span>v_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span> <span class=main>∩</span> <span class=main>(</span>c_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>{}</span>
 <span class=main>∧</span> <span class=main>(</span>n_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span> <span class=main>∩</span> <span class=main>(</span>c_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>{}</span> 
 <span class=main>∧</span> <span class=main>(</span><span class=main>∀</span><span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>D <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span><span class=main>.</span> <span class=main>(</span><span class=bound>d</span><span class=main>,</span> <span class=bound>d</span><span class=main>)</span> <span class=main>∈</span> <span class=main>(</span>v_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=comment1>(* 
  Domain assignments and the view of a domain 
*)</span>
<span class=keyword1><span class=command>type_synonym</span></span> <span class=main>(</span><span class=tfree>'e</span><span class=main>,</span> <span class=tfree>'domain</span><span class=main>)</span> dom_type <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> <span class=main>⇀</span> <span class=tfree>'domain</span>"</span></span>

<span class=comment1>(*
  A domain assignment should only assign domains to actual events.
*)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>dom</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span><span class=main>,</span> <span class=tfree>'domain</span><span class=main>)</span> dom_type <span class=main>⇒</span> <span class=tfree>'domain</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>dom</span> <span class=free><span class=bound><span class=entity>domas</span></span></span> <span class=free><span class=bound><span class=entity>dset</span></span></span> <span class=free><span class=bound><span class=entity>es</span></span></span> <span class=main>≡</span> 
<span class=main>(</span><span class=main>∀</span><span class=bound>e</span><span class=main>.</span> <span class=main>∀</span><span class=bound>d</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=free><span class=bound><span class=entity>domas</span></span></span> <span class=bound>e</span> <span class=main>=</span> Some <span class=bound>d</span><span class=main>)</span> <span class=main>⟶</span> <span class=main>(</span><span class=bound>e</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>es</span></span></span> <span class=main>∧</span> <span class=bound>d</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>dset</span></span></span><span class=main>)</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=comment1>(*
  The combination of a domain assignment and a flow policy
  yields a view for each domain.
*)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>view_dom</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'domain</span> FlowPolicy_rec <span class=main>⇒</span> <span class=tfree>'domain</span> <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span><span class=main>,</span> <span class=tfree>'domain</span><span class=main>)</span> dom_type <span class=main>⇒</span> <span class=tfree>'e</span> V_rec"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
  <span class=quoted><span class=quoted>"<span class=free>view_dom</span> <span class=free><span class=bound><span class=entity>fp</span></span></span> <span class=free><span class=bound><span class=entity>d</span></span></span> <span class=free><span class=bound><span class=entity>domas</span></span></span> <span class=main>≡</span> 
   <span class=main>⦇</span> V <span class=main>=</span> <span class=main>{</span><span class=bound>e</span><span class=main>.</span> <span class=main>∃</span><span class=bound>d'</span><span class=main>.</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>domas</span></span></span> <span class=bound>e</span> <span class=main>=</span> Some <span class=bound>d'</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>d'</span><span class=main>,</span> <span class=free><span class=bound><span class=entity>d</span></span></span><span class=main>)</span> <span class=main>∈</span> <span class=main>(</span>v_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span><span class=main>)</span><span class=main>}</span><span class=main>,</span> 
     N <span class=main>=</span> <span class=main>{</span><span class=bound>e</span><span class=main>.</span> <span class=main>∃</span><span class=bound>d'</span><span class=main>.</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>domas</span></span></span> <span class=bound>e</span> <span class=main>=</span> Some <span class=bound>d'</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>d'</span><span class=main>,</span> <span class=free><span class=bound><span class=entity>d</span></span></span><span class=main>)</span> <span class=main>∈</span> <span class=main>(</span>n_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span><span class=main>)</span><span class=main>}</span><span class=main>,</span> 
     C <span class=main>=</span> <span class=main>{</span><span class=bound>e</span><span class=main>.</span> <span class=main>∃</span><span class=bound>d'</span><span class=main>.</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>domas</span></span></span> <span class=bound>e</span> <span class=main>=</span> Some <span class=bound>d'</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>d'</span><span class=main>,</span> <span class=free><span class=bound><span class=entity>d</span></span></span><span class=main>)</span> <span class=main>∈</span> <span class=main>(</span>c_rel <span class=free><span class=bound><span class=entity>fp</span></span></span><span class=main>)</span><span class=main>)</span><span class=main>}</span> <span class=main>⦈</span>"</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=BasicSecurityPredicates>
<div class=head>
<h1>Theory BasicSecurityPredicates</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> BasicSecurityPredicates
<span class=keyword2><span class=keyword>imports</span></span> <a href=#Views>Views</a> <span class=quoted>"<a href=#Projection>../Basics/Projection</a>"</span>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(*Auxiliary predicate capturing that a a set of traces consists 
only of traces of a given set of events *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>areTracesOver</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> bool "</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>areTracesOver</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=free><span class=bound><span class=entity>E</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span> <span class=bound>τ</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=main>(</span>set <span class=bound>τ</span><span class=main>)</span> <span class=main>⊆</span> <span class=free><span class=bound><span class=entity>E</span></span></span>"</span></span>



<span class=comment1>(* Basic Security Predicates are properties of sets of traces
 that are parameterized with a view *)</span>
<span class=keyword1><span class=command>type_synonym</span></span> <span class=tfree>'e</span> BSP <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec <span class=main>⇒</span> <span class=main>(</span><span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set<span class=main>)</span> <span class=main>⇒</span> bool"</span></span>

<span class=comment1>(* Basic Security Predicates are valid if and only if they are closure property of sets of traces 
for arbitrary views and sets of traces *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>BSP_valid</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> BSP <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>BSP_valid</span> <span class=free><span class=bound><span class=entity>bsp</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>𝒱</span> <span class=bound>Tr</span> <span class=bound>E</span><span class=main>.</span> <span class=main>(</span> isViewOn <span class=bound>𝒱</span> <span class=bound>E</span> <span class=main>∧</span> areTracesOver <span class=bound>Tr</span> <span class=bound>E</span> <span class=main>)</span> 
              <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=bound>Tr</span>  <span class=main>∧</span> <span class=free><span class=bound><span class=entity>bsp</span></span></span> <span class=bound>𝒱</span> <span class=bound>Tr'</span><span class=main>)</span>"</span></span>

<span class=comment1>(* Removal of Confidential Events (R) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>R</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>R</span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>τ</span><span class=main>∈</span><span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=main>∃</span><span class=bound>τ'</span><span class=main>∈</span><span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=bound>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=bound>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1 id=BasicSecurityPredicates-BSP_valid_R><span class=command>lemma</span></span> BSP_valid_R<span class=main>:</span> <span class=quoted><span class=quoted>"BSP_valid R"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span><span class=main>::</span><span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> V_rec<span class=main>)</span>"</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"R <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span> 
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>{</span></span>
          <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span>
          <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> <span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
          <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?τ'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=skolem>τ</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>  <span class=main>∧</span> <span class=var>?τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
            <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span>  disjoint_projection projection_idempotent 
            <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def VC_disjoint_def  <span class=keyword1><span class=command>by</span></span> <span class=operator>metis</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ</span> <span class=main>∈</span> <span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?τ'</span> <span class=main>∈</span> <span class=var>?Tr'</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral projection_commute<span class=main>)</span> 
          <span class=keyword1><span class=command>ultimately</span></span> 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>" <span class=main>∃</span><span class=bound>τ'</span><span class=main>∈</span><span class=main>{</span><span class=bound>t</span><span class=main>.</span> set <span class=bound>t</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span><span class=main>.</span> <span class=bound>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>}</span></span>
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> R_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>  
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> R <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>
    
<span class=comment1>(* Deletion of Confidential Events (D) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>D</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>D</span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> 
    <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β'</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=bound>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
                  <span class=main>∧</span> <span class=bound>β'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=bound>β</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=BasicSecurityPredicates-BSP_valid_D><span class=command>lemma</span></span> BSP_valid_D<span class=main>:</span> <span class=quoted><span class=quoted>"BSP_valid D"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span><span class=main>::</span><span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> V_rec<span class=main>)</span>"</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"D <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> D_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> D <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Insertion of Confidential Events (I) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>I</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>I</span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> 
    <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β'</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=bound>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
                     <span class=main>∧</span> <span class=bound>β'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=bound>β</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=BasicSecurityPredicates-BSP_valid_I><span class=command>lemma</span></span> BSP_valid_I<span class=main>:</span> <span class=quoted><span class=quoted>"BSP_valid I"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span><span class=main>::</span><span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> V_rec<span class=main>)</span>"</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"I <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def I_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> I <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(* ρ-Admissibility *)</span>
<span class=keyword1><span class=command>type_synonym</span></span> <span class=tfree>'e</span> Rho <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>

<span class=keyword1><span class=command>definition</span></span> 
<span class=entity>Adm</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec <span class=main>⇒</span> <span class=tfree>'e</span> Rho <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set <span class=main>⇒</span> <span class=tfree>'e</span> list <span class=main>⇒</span> <span class=tfree>'e</span> <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>Adm</span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=free><span class=bound><span class=entity>β</span></span></span> <span class=free><span class=bound><span class=entity>e</span></span></span> <span class=main>≡</span>
   <span class=main>∃</span><span class=bound>γ</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>γ</span> <span class=main>@</span> <span class=main>[</span><span class=free><span class=bound><span class=entity>e</span></span></span><span class=main>]</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>γ</span><span class=main>↿</span><span class=main>(</span><span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=free><span class=bound><span class=entity>β</span></span></span><span class=main>↿</span><span class=main>(</span><span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=comment1>(* Insertion of Admissible Confidential Events (IA) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>IA</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Rho <span class=main>⇒</span> <span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>IA</span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=main>(</span>Adm <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=bound>β</span> <span class=bound>c</span><span class=main>)</span><span class=main>)</span> 
    <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β'</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>)</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=bound>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> 
                    <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>β'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=bound>β</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span> 

<span class=keyword1 id=BasicSecurityPredicates-BSP_valid_IA><span class=command>lemma</span></span> BSP_valid_IA<span class=main>:</span> <span class=quoted><span class=quoted>"BSP_valid <span class=main>(</span>IA <span class=free>ρ</span><span class=main>)</span> "</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'a</span> V_rec<span class=main>)</span>"</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"IA <span class=free>ρ</span> <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def IA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> IA <span class=free>ρ</span> <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(* Backwards Strict Deletion of Confidential Events (BSD) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>BSD</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>BSD</span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> 
    <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=bound>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=BasicSecurityPredicates-BSP_valid_BSD><span class=command>lemma</span></span> BSP_valid_BSD<span class=main>:</span> <span class=quoted><span class=quoted>"BSP_valid BSD"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span><span class=main>::</span><span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> V_rec<span class=main>)</span>"</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSD <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> BSD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> BSD <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Backwards Strict Insertion of Confidential Events (BSI) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>BSI</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>BSI</span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> 
    <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=bound>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=BasicSecurityPredicates-BSP_valid_BSI><span class=command>lemma</span></span> BSP_valid_BSI<span class=main>:</span> <span class=quoted><span class=quoted>"BSP_valid BSI"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span><span class=main>::</span><span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> V_rec<span class=main>)</span>"</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSI <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def BSI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> BSI <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Backwards Strict Insertion of Admissible Confidential Events (BSIA) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>BSIA</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Rho <span class=main>⇒</span> <span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>BSIA</span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=main>(</span>Adm <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=bound>β</span> <span class=bound>c</span><span class=main>)</span><span class=main>)</span> 
    <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=bound>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=BasicSecurityPredicates-BSP_valid_BSIA><span class=command>lemma</span></span> BSP_valid_BSIA<span class=main>:</span> <span class=quoted><span class=quoted>"BSP_valid <span class=main>(</span>BSIA <span class=free>ρ</span><span class=main>)</span> "</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'a</span> V_rec<span class=main>)</span>"</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ</span> <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def BSIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> BSIA <span class=free>ρ</span> <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Forward Correctable BSPs *)</span>
<span class=keyword1><span class=command>record</span></span> <span class=tfree>'e</span> Gamma <span class=main>=</span>
  Nabla <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>
  Delta <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>
  Upsilon <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set"</span></span>

<span class=comment1>(* syntax abbreviations for Gamma *)</span>
<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>GammaNabla</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Gamma <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>∇⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>100<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>Nabla <span class=free><span class=bound><span class=entity>Γ</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>GammaDelta</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Gamma <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>Δ⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>100<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"Δ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>Delta <span class=free><span class=bound><span class=entity>Γ</span></span></span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>GammaUpsilon</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Gamma <span class=main>⇒</span> <span class=tfree>'e</span> set"</span></span>
<span class=main>(</span><span class=quoted>"<span class=keyword1>Υ⇘</span>_<span class=keyword1>⇙</span>"</span> <span class=main>[</span>100<span class=main>]</span> 1000<span class=main>)</span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"Υ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span> <span class=main>≡</span> <span class=main>(</span>Upsilon <span class=free><span class=bound><span class=entity>Γ</span></span></span><span class=main>)</span>"</span></span>


<span class=comment1>(* Forward Correctable Deletion of Confidential Events (FCD) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>FCD</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Gamma <span class=main>⇒</span> <span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>FCD</span> <span class=free><span class=bound><span class=entity>Γ</span></span></span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span><span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> <span class=main>∀</span><span class=bound>v</span><span class=main>∈</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> 
    <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>,</span><span class=bound>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> 
      <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> 
                      <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=bound>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span>  
                      <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=bound>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=BasicSecurityPredicates-BSP_valid_FCD><span class=command>lemma</span></span> BSP_valid_FCD<span class=main>:</span> <span class=quoted><span class=quoted>"BSP_valid <span class=main>(</span>FCD <span class=free>Γ</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span><span class=main>::</span><span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'a</span> V_rec<span class=main>)</span>"</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"FCD <span class=free>Γ</span> <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>{</span></span>
          <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>
          <span class=keyword3><span class=command>assume</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
             <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span>V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
             <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span> <span class=main>,</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> <span class=var>?Tr'</span>"</span></span>
             <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?α'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=skolem>α</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=var><span class=quoted><span class=var>?δ'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>[]</span>"</span></span>  
          <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span> <span class=main>,</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> <span class=var>?Tr'</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=var>?δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α'</span> <span class=main>∈</span> <span class=var>?Tr'</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
          <span class=keyword1><span class=command>hence</span></span>  <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=var>?δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=var>?δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α'</span><span class=main>)</span> <span class=main>∈</span> <span class=var>?Tr'</span>  
                      <span class=main>∧</span> <span class=var>?α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>   
            <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> 
            <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=var>?Tr'</span>  
            <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>}</span></span>
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>unfolding</span></span> FCD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> FCD <span class=free>Γ</span> <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Forward Correctable Insertion of Confidential Events (FCI) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>FCI</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Gamma <span class=main>⇒</span> <span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>FCI</span> <span class=free><span class=bound><span class=entity>Γ</span></span></span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span><span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> <span class=main>∀</span><span class=bound>v</span><span class=main>∈</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> 
    <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> 
      <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> 
                      <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=bound>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span>  
                      <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=bound>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=BasicSecurityPredicates-BSP_valid_FCI><span class=command>lemma</span></span> BSP_valid_FCI<span class=main>:</span> <span class=quoted><span class=quoted>"BSP_valid <span class=main>(</span>FCI <span class=free>Γ</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span><span class=main>::</span><span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'a</span> V_rec<span class=main>)</span>"</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"FCI <span class=free>Γ</span> <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>{</span></span>
          <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>
          <span class=keyword3><span class=command>assume</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
             <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span>V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
             <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> <span class=var>?Tr'</span>"</span></span>
             <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?α'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=skolem>α</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=var><span class=quoted><span class=var>?δ'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>[]</span>"</span></span>  
          <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span><span class=quoted><span class=quoted>" <span class=skolem>c</span> <span class=main>∈</span> <span class=skolem>E</span>"</span></span> 
            <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>with</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> <span class=var>?Tr'</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=var>?δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α'</span> <span class=main>∈</span> <span class=var>?Tr'</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
          <span class=keyword1><span class=command>hence</span></span>  <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=var>?δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=var>?δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α'</span><span class=main>)</span> <span class=main>∈</span> <span class=var>?Tr'</span>  
                      <span class=main>∧</span> <span class=var>?α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>   
           <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span>  <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
         <span class=keyword1><span class=command>hence</span></span> 
           <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=var>?Tr'</span>  
            <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>}</span></span>
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>unfolding</span></span> FCI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> FCI <span class=free>Γ</span> <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Forward correctable Insertion of Admissible Confidential Events (FCIA) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>FCIA</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Rho <span class=main>⇒</span> <span class=tfree>'e</span> Gamma <span class=main>⇒</span> <span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>FCIA</span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>Γ</span></span></span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span><span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> <span class=main>∀</span><span class=bound>v</span><span class=main>∈</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span>
    <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=main>(</span>Adm <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=bound>β</span> <span class=bound>c</span><span class=main>)</span><span class=main>)</span> 
      <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> 
                      <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=bound>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span>  
                      <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=bound>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=BasicSecurityPredicates-BSP_valid_FCIA><span class=command>lemma</span></span> BSP_valid_FCIA<span class=main>:</span> <span class=quoted><span class=quoted>"BSP_valid <span class=main>(</span>FCIA <span class=free>ρ</span> <span class=free>Γ</span><span class=main>)</span> "</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'a</span> V_rec<span class=main>)</span>"</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"FCIA <span class=free>ρ</span> <span class=free>Γ</span> <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>{</span></span>
          <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>
          <span class=keyword3><span class=command>assume</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
             <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span>V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
             <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> <span class=var>?Tr'</span>"</span></span>
             <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?α'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=skolem>α</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=var><span class=quoted><span class=var>?δ'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>[]</span>"</span></span>  
          <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span><span class=quoted><span class=quoted>" <span class=skolem>c</span> <span class=main>∈</span> <span class=skolem>E</span>"</span></span> 
            <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span> <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>with</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> <span class=var>?Tr'</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=var>?δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α'</span> <span class=main>∈</span> <span class=var>?Tr'</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
          <span class=keyword1><span class=command>hence</span></span>  <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=var>?δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=var>?δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α'</span><span class=main>)</span> <span class=main>∈</span> <span class=var>?Tr'</span>  
                      <span class=main>∧</span> <span class=var>?α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>   
            <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span>  
            <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>hence</span></span> 
            <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=var>?Tr'</span>  
            <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>}</span></span>
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>unfolding</span></span> FCIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> FCIA <span class=free>ρ</span> <span class=free>Γ</span> <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Strict Removal of Confidential Events (SR) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>SR</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>SR</span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> <span class=main>∀</span><span class=bound>τ</span><span class=main>∈</span><span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=bound>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span>"</span></span>

<span class=keyword1><span class=command>lemma</span></span> <span class=quoted><span class=quoted>"BSP_valid SR"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span><span class=main>::</span><span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> V_rec<span class=main>)</span>"</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>∃</span><span class=bound>τ</span> <span class=main>∈</span> <span class=skolem>Tr</span><span class=main>.</span> <span class=bound>t</span><span class=main>=</span><span class=bound>τ</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>}</span> <span class=main>∪</span> <span class=skolem>Tr</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"SR <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span> <span class=keyword1><span class=command>unfolding</span></span> SR_def 
      <span class=keyword1><span class=command>proof</span></span>
        <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span>
        <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> <span class=var>?Tr'</span>"</span></span>
        <span class=keyword1><span class=command>{</span></span>
          <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ</span> <span class=main>∈</span> <span class=var>?Tr'</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>∃</span><span class=bound>t</span><span class=main>∈</span><span class=skolem>Tr</span><span class=main>.</span> <span class=skolem>τ</span> <span class=main>=</span> <span class=bound>t</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∨</span> <span class=skolem>τ</span> <span class=main>∈</span> <span class=skolem>Tr</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> <span class=var>?Tr'</span>"</span></span> 
            <span class=keyword1><span class=command>proof</span></span> 
              <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>t</span><span class=main>∈</span><span class=skolem>Tr</span><span class=main>.</span> <span class=skolem>τ</span> <span class=main>=</span> <span class=bound>t</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
              <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>t</span><span class=main>∈</span><span class=skolem>Tr</span><span class=main>.</span> <span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>=</span> <span class=bound>t</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
                <span class=keyword1><span class=command>using</span></span> projection_idempotent <span class=keyword1><span class=command>by</span></span> <span class=operator>metis</span>
              <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>next</span></span>
              <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> <span class=skolem>Tr</span>"</span></span> 
              <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>qed</span></span>  
        <span class=keyword1><span class=command>}</span></span>  
        <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=skolem>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> <span class=var>?Tr'</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> SR <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Strict Deletion of Confidential Events (SD) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>SD</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>SD</span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> <span class=main>⟶</span> <span class=bound>β</span> <span class=main>@</span> <span class=bound>α</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span>"</span></span>

<span class=keyword1><span class=command>lemma</span></span> <span class=quoted><span class=quoted>"BSP_valid SD"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span><span class=main>::</span><span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> V_rec<span class=main>)</span>"</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"SD <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span> <span class=keyword1><span class=command>unfolding</span></span> SD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> SD <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>
 
<span class=comment1>(* Strict Insertion of Confidential Events (SI) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>SI</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>SI</span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> <span class=main>⟶</span> <span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span>"</span></span>

<span class=keyword1><span class=command>lemma</span></span> <span class=quoted><span class=quoted>"BSP_valid SI"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span><span class=main>::</span><span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'a</span> V_rec<span class=main>)</span>"</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"SI <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def SI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> SI <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Strict Insertion of Admissible Confidential Events (SIA) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>SIA</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Rho <span class=main>⇒</span> <span class=tfree>'e</span> BSP"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>SIA</span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span><span class=main>∈</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=main>(</span>Adm <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=bound>β</span> <span class=bound>c</span><span class=main>)</span><span class=main>)</span> 
    <span class=main>⟶</span> <span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span>"</span></span> 

<span class=keyword1><span class=command>lemma</span></span> <span class=quoted><span class=quoted>"BSP_valid <span class=main>(</span>SIA <span class=free>ρ</span><span class=main>)</span> "</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>  
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>𝒱</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'a</span> V_rec<span class=main>)</span>"</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>Tr</span> <span class=skolem>E</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>"</span></span>     
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?Tr'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>t</span><span class=main>)</span> <span class=main>⊆</span> <span class=skolem>E</span><span class=main>}</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?Tr'</span><span class=main>⊇</span> <span class=skolem>Tr</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>meson</span> Ball_Collect <span class=quoted><span class=quoted>‹areTracesOver <span class=skolem>Tr</span> <span class=skolem>E</span>›</span></span> areTracesOver_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"SIA <span class=free>ρ</span> <span class=skolem>𝒱</span> <span class=var>?Tr'</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=skolem>𝒱</span> <span class=skolem>E</span>›</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def SIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>Tr'</span><span class=main>.</span> <span class=bound>Tr'</span> <span class=main>⊇</span> <span class=skolem>Tr</span>  <span class=main>∧</span> SIA <span class=free>ρ</span> <span class=skolem>𝒱</span> <span class=bound>Tr'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSP_valid_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=InformationFlowProperties>
<div class=head>
<h1>Theory InformationFlowProperties</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> InformationFlowProperties
<span class=keyword2><span class=keyword>imports</span></span> <a href=#BasicSecurityPredicates>BasicSecurityPredicates</a>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* Security Predicates are sets of basic security predicates *)</span>
<span class=keyword1><span class=command>type_synonym</span></span> <span class=tfree>'e</span> SP <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> BSP<span class=main>)</span> set"</span></span>

<span class=comment1>(* structurally, information flow properties consist of a set of views 
 and a security predicate. *)</span>
<span class=keyword1><span class=command>type_synonym</span></span> <span class=tfree>'e</span> IFP_type <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'e</span> V_rec set<span class=main>)</span> <span class=main>×</span> <span class=tfree>'e</span> SP"</span></span>

<span class=comment1>(* side condition for information flow properties *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>IFP_valid</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> IFP_type <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>IFP_valid</span> <span class=free><span class=bound><span class=entity>E</span></span></span> <span class=free><span class=bound><span class=entity>ifp</span></span></span> <span class=main>≡</span>  
  <span class=main>∀</span><span class=bound>𝒱</span> <span class=main>∈</span> <span class=main>(</span>fst <span class=free><span class=bound><span class=entity>ifp</span></span></span><span class=main>)</span><span class=main>.</span> isViewOn <span class=bound>𝒱</span> <span class=free><span class=bound><span class=entity>E</span></span></span>  
                    <span class=main>∧</span> <span class=main>(</span><span class=main>∀</span><span class=bound>BSP</span> <span class=main>∈</span> <span class=main>(</span>snd <span class=free><span class=bound><span class=entity>ifp</span></span></span><span class=main>)</span><span class=main>.</span> BSP_valid <span class=bound>BSP</span><span class=main>)</span>"</span></span>

<span class=comment1>(* An information flow property is an instance of IFP_type that 
 satisfies IFP_valid. *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>IFPIsSatisfied</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> IFP_type <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set  <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>IFPIsSatisfied</span> <span class=free><span class=bound><span class=entity>ifp</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span> <span class=bound>𝒱</span><span class=main>∈</span><span class=main>(</span>fst <span class=free><span class=bound><span class=entity>ifp</span></span></span><span class=main>)</span><span class=main>.</span> <span class=main>∀</span> <span class=bound>BSP</span><span class=main>∈</span><span class=main>(</span>snd <span class=free><span class=bound><span class=entity>ifp</span></span></span><span class=main>)</span><span class=main>.</span> <span class=bound>BSP</span> <span class=bound>𝒱</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span>"</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=BSPTaxonomy>
<div class=head>
<h1>Theory BSPTaxonomy</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> BSPTaxonomy
<span class=keyword2><span class=keyword>imports</span></span> <span class=quoted>"<a href=#EventSystems>../../SystemSpecification/EventSystems</a>"</span>
  <span class=quoted>"<a href=#BasicSecurityPredicates>../../SecuritySpecification/BasicSecurityPredicates</a>"</span>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=keyword1><span class=command>locale</span></span> BSPTaxonomyDifferentCorrections <span class=main>=</span>
<span class=keyword2><span class=keyword>fixes</span></span> <span class=free>ES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec"</span></span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>𝒱</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec"</span></span>

<span class=keyword2><span class=keyword>assumes</span></span> validES<span class=main>:</span> <span class=quoted><span class=quoted>"ES_valid <span class=free>ES</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> VIsViewOnE<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=free>𝒱</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1><span class=command>locale</span></span> BSPTaxonomyDifferentViews <span class=main>=</span>
<span class=keyword2><span class=keyword>fixes</span></span> <span class=free>ES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec"</span></span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec"</span></span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec"</span></span>

<span class=keyword2><span class=keyword>assumes</span></span> validES<span class=main>:</span> <span class=quoted><span class=quoted>"ES_valid <span class=free>ES</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> 𝒱<span class=hidden>⇩</span><sub>1</sub>IsViewOnE<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword2><span class=keyword>and</span></span> 𝒱<span class=hidden>⇩</span><sub>2</sub>IsViewOnE<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1><span class=command>locale</span></span> BSPTaxonomyDifferentViewsFirstDim<span class=main>=</span> BSPTaxonomyDifferentViews <span class=main>+</span>
<span class=keyword2><span class=keyword>assumes</span></span> V2_subset_V1<span class=main>:</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>  
<span class=keyword2><span class=keyword>and</span></span>     N2_supset_N1<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊇</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span>     C2_subset_C1<span class=main>:</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1><span class=command>sublocale</span></span>  BSPTaxonomyDifferentViewsFirstDim <span class=main>⊆</span> BSPTaxonomyDifferentViews
<span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold_locales</span><span class=main>)</span>

<span class=keyword1><span class=command>locale</span></span> BSPTaxonomyDifferentViewsSecondDim<span class=main>=</span> BSPTaxonomyDifferentViews <span class=main>+</span>
<span class=keyword2><span class=keyword>assumes</span></span> V2_subset_V1<span class=main>:</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>  
<span class=keyword2><span class=keyword>and</span></span>     N2_supset_N1<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊇</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span>     C2_equals_C1<span class=main>:</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword1><span class=command>sublocale</span></span>  BSPTaxonomyDifferentViewsSecondDim <span class=main>⊆</span> BSPTaxonomyDifferentViews
<span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold_locales</span><span class=main>)</span>

<span class=comment1>(* body of BSPTaxonomy *)</span>
<span class=keyword1><span class=command>context</span></span> BSPTaxonomyDifferentCorrections
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(*lemma taken from lemma 3.5.1 from Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-SR_implies_R><span class=command>lemma</span></span> SR_implies_R<span class=main>:</span> 
<span class=quoted><span class=quoted>"SR <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> R <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> SR<span class=main>:</span> <span class=quoted><span class=quoted>"SR <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> SR  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> SR_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>τ'</span><span class=main>.</span> <span class=bound>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword3><span class=command>assume</span></span> tau_V_N_is_trace<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>τ'</span><span class=main>.</span> <span class=bound>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span>
        <span class=keyword1><span class=command>let</span></span>  <span class=var><span class=quoted><span class=var>?τ'</span></span></span><span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_subset_elim<span class=main>)</span> 
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span>  VIsViewOnE <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"VC_disjoint <span class=free>𝒱</span> <span class=main>∧</span> NC_disjoint <span class=free>𝒱</span>"</span></span> 
          <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>then</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> NC_disjoint_def VC_disjoint_def inf_sup_distrib2<span class=main>)</span> 
        <span class=keyword1><span class=command>then</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> disjoint_projection<span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span>
        <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=var>?τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span>  tau_V_N_is_trace  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
      <span class=keyword1><span class=command>qed</span></span>  
    <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> SR_def R_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.1 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-SD_implies_BSD><span class=command>lemma</span></span> SD_implies_BSD <span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>(</span>SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> "</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> SD<span class=main>:</span>  <span class=quoted><span class=quoted>"SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> 
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>c</span> <span class=main>#</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span>  alpha_C_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
    <span class=keyword1><span class=command>with</span></span> SD <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> SD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> alpha_C_empty  
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
   <span class=keyword1><span class=command>}</span></span>
   <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
     <span class=keyword1><span class=command>unfolding</span></span> SD_def BSD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.1 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-BSD_implies_D><span class=command>lemma</span></span> BSD_implies_D<span class=main>:</span> 
<span class=quoted><span class=quoted>"BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> D <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
  <span class=keyword3><span class=command>assume</span></span> BSD<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> BSD <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V <span class=free>𝒱</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> BSD_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>∃</span><span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span>
      <span class=main>(</span><span class=bound>β'</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> <span class=main>∧</span>
      <span class=bound>β'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSD_def D_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.1 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-SD_implies_SR><span class=command>lemma</span></span> SD_implies_SR<span class=main>:</span> 
<span class=quoted><span class=quoted>"SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> SR <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>unfolding</span></span> SR_def
<span class=keyword1><span class=command>proof</span></span>
  <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span> 

  <span class=keyword3><span class=command>assume</span></span> SD<span class=main>:</span> <span class=quoted><span class=quoted>"SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> τ_trace<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span>  <span class=skolem>n</span> 

      <span class=comment1>(* show via induction over length (τ ↿ C<span class=hidden>⇘</span><sub>𝒱</sub><span class=hidden>⇙</span>) that SR holds *)</span>
    <span class=keyword1><span class=command>have</span></span> SR_via_length<span class=main>:</span> <span class=quoted><span class=quoted>" <span class=main>⟦</span> <span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟧</span> 
      <span class=main>⟹</span> <span class=main>∃</span><span class=bound>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=bound>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>n</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>τ</span></span><span class=main>)</span>
      <span class=keyword3><span class=command>case</span></span> 0 
      <span class=keyword1><span class=command>note</span></span> τ_in_Tr <span class=main>=</span> <span class=quoted><span class=quoted>‹<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>‹<span class=main>0</span> <span class=main>=</span> length <span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span>
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>with</span></span> τ_in_Tr <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>
      <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β</span></span> <span class=skolem><span class=skolem>c</span></span> <span class=skolem><span class=skolem>α</span></span>
        <span class=keyword2><span class=keyword>where</span></span> c_in_C<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> τ_is_βcα<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> βα_contains_n_cs<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>with</span></span> Suc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> βcα_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      
      <span class=keyword1><span class=command>with</span></span> SD c_in_C βcα_in_Tr α_no_c <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β'</span></span> <span class=skolem><span class=skolem>α'</span></span> 
        <span class=keyword2><span class=keyword>where</span></span> β'α'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span> α'_V_is_α_V<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α'_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span> β'_VC_is_β_VC<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> SD_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
       
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
        <span class=keyword1><span class=command>from</span></span> β'_VC_is_β_VC <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_subset_eq_from_superset_eq<span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> α'_V_is_α_V <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command><span class=improper>with</span></span></span>  VIsViewOnE c_in_C <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> τ_is_βcα
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span> 
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>with</span></span> β'_VC_is_β_VC <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_subset_eq_from_superset_eq<span class=main>)</span>
        <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>with</span></span> α'_no_c α_no_c <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> βα_contains_n_cs <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>with</span></span> Suc.hyps β'α'_in_Tr <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>τ'</span></span> 
        <span class=keyword2><span class=keyword>where</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span> 
  <span class=keyword1><span class=command>}</span></span>
  
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> <span class=main>∃</span><span class=bound>τ'</span><span class=main>.</span> <span class=bound>τ'</span><span class=main>∈</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

  <span class=keyword1><span class=command>from</span></span> this τ_trace <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>τ'</span></span> <span class=keyword2><span class=keyword>where</span></span>
        τ'_trace <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span><span class=main>∈</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> τ'_no_C  <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> τ'_τ_rel <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

  <span class=keyword1><span class=command>from</span></span> τ'_no_C <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_on_union<span class=main>)</span>

  <span class=keyword1><span class=command>with</span></span>  VIsViewOnE <span class=keyword1><span class=command>have</span></span> τ'_E_eq_VN<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def<span class=main>)</span>

  <span class=keyword1><span class=command>from</span></span> validES τ'_trace <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>τ'</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main>)</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ'</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> τ'_E_eq_VN <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>with</span></span> τ'_τ_rel <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>with</span></span> τ'_trace <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.1 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-D_implies_R><span class=command>lemma</span></span> D_implies_R<span class=main>:</span> 
<span class=quoted><span class=quoted>"D <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> R <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> D<span class=main>:</span> <span class=quoted><span class=quoted>"D <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>  
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span> <span class=skolem>n</span> 

      <span class=comment1>(* show via induction over length (τ ↿ C<span class=hidden>⇘</span><sub>𝒱</sub><span class=hidden>⇙</span>) that R holds *)</span>
    <span class=keyword1><span class=command>have</span></span> R_via_length<span class=main>:</span> <span class=quoted><span class=quoted>" <span class=main>⟦</span> <span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟧</span>
                          <span class=main>⟹</span> <span class=main>∃</span><span class=bound>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=bound>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>n</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>τ</span></span><span class=main>)</span>
      <span class=keyword3><span class=command>case</span></span> 0 
      <span class=keyword1><span class=command>note</span></span> τ_in_Tr <span class=main>=</span> <span class=quoted><span class=quoted>‹<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>‹<span class=main>0</span> <span class=main>=</span> length <span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span>
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>with</span></span> τ_in_Tr <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>
      <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β</span></span> <span class=skolem><span class=skolem>c</span></span> <span class=skolem><span class=skolem>α</span></span>
        <span class=keyword2><span class=keyword>where</span></span> c_in_C<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> τ_is_βcα<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> βα_contains_n_cs<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>with</span></span> Suc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> βcα_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      
      <span class=keyword1><span class=command>with</span></span> D c_in_C βcα_in_Tr α_no_c <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β'</span></span> <span class=skolem><span class=skolem>α'</span></span> 
        <span class=keyword2><span class=keyword>where</span></span> β'α'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span> α'_V_is_α_V<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α'_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span> β'_VC_is_β_VC<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> D_def 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
        <span class=keyword1><span class=command>from</span></span> β'_VC_is_β_VC <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_subset_eq_from_superset_eq<span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> α'_V_is_α_V <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command><span class=improper>with</span></span></span>  VIsViewOnE c_in_C <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> τ_is_βcα
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span> 
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>with</span></span> β'_VC_is_β_VC <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_subset_eq_from_superset_eq<span class=main>)</span>
        <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>with</span></span> α'_no_c α_no_c <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> βα_contains_n_cs <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>with</span></span> Suc.hyps β'α'_in_Tr <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>τ'</span></span> 
        <span class=keyword2><span class=keyword>where</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span> 
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> R_def<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Theorem 3.5.6.1 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-SR_implies_R_for_modified_view><span class=command>lemma</span></span> SR_implies_R_for_modified_view <span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span>SR <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span><span class=main>⟧</span> <span class=main>⟹</span> R <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"SR <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span>
   <span class=keyword1><span class=command>{</span></span>
     <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> VIsViewOnE 
     <span class=keyword1><span class=command>have</span></span> V'IsViewOnE<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=free>𝒱'</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> "</span></span> 
       <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def VC_disjoint_def NC_disjoint_def VN_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹SR <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> SR_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?τ'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>moreover</span></span>   
    <span class=keyword1><span class=command>from</span></span> V'IsViewOnE <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?τ'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> disjoint_projection  
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>  
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?τ'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_subset_elim<span class=main>)</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>τ'</span><span class=main>∈</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=bound>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
   <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹SR <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> R_def <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
<span class=keyword1><span class=command>qed</span></span>   

<span class=keyword1 id=BSPTaxonomy-R_implies_SR_for_modified_view><span class=command>lemma</span></span> R_implies_SR_for_modified_view <span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>R <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span><span class=main>⟧</span> <span class=main>⟹</span> SR <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"R <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹R <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>τ'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
                                        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
                                        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>"</span></span>
                                        <span class=keyword1><span class=command>unfolding</span></span> R_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> VIsViewOnE <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"isViewOn  <span class=free>𝒱'</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def VC_disjoint_def NC_disjoint_def                                   
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>=</span><span class=skolem>τ'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> validES <span class=quoted><span class=quoted>‹<span class=skolem>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹isViewOn <span class=free>𝒱'</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> projection_def ES_valid_def isViewOn_def traces_contain_events_def
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> UnE filter_True filter_empty_conv<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>=</span><span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>                 
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span> 
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> SR_def <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Theorem 3.5.6.2 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-SD_implies_BSD_for_modified_view><span class=command>lemma</span></span> SD_implies_BSD_for_modified_view <span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span>SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span><span class=main>⟧</span> <span class=main>⟹</span> BSD <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span>
   <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>     
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> SD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span>  <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>  <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> "</span></span> 
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
   <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSD_def <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
<span class=keyword1><span class=command>qed</span></span>   

<span class=keyword1 id=BSPTaxonomy-BSD_implies_SD_for_modified_view><span class=command>lemma</span></span> BSD_implies_SD_for_modified_view <span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>BSD <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span><span class=main>⟧</span> <span class=main>⟹</span> SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> SD_def
  <span class=keyword1><span class=command>proof</span></span><span class=main>(</span><span class=operator>clarsimp</span><span class=main>)</span>
  <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
  <span class=keyword3><span class=command>assume</span></span> BSD_view' <span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>⦈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> alpha_no_C_view <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> c_C_view <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> beta_c_alpha_is_trace <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>c</span> <span class=main>#</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  
  <span class=keyword1><span class=command>from</span></span> BSD_view' alpha_no_C_view c_C_view beta_c_alpha_is_trace 
  <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
    <span class=keyword2><span class=keyword>where</span></span> beta_alpha'_is_trace<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>∈</span><span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> alpha_alpha'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> alpha'_no_C_view <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> BSD_def<span class=main>)</span>

  <span class=keyword1><span class=command>from</span></span> beta_c_alpha_is_trace validES
  <span class=keyword1><span class=command>have</span></span> alpha_consists_of_events<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main>)</span>

  <span class=keyword1><span class=command>from</span></span> alpha_no_C_view <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_on_union<span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> VIsViewOnE  <span class=keyword1><span class=command>have</span></span> alpha_on_ES <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>

  <span class=keyword1><span class=command>from</span></span> alpha_consists_of_events VIsViewOnE <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
  
  <span class=keyword1><span class=command>with</span></span> alpha_on_ES <span class=keyword1><span class=command>have</span></span> α_eq<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

  <span class=keyword1><span class=command>from</span></span> beta_alpha'_is_trace validES
  <span class=keyword1><span class=command>have</span></span> alpha'_consists_of_events<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main>)</span>

  <span class=keyword1><span class=command>from</span></span> alpha'_no_C_view <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_on_union<span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> VIsViewOnE <span class=keyword1><span class=command>have</span></span> alpha'_on_ES <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span><span class=main>)</span>

  <span class=keyword1><span class=command>from</span></span> alpha'_consists_of_events VIsViewOnE <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α'</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
  
  <span class=keyword1><span class=command>with</span></span> alpha'_on_ES <span class=keyword1><span class=command>have</span></span> α'_eq<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α'</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>


  <span class=keyword1><span class=command>from</span></span> alpha_alpha' α_eq α'_eq <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>α'</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
  <span class=keyword1><span class=command>with</span></span> beta_alpha'_is_trace <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(* lemma taken from lemma 3.5.4 from Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-SD_implies_FCD><span class=command>lemma</span></span> SD_implies_FCD<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>(</span>SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> FCD <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>    
   <span class=keyword3><span class=command>assume</span></span> SD<span class=main>:</span> <span class=quoted><span class=quoted>"SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>  <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>  <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> alpha_C_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span> <span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command><span class=improper>with</span></span></span> VIsViewOnE  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>v</span> <span class=main>#</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def VC_disjoint_def projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>v</span> <span class=main>#</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> SD <span class=keyword1><span class=command>unfolding</span></span> SD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> alpha_C_empty  
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span>  Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>  
            <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append.simps<span class=main><span class=main>(</span></span>1<span class=main><span class=main>)</span></span> append.simps<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> bot_least list.set<span class=main><span class=main>(</span></span>1<span class=main><span class=main>)</span></span><span class=main>)</span>
  <span class=keyword1><span class=command>}</span></span>    
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> SD_def FCD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>



<span class=comment1>(* lemma taken from lemma 3.5.9 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-SI_implies_BSI><span class=command>lemma</span></span> SI_implies_BSI <span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>(</span>SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> "</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> SI<span class=main>:</span> <span class=quoted><span class=quoted>"SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> 
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span>  <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> alpha_C_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
    <span class=keyword1><span class=command>with</span></span> SI <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>c</span> <span class=main>#</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> SI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=skolem>c</span> <span class=main>#</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> alpha_C_empty  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> SI_def BSI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.9 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-BSI_implies_I><span class=command>lemma</span></span> BSI_implies_I<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>(</span>BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> <span class=main>(</span>I <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> BSI<span class=main>:</span> <span class=quoted><span class=quoted>"BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> BSI <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> BSI_def
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>hence</span></span> 
      <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>∃</span><span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> <span class=main>(</span><span class=bound>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> <span class=main>∧</span>
                  <span class=bound>β'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> BSI_def I_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.9 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-SIA_implies_BSIA><span class=command>lemma</span></span> SIA_implies_BSIA<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>(</span>SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> <span class=main>(</span>BSIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> SIA<span class=main>:</span> <span class=quoted><span class=quoted>"SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> alpha_C_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> SIA <span class=keyword3><span class=command>obtain</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>c</span> <span class=main>#</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> SIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=skolem>c</span> <span class=main>#</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>  
      <span class=keyword1><span class=command>using</span></span>  alpha_C_empty  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> SIA_def BSIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.9 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-BSIA_implies_IA><span class=command>lemma</span></span> BSIA_implies_IA<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>(</span>BSIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> <span class=main>(</span>IA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> BSIA<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> BSIA <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>∃</span><span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span>
      <span class=main>(</span><span class=bound>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> <span class=main>∧</span>
      <span class=bound>β'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def IA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.9 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-SI_implies_SIA><span class=command>lemma</span></span> SI_implies_SIA<span class=main>:</span> 
<span class=quoted><span class=quoted>"SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> SI<span class=main>:</span> <span class=quoted><span class=quoted>"SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> SI <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> SI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> SI_def SIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.9 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-BSI_implies_BSIA><span class=command>lemma</span></span> BSI_implies_BSIA<span class=main>:</span> 
<span class=quoted><span class=quoted>"BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> BSIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> BSI<span class=main>:</span> <span class=quoted><span class=quoted>"BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> BSI <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>  <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> BSI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSI_def BSIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.9 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-I_implies_IA><span class=command>lemma</span></span> I_implies_IA<span class=main>:</span> 
<span class=quoted><span class=quoted>"I <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> IA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> I<span class=main>:</span> <span class=quoted><span class=quoted>"I <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> I <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> <span class=bound>β'</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>  
                            <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>  <span class=main>∧</span> <span class=bound>β'</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> "</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> I_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> I_def IA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Theorem 3.5.15.1 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-SI_implies_BSI_for_modified_view><span class=command>lemma</span></span> SI_implies_BSI_for_modified_view <span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span>SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span><span class=main>⟧</span> <span class=main>⟹</span> BSI <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span>
   <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span>  <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>     
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span>  <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span>  <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>unfolding</span></span> SI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span>  <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span>  <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>  <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> "</span></span> 
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
   <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSI_def <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
<span class=keyword1><span class=command>qed</span></span> 

<span class=keyword1 id=BSPTaxonomy-BSI_implies_SI_for_modified_view><span class=command>lemma</span></span> BSI_implies_SI_for_modified_view <span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>BSI <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span><span class=main>⟧</span> <span class=main>⟹</span> SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> SI_def
  <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>clarsimp</span><span class=main>)</span>
  <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
  <span class=keyword3><span class=command>assume</span></span> BSI_view' <span class=main>:</span> <span class=quoted><span class=quoted>"BSI <span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>⦈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> alpha_no_C_view <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> c_C_view <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> beta_alpha_is_trace <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>

  <span class=keyword1><span class=command>from</span></span> BSI_view' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>c</span><span class=main>∈</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> 
    <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> BSI_def<span class=main>)</span>

  <span class=keyword1><span class=command>with</span></span> beta_alpha_is_trace alpha_no_C_view <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>c</span><span class=main>∈</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>.</span>
        <span class=main>(</span><span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

  <span class=keyword1><span class=command>with</span></span> this BSI_view' c_C_view <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span>
    <span class=keyword2><span class=keyword>where</span></span> beta_c_alpha'_is_trace<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> alpha_alpha'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> alpha'_no_C_view <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

  <span class=keyword1><span class=command>from</span></span> beta_alpha_is_trace validES
  <span class=keyword1><span class=command>have</span></span> alpha_consists_of_events<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main>)</span>

  <span class=keyword1><span class=command>from</span></span> alpha_no_C_view <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_on_union<span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> VIsViewOnE <span class=keyword1><span class=command>have</span></span> alpha_on_ES <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span><span class=main>)</span>

  <span class=keyword1><span class=command>from</span></span> alpha_consists_of_events VIsViewOnE <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
  
  <span class=keyword1><span class=command>with</span></span> alpha_on_ES <span class=keyword1><span class=command>have</span></span> α_eq<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  
  <span class=keyword1><span class=command>from</span></span> beta_c_alpha'_is_trace validES 
  <span class=keyword1><span class=command>have</span></span> alpha'_consists_of_events<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main>)</span>

  <span class=keyword1><span class=command>from</span></span> alpha'_no_C_view <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_on_union<span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> VIsViewOnE <span class=keyword1><span class=command>have</span></span> alpha'_on_ES <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span><span class=main>)</span>

  <span class=keyword1><span class=command>from</span></span> alpha'_consists_of_events VIsViewOnE <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α'</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
  
  <span class=keyword1><span class=command>with</span></span> alpha'_on_ES <span class=keyword1><span class=command>have</span></span> α'_eq<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α'</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

  <span class=keyword1><span class=command>from</span></span> alpha_alpha' α_eq α'_eq <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>α'</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
  <span class=keyword1><span class=command>with</span></span> beta_c_alpha'_is_trace <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>c</span> <span class=main>#</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(* lemma taken from Theorem 3.5.15.2 from Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-SIA_implies_BSIA_for_modified_view><span class=command>lemma</span></span> SIA_implies_BSIA_for_modified_view <span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span>SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span> <span class=main>;</span> <span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>=</span> <span class=free>ρ'</span> <span class=free>𝒱'</span><span class=main>⟧</span> <span class=main>⟹</span> BSIA <span class=free>ρ'</span> <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>=</span> <span class=free>ρ'</span> <span class=free>𝒱'</span>"</span></span>
   <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span>  <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱'</span> <span class=free>ρ'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>     
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span>  <span class=quoted><span class=quoted>‹Adm <span class=free>𝒱'</span> <span class=free>ρ'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>=</span> <span class=free>ρ'</span> <span class=free>𝒱'</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def<span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span>  <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span>  <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>unfolding</span></span> SIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span>  <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span>  <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span>  <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>  <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> "</span></span> 
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
   <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
<span class=keyword1><span class=command>qed</span></span> 

<span class=keyword1 id=BSPTaxonomy-BSIA_implies_SIA_for_modified_view><span class=command>lemma</span></span> BSIA_implies_SIA_for_modified_view <span class=main>:</span> 
  <span class=quoted><span class=quoted>"<span class=main>⟦</span>BSIA <span class=free>ρ'</span> <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span><span class=main>;</span> <span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>=</span> <span class=free>ρ'</span> <span class=free>𝒱'</span><span class=main>⟧</span> <span class=main>⟹</span> SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ'</span> <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span> 
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>=</span> <span class=free>ρ'</span> <span class=free>𝒱'</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span>  <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>     
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span>  <span class=quoted><span class=quoted>‹Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>=</span> <span class=free>ρ'</span> <span class=free>𝒱'</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱'</span> <span class=free>ρ'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def<span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span>  <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹Adm <span class=free>𝒱'</span> <span class=free>ρ'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>›</span></span>
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>" <span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>" <span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹BSIA <span class=free>ρ'</span> <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>unfolding</span></span> BSIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

    <span class=comment1>(*Show that α'=α*)</span>    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span>  <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> validES
    <span class=keyword1><span class=command>have</span></span> alpha_consists_of_events<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> validES
    <span class=keyword1><span class=command>have</span></span> alpha'_consists_of_events<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main>)</span>  

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>=</span><span class=skolem>α</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>=</span><span class=skolem>α</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_on_union<span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> VIsViewOnE alpha_consists_of_events alpha'_consists_of_events
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>=</span><span class=skolem>α</span>"</span></span> <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>

    <span class=keyword1><span class=command>hence</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> "</span></span>
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
   <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹BSIA <span class=free>ρ'</span> <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> SIA_def <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>,</span> N <span class=main>=</span><span class=main>{}</span> <span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>   
<span class=keyword1><span class=command>qed</span></span>    
<span class=keyword2><span class=keyword>end</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.11 in Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-Adm_implies_Adm_for_modified_rho><span class=command>lemma</span></span> Adm_implies_Adm_for_modified_rho<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span> Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>Tr</span> <span class=free>α</span> <span class=free>e</span><span class=main>;</span><span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>⊇</span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span><span class=main>⟧</span> <span class=main>⟹</span> Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>Tr</span> <span class=free>α</span> <span class=free>e</span> "</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>Tr</span> <span class=free>α</span> <span class=free>e</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>⊇</span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span>
    <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span> <span class=main>∈</span> <span class=free>Tr</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>=</span> <span class=free>α</span> <span class=main>↿</span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span>"</span></span>
    <span class=keyword1><span class=command>unfolding</span></span> Adm_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>Tr</span> <span class=free>α</span> <span class=free>e</span>"</span></span>
    <span class=keyword1><span class=command>unfolding</span></span> Adm_def 
    <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>⊆</span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span>›</span></span> non_empty_projection_on_subset 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>context</span></span> BSPTaxonomyDifferentCorrections
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.13 from Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-SI_implies_FCI><span class=command>lemma</span></span> SI_implies_FCI<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>(</span>SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> FCI <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>    
   <span class=keyword3><span class=command>assume</span></span> SI<span class=main>:</span> <span class=quoted><span class=quoted>"SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>  <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>  <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> alpha_C_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command><span class=improper>with</span></span></span> VIsViewOnE  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>v</span> <span class=main>#</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def VC_disjoint_def projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span> <span class=main>,</span> <span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span> SI <span class=keyword1><span class=command>unfolding</span></span> SI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> alpha_C_empty  
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ'</span><span class=main>.</span> 
              <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span>  Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append.simps<span class=main><span class=main>(</span></span>1<span class=main><span class=main>)</span></span> append.simps<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> bot_least list.set<span class=main><span class=main>(</span></span>1<span class=main><span class=main>)</span></span><span class=main>)</span>
  <span class=keyword1><span class=command>}</span></span>    
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> SI_def FCI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.13 from Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-SIA_implies_FCIA><span class=command>lemma</span></span> SIA_implies_FCIA<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>(</span>SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> FCIA <span class=free>ρ</span> <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>    
   <span class=keyword3><span class=command>assume</span></span> SIA<span class=main>:</span> <span class=quoted><span class=quoted>"SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>  <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>  <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> alpha_C_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command><span class=improper>with</span></span></span> VIsViewOnE  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>v</span> <span class=main>#</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def VC_disjoint_def projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span> <span class=main>,</span> <span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span> SIA <span class=keyword1><span class=command>unfolding</span></span> SIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> alpha_C_empty  
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ'</span><span class=main>.</span> 
              <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span>  Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>  
                <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append.simps<span class=main><span class=main>(</span></span>1<span class=main><span class=main>)</span></span> append.simps<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> bot_least list.set<span class=main><span class=main>(</span></span>1<span class=main><span class=main>)</span></span><span class=main>)</span>
  <span class=keyword1><span class=command>}</span></span>    
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> SIA_def FCIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.13 from Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-FCI_implies_FCIA><span class=command>lemma</span></span> FCI_implies_FCIA<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>(</span>FCI <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> FCIA <span class=free>ρ</span> <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span><span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> FCI<span class=main>:</span> <span class=quoted><span class=quoted>"FCI <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>  <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>  <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> FCI <span class=keyword1><span class=command>have</span></span>   <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span> <span class=bound>δ'</span><span class=main>.</span> set <span class=bound>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∧</span>
                         <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
                            <span class=keyword1><span class=command>unfolding</span></span> FCI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>   
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> FCI_def FCIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(* Mantel's PhD thesis, Theorem 3.5.7 Trivially fulfilled BSPs*)</span>
<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_SR_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_SR_C_empty<span class=main>:</span>  
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> SR <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span> 
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span><span class=main>=</span><span class=skolem>τ</span><span class=main>↿</span>E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span>  validES 
      <span class=keyword1><span class=command>unfolding</span></span>  ES_valid_def traces_contain_events_def projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span><span class=main>=</span><span class=skolem>τ</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>∪</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> VIsViewOnE <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>    
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>∪</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> SR_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_R_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_R_C_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> R <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span> 
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span><span class=main>=</span><span class=skolem>τ</span><span class=main>↿</span>E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span>  validES 
      <span class=keyword1><span class=command>unfolding</span></span>  ES_valid_def traces_contain_events_def projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span><span class=main>=</span><span class=skolem>τ</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>∪</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> VIsViewOnE <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>    
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=skolem>τ</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=skolem>τ</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> R_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_SD_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_SD_C_empty<span class=main>:</span>  
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> SD_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_BSD_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_BSD_C_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> BSD_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_D_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_D_C_empty<span class=main>:</span>  
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> D <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> D_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCD_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_FCD_C_empty<span class=main>:</span>  
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> FCD <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCD_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fullfilled_R_V_empty><span class=command>lemma</span></span> Trivially_fullfilled_R_V_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span> <span class=main>⟹</span> R <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?τ'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span><span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> validES 
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_prefixclosed_def prefixclosed_def prefix_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=bound>τ'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span> <span class=main>∧</span> <span class=bound>τ'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=skolem>τ</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>  
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_on_empty_trace projection_to_emptyset_is_empty_trace<span class=main>)</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> R_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_BSD_V_empty><span class=command>lemma</span></span> Trivially_fulfilled_BSD_V_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span> <span class=main>[]</span>"</span></span>  

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> validES 
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_prefixclosed_def prefixclosed_def prefix_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
 
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?α'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span><span class=main>@</span> <span class=var>?α'</span><span class=main>∈</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_on_empty_trace projection_to_emptyset_is_empty_trace<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span>
    <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> 
      <span class=skolem>β</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>∈</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_D_V_empty><span class=command>lemma</span></span> Trivially_fulfilled_D_V_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> D <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span> <span class=main>[]</span>"</span></span>  
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> validES 
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_prefixclosed_def prefixclosed_def prefix_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?β'</span></span></span><span class=main>=</span><span class=quoted><span class=skolem>β</span></span> <span class=keyword2><span class=keyword>and</span></span>  <span class=var><span class=quoted><span class=var>?α'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?β'</span><span class=main>@</span> <span class=var>?α'</span><span class=main>∈</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=var>?β'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_on_empty_trace projection_to_emptyset_is_empty_trace<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span>
    <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> 
      <span class=bound>β'</span><span class=main>@</span> <span class=bound>α'</span><span class=main>∈</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>β'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> D_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCD_V_empty><span class=command>lemma</span></span> Trivially_fulfilled_FCD_V_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> FCD <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCD_def<span class=main>)</span>

<span class=comment1>(* Mantel's PhD thesis, Theorem 3.5.8 Trivially fulfilled BSPs*)</span>
<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCD_Nabla_Υ_empty><span class=command>lemma</span></span> Trivially_fulfilled_FCD_Nabla_Υ_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span> <span class=main>∨</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span><span class=main>⟧</span><span class=main>⟹</span> FCD <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span> <span class=main>∨</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
  <span class=keyword1><span class=command>proof</span></span><span class=main>(</span><span class=operator>rule</span> disjE<span class=main>)</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCD_def<span class=main>)</span>
  <span class=keyword1><span class=command>next</span></span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>" Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCD_def<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCD_N_subseteq_Δ_and_BSD><span class=command>lemma</span></span> Trivially_fulfilled_FCD_N_subseteq_Δ_and_BSD<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>⟧</span> <span class=main>⟹</span> FCD <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?α</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> VIsViewOnE 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def VC_disjoint_def projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> 
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=var>?α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> BSD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 

    <span class=keyword1><span class=command>from</span></span><span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=skolem><span class=skolem>α''</span></span>
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α''</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>using</span></span> projection_split_first_with_suffix <span class=keyword1><span class=command>by</span></span> <span class=operator>fastforce</span> 

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_is_Nil_conv projection_concatenation_commute<span class=main>)</span> 
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α''</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_is_Nil_conv projection_concatenation_commute<span class=main>)</span> 
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span> validES 
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_contain_events_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>δ</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>δ</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>δ</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> VIsViewOnE projection_empty_implies_absence_of_events  
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?β</span></span></span><span class=main>=</span><span class=quoted><span class=skolem>β</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=var><span class=quoted><span class=var>?δ'</span></span></span><span class=main>=</span><span class=quoted><span class=skolem>δ</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=var><span class=quoted><span class=var>?α'</span></span></span><span class=main>=</span><span class=quoted><span class=skolem>α''</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span>set <span class=skolem>δ</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> 
            <span class=quoted><span class=quoted>‹<span class=skolem>α''</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α''</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=var>?δ'</span><span class=main>)</span><span class=main>⊆</span><span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=var>?β</span> <span class=main>@</span> <span class=var>?δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'''</span> <span class=bound>δ''</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ''</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=bound>δ''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'''</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> 
              <span class=main>∧</span> <span class=bound>α'''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> FCD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Mantel's PhD thesis, Theorem 3.5.16 Trivially fulfilled BSPs*)</span>
<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_SI_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_SI_C_empty<span class=main>:</span>  
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> SI_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_BSI_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_BSI_C_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> BSI_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_I_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_I_C_empty<span class=main>:</span>  
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> I <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> I_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCI_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_FCI_C_empty<span class=main>:</span>  
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> FCI <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCI_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_SIA_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_SIA_C_empty<span class=main>:</span>  
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> SIA_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_BSIA_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_BSIA_C_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> BSIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> BSIA_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_IA_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_IA_C_empty<span class=main>:</span>  
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> IA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> IA_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCIA_C_empty><span class=command>lemma</span></span> Trivially_fulfilled_FCIA_C_empty<span class=main>:</span>  
<span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> FCIA <span class=free>Γ</span> <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCIA_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCI_V_empty><span class=command>lemma</span></span> Trivially_fulfilled_FCI_V_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> FCI <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCI_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCIA_V_empty><span class=command>lemma</span></span> Trivially_fulfilled_FCIA_V_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> FCIA <span class=free>ρ</span> <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCIA_def<span class=main>)</span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_BSIA_V_empty_rho_subseteq_C_N><span class=command>lemma</span></span> Trivially_fulfilled_BSIA_V_empty_rho_subseteq_C_N<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span><span class=main>;</span> <span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>⊇</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟧</span> <span class=main>⟹</span> BSIA <span class=free>ρ</span>  <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>⊇</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> 
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>›</span></span> 
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span><span class=main>↿</span><span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span><span class=main>↿</span><span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> Adm_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> this<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> validES 
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_prefixclosed_def prefixclosed_def prefix_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> validES
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_prefixclosed_def prefixclosed_def prefix_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span><span class=main>↿</span>E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=skolem>γ</span><span class=main>↿</span>E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> validES VIsViewOnE <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ</span><span class=main>↿</span><span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span><span class=main>↿</span><span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>⊇</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> 
        non_empty_projection_on_subset
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def isViewOn_def traces_contain_events_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  empty_subsetI sup_absorb2 sup_commute<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span> validES <span class=quoted><span class=quoted>‹<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_contain_events_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  list_subset_iff_projection_neutral subsetI<span class=main>)</span>
    
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?α'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α'</span> <span class=main>∈</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_on_empty_trace projection_to_emptyset_is_empty_trace<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_IA_V_empty_rho_subseteq_C_N><span class=command>lemma</span></span> Trivially_fulfilled_IA_V_empty_rho_subseteq_C_N<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span><span class=main>;</span> <span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>⊇</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟧</span> <span class=main>⟹</span> IA <span class=free>ρ</span>  <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>⊇</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> 
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>›</span></span>
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span><span class=main>↿</span><span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span><span class=main>↿</span><span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> Adm_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> this<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> validES 
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_prefixclosed_def prefixclosed_def prefix_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span> validES
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_prefixclosed_def prefixclosed_def prefix_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span><span class=main>↿</span>E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=skolem>γ</span><span class=main>↿</span>E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> validES VIsViewOnE <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ</span><span class=main>↿</span><span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span><span class=main>↿</span><span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>⊇</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> 
        non_empty_projection_on_subset
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def isViewOn_def traces_contain_events_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  empty_subsetI sup_absorb2 sup_commute<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span> validES <span class=quoted><span class=quoted>‹<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_contain_events_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  list_subset_iff_projection_neutral subsetI<span class=main>)</span>
    
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?β'</span></span></span><span class=main>=</span><span class=quoted><span class=skolem>β</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=var><span class=quoted><span class=var>?α'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α'</span> <span class=main>∈</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> 
              <span class=main>∧</span> <span class=var>?β'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_on_empty_trace projection_to_emptyset_is_empty_trace<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> 
              <span class=bound>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span>Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> 
                <span class=main>∧</span> <span class=bound>β'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> IA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_BSI_V_empty_total_ES_C><span class=command>lemma</span></span> Trivially_fulfilled_BSI_V_empty_total_ES_C<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span><span class=main>;</span> total <span class=free>ES</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> <span class=main>⟹</span> BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"total <span class=free>ES</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>  
  <span class=keyword1><span class=command>{</span></span>
   <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
   <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
   <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>using</span></span> validES
    <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_prefixclosed_def prefixclosed_def prefix_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
   <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹total <span class=free>ES</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>unfolding</span></span> total_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
   <span class=keyword1><span class=command>moreover</span></span>
   <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
     <span class=keyword1><span class=command>unfolding</span></span> projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
   <span class=keyword1><span class=command>ultimately</span></span> 
   <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span> 
    <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span>  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_Nil2 projection_idempotent<span class=main>)</span>     
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_I_V_empty_total_ES_C><span class=command>lemma</span></span> Trivially_fulfilled_I_V_empty_total_ES_C<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span><span class=main>;</span> total <span class=free>ES</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> <span class=main>⟹</span> I <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"total <span class=free>ES</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>  
  <span class=keyword1><span class=command>{</span></span>
   <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
   <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
   <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
     <span class=keyword1><span class=command>using</span></span> validES
     <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_prefixclosed_def prefixclosed_def prefix_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
   <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹total <span class=free>ES</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>unfolding</span></span> total_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
   <span class=keyword1><span class=command>moreover</span></span>
   <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
     <span class=keyword1><span class=command>unfolding</span></span> projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
   <span class=keyword1><span class=command>ultimately</span></span> 
   <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>β'</span> <span class=bound>α'</span><span class=main>.</span> 
          <span class=bound>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span> <span class=main>∧</span> <span class=bound>β'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_Nil2 projection_idempotent<span class=main>)</span>     
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> I_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Mantel's PhD thesis, Theorem 3.5.17 Trivially fulfilled BSPs*)</span>
<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCI_Nabla_Υ_empty><span class=command>lemma</span></span> Trivially_fulfilled_FCI_Nabla_Υ_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span> <span class=main>∨</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span><span class=main>⟧</span><span class=main>⟹</span> FCI <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span> <span class=main>∨</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
  <span class=keyword1><span class=command>proof</span></span><span class=main>(</span><span class=operator>rule</span> disjE<span class=main>)</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCI_def<span class=main>)</span>
  <span class=keyword1><span class=command>next</span></span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>" Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCI_def<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCIA_Nabla_Υ_empty><span class=command>lemma</span></span> Trivially_fulfilled_FCIA_Nabla_Υ_empty<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span> <span class=main>∨</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span><span class=main>⟧</span><span class=main>⟹</span> FCIA <span class=free>ρ</span> <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span> <span class=main>∨</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
  <span class=keyword1><span class=command>proof</span></span><span class=main>(</span><span class=operator>rule</span> disjE<span class=main>)</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCIA_def<span class=main>)</span>
  <span class=keyword1><span class=command>next</span></span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>" Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCIA_def<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCI_N_subseteq_Δ_and_BSI><span class=command>lemma</span></span> Trivially_fulfilled_FCI_N_subseteq_Δ_and_BSI<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>⟧</span> <span class=main>⟹</span> FCI <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?α</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> VIsViewOnE 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def VC_disjoint_def projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span>  <span class=var>?α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> 
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=var>?α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=var>?α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> BSI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span> 

    <span class=keyword1><span class=command>from</span></span><span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
    <span class=keyword1><span class=command>then</span></span> 
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=skolem><span class=skolem>α''</span></span>
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α''</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>using</span></span> projection_split_first_with_suffix <span class=keyword1><span class=command>by</span></span> <span class=operator>fastforce</span> 

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_is_Nil_conv projection_concatenation_commute<span class=main>)</span> 
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α''</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_is_Nil_conv projection_concatenation_commute<span class=main>)</span> 
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> validES 
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_contain_events_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>δ</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>δ</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>δ</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> VIsViewOnE projection_empty_implies_absence_of_events  
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?β</span></span></span><span class=main>=</span><span class=quoted><span class=skolem>β</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=var><span class=quoted><span class=var>?δ'</span></span></span><span class=main>=</span><span class=quoted><span class=skolem>δ</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=var><span class=quoted><span class=var>?α'</span></span></span><span class=main>=</span><span class=quoted><span class=skolem>α''</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span>set <span class=skolem>δ</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> 
            <span class=quoted><span class=quoted>‹<span class=skolem>α''</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α''</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=var>?δ'</span><span class=main>)</span><span class=main>⊆</span><span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=var>?β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=var>?δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'''</span> <span class=bound>δ''</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ''</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'''</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> 
              <span class=main>∧</span> <span class=bound>α'''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> FCI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-Trivially_fulfilled_FCIA_N_subseteq_Δ_and_BSIA><span class=command>lemma</span></span> Trivially_fulfilled_FCIA_N_subseteq_Δ_and_BSIA<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>⟧</span> <span class=main>⟹</span> FCIA <span class=free>ρ</span> <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?α</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span>"</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> VIsViewOnE 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def VC_disjoint_def projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span>  <span class=var>?α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹BSIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> 
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=var>?α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=var>?α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>›</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> BSIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span> 

    <span class=keyword1><span class=command>from</span></span><span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
    <span class=keyword1><span class=command>then</span></span> 
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=skolem><span class=skolem>α''</span></span>
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α''</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>using</span></span> projection_split_first_with_suffix <span class=keyword1><span class=command>by</span></span> <span class=operator>fastforce</span> 

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_is_Nil_conv projection_concatenation_commute<span class=main>)</span> 
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α''</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_is_Nil_conv projection_concatenation_commute<span class=main>)</span> 
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> validES 
      <span class=keyword1><span class=command>unfolding</span></span> ES_valid_def traces_contain_events_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>δ</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>δ</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>δ</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>using</span></span> VIsViewOnE projection_empty_implies_absence_of_events  
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?β</span></span></span><span class=main>=</span><span class=quoted><span class=skolem>β</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=var><span class=quoted><span class=var>?δ'</span></span></span><span class=main>=</span><span class=quoted><span class=skolem>δ</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=var><span class=quoted><span class=var>?α'</span></span></span><span class=main>=</span><span class=quoted><span class=skolem>α''</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span>set <span class=skolem>δ</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>=</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α''</span>›</span></span> 
            <span class=quoted><span class=quoted>‹<span class=skolem>α''</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α''</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=var>?δ'</span><span class=main>)</span><span class=main>⊆</span><span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=var>?β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=var>?δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=var>?α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=var>?α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'''</span> <span class=bound>δ''</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ''</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'''</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> 
              <span class=main>∧</span> <span class=bound>α'''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> FCIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword2><span class=keyword>end</span></span>

<span class=keyword1><span class=command>context</span></span> BSPTaxonomyDifferentViewsFirstDim
<span class=keyword2><span class=keyword>begin</span></span>
<span class=comment1>(* lemma taken from lemma 3.5.2 in Heiko Mantel's dissertation *)</span>
<span class=keyword1 id=BSPTaxonomy-R_implies_R_for_modified_view><span class=command>lemma</span></span> R_implies_R_for_modified_view<span class=main>:</span> 
<span class=quoted><span class=quoted>"R <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> R <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> R_𝒱<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"R <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>with</span></span> R_𝒱<span class=hidden>⇩</span><sub>1</sub> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>.</span>  <span class=bound>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> R_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>.</span>  <span class=bound>τ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span>  V2_subset_V1  C2_subset_C1  non_empty_projection_on_subset projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> R_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-BSD_implies_BSD_for_modified_view><span class=command>lemma</span></span> BSD_implies_BSD_for_modified_view<span class=main>:</span> 
<span class=quoted><span class=quoted>"BSD <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>⟹</span> BSD <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span><span class=operator>-</span> 
  <span class=keyword3><span class=command>assume</span></span> BSD_𝒱<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>n</span> 
    <span class=keyword3><span class=command>assume</span></span>  c_in_C<span class=hidden>⇩</span><sub>2</sub><span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>from</span></span> C2_subset_C1  c_in_C<span class=hidden>⇩</span><sub>2</sub>  <span class=keyword1><span class=command>have</span></span> c_in_C<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span><span class=main>;</span> <span class=skolem>n</span><span class=main>=</span> length<span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>⟧</span>
            <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>  <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span><span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>n</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>α</span></span>  <span class=main>)</span>        
      <span class=keyword3><span class=command>case</span></span> 0
        <span class=keyword1><span class=command>from</span></span> <span class=quoted>"0.prems"</span><span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>with</span></span> c_in_C<span class=hidden>⇩</span><sub>1</sub> <span class=quoted>"0.prems"</span><span class=main>(</span>1<span class=main>)</span> 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>using</span></span> BSD_𝒱<span class=hidden>⇩</span><sub>1</sub> <span class=keyword1><span class=command>unfolding</span></span> BSD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>then</span></span> 
        <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>from</span></span> V2_subset_V1  <span class=quoted><span class=quoted>‹<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span> non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>›</span></span>  C2_subset_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span> projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>ultimately</span></span>
        <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
          <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted>"Suc.prems"</span><span class=main>(</span>3<span class=main>)</span> projection_split_last<span class=main>[</span><span class=operator>OF</span> <span class=quoted>"Suc.prems"</span><span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span><span class=main>]</span>  
        <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span></span> <span class=skolem><span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span></span> <span class=skolem><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span></span> <span class=keyword2><span class=keyword>where</span></span> c<span class=hidden>⇩</span><sub>1</sub>_in_C<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span>"</span></span> 
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length<span class=main>(</span><span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span><span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>from</span></span>  <span class=quoted>"Suc.prems"</span><span class=main>(</span>2<span class=main>)</span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
        <span class=keyword1><span class=command>from</span></span>  <span class=quoted>"Suc.prems"</span><span class=main>(</span>1<span class=main>)</span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span>›</span></span> 
        <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β'</span><span class=main>=</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> 
        <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>" <span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>using</span></span> BSD_𝒱<span class=hidden>⇩</span><sub>1</sub>  <span class=keyword1><span class=command>unfolding</span></span> BSD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β'</span><span class=main>=</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>›</span></span> C2_subset_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_Nil projection_concatenation_commute projection_on_subset<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>n</span> <span class=main>=</span> length<span class=main>(</span><span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span><span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>›</span></span> 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length<span class=main>(</span><span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span><span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span> 
        <span class=keyword1><span class=command>have</span></span> witness<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span> <span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>  <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span>  Suc.hyps <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        
        <span class=keyword1><span class=command>from</span></span>  𝒱<span class=hidden>⇩</span><sub>1</sub>IsViewOnE 𝒱<span class=hidden>⇩</span><sub>2</sub>IsViewOnE V2_subset_V1 C2_subset_C1  c<span class=hidden>⇩</span><sub>1</sub>_in_C<span class=hidden>⇩</span><sub>1</sub> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>  
          <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
          <span class=keyword1><span class=command>unfolding</span></span> projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> "</span></span> 
          <span class=keyword1><span class=command>using</span></span> projection_concatenation_commute <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>with</span></span> V2_subset_V1 <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span> non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>metis</span>
        <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
       
       <span class=keyword1><span class=command>from</span></span> witness  <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>›</span></span> 
       <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
         <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>qed</span></span>          
 <span class=keyword1><span class=command>}</span></span>  
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=BSPTaxonomy-D_implies_D_for_modified_view><span class=command>lemma</span></span> D_implies_D_for_modified_view<span class=main>:</span> 
<span class=quoted><span class=quoted>"D <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> D <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span><span class=operator>-</span> 
  <span class=keyword3><span class=command>assume</span></span> D_𝒱<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"D <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
   <span class=keyword1><span class=command>from</span></span> V2_subset_V1 C2_subset_C1
    <span class=keyword1><span class=command>have</span></span> V<span class=hidden>⇩</span><sub>2</sub>_union_C<span class=hidden>⇩</span><sub>2</sub>_subset_V<span class=hidden>⇩</span><sub>1</sub>_union_C<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>n</span> 
    <span class=keyword3><span class=command>assume</span></span>  c_in_C<span class=hidden>⇩</span><sub>2</sub><span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>from</span></span> C2_subset_C1  c_in_C<span class=hidden>⇩</span><sub>2</sub>  <span class=keyword1><span class=command>have</span></span> c_in_C<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span><span class=main>;</span> <span class=skolem>n</span><span class=main>=</span> length<span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>⟧</span>
            <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> 
                  <span class=bound>β'</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>  <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>  <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> 
                     <span class=main>∧</span> <span class=bound>β'</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> "</span></span>
    <span class=keyword1><span class=command>proof</span></span><span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>n</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>α</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=main>)</span>        
      <span class=keyword3><span class=command>case</span></span> 0
        <span class=keyword1><span class=command>from</span></span> <span class=quoted>"0.prems"</span><span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>with</span></span> c_in_C<span class=hidden>⇩</span><sub>1</sub> <span class=quoted>"0.prems"</span><span class=main>(</span>1<span class=main>)</span> 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> 
                <span class=bound>β'</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>  <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span> 
                  <span class=main>∧</span> <span class=bound>β'</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>using</span></span> D_𝒱<span class=hidden>⇩</span><sub>1</sub> <span class=keyword1><span class=command>unfolding</span></span> D_def <span class=keyword1><span class=command>by</span></span> <span class=operator>fastforce</span>
        <span class=keyword1><span class=command>then</span></span> 
        <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β'</span></span> <span class=skolem><span class=skolem>α'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>"</span></span>
                      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>from</span></span> V2_subset_V1  <span class=quoted><span class=quoted>‹<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span> non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>›</span></span>  C2_subset_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>using</span></span> projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β'</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span>  V<span class=hidden>⇩</span><sub>2</sub>_union_C<span class=hidden>⇩</span><sub>2</sub>_subset_V<span class=hidden>⇩</span><sub>1</sub>_union_C<span class=hidden>⇩</span><sub>1</sub> 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>using</span></span> non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>ultimately</span></span>
        <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
          <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β'</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted>"Suc.prems"</span><span class=main>(</span>3<span class=main>)</span> projection_split_last<span class=main>[</span><span class=operator>OF</span> <span class=quoted>"Suc.prems"</span><span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span><span class=main>]</span>  
        <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span></span> <span class=skolem><span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span></span> <span class=skolem><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span></span> <span class=keyword2><span class=keyword>where</span></span> c<span class=hidden>⇩</span><sub>1</sub>_in_C<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span>"</span></span> 
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length<span class=main>(</span><span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span><span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>from</span></span>  <span class=quoted>"Suc.prems"</span><span class=main>(</span>2<span class=main>)</span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
        <span class=keyword1><span class=command>from</span></span>  <span class=quoted>"Suc.prems"</span><span class=main>(</span>1<span class=main>)</span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span>›</span></span> 
        <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β'</span><span class=main>=</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> 
        <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span></span>  <span class=skolem><span class=skolem>β''</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>" <span class=skolem>β''</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>"</span></span>
                         <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β''</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β'</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span> D_𝒱<span class=hidden>⇩</span><sub>1</sub>  <span class=keyword1><span class=command>unfolding</span></span> D_def <span class=keyword1><span class=command>by</span></span> <span class=operator>force</span>
        
        <span class=keyword1><span class=command>from</span></span>  c_in_C<span class=hidden>⇩</span><sub>1</sub> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span>  <span class=quoted><span class=quoted>‹<span class=skolem>β''</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β'</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β'</span><span class=main>=</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span>›</span></span>  
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β''</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
        <span class=keyword1><span class=command>ultimately</span></span>   
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>β'''</span> <span class=bound>γ<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>.</span> <span class=skolem>β''</span><span class=main>=</span><span class=bound>β'''</span><span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>γ<span class=hidden>⇩</span><sub>1</sub>'</span> 
                           <span class=main>∧</span> <span class=bound>β'''</span>  <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> 
                           <span class=main>∧</span> <span class=bound>γ<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span> projection_split_arbitrary_element <span class=keyword1><span class=command>by</span></span> <span class=operator>fast</span>
        <span class=keyword1><span class=command>then</span></span>  
        <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β'''</span></span> <span class=skolem><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β''</span><span class=main>=</span> <span class=skolem>β'''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span>"</span></span> 
                         <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β'''</span>  <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                         <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span> projection_split_arbitrary_element  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
        
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β''</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> this<span class=main>(</span>1<span class=main>)</span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β'''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>    

        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>using</span></span> C2_subset_C1 projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> <span class=keyword1><span class=command>using</span></span> C2_subset_C1 V2_subset_V1 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> non_empty_projection_on_subset projection_subset_eq_from_superset_eq sup_commute<span class=main>)</span>               
        <span class=keyword1><span class=command>ultimately</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
          
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span> projection_subset_eq_from_superset_eq sup_commute <span class=keyword1><span class=command>by</span></span> <span class=operator>metis</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"length<span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> length<span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"length<span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> length<span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>ultimately</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span><span class=main>=</span>length<span class=main>(</span><span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> projection_concatenation_commute<span class=main>)</span>

          
      
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β'''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>n</span><span class=main>=</span>length<span class=main>(</span><span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> 
        <span class=keyword1><span class=command>have</span></span> witness<span class=main>:</span> 
        <span class=quoted><span class=quoted>" <span class=main>∃</span><span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> <span class=bound>β'</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span>  <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> 
                    <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>β'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β'''</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span> Suc.hyps<span class=main>[</span><span class=operator>OF</span> <span class=quoted><span class=quoted>‹<span class=skolem>β'''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span><span class=main>]</span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        
        <span class=keyword1><span class=command>from</span></span> V<span class=hidden>⇩</span><sub>2</sub>_union_C<span class=hidden>⇩</span><sub>2</sub>_subset_V<span class=hidden>⇩</span><sub>1</sub>_union_C<span class=hidden>⇩</span><sub>1</sub>  <span class=quoted><span class=quoted>‹<span class=skolem>β'''</span>  <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β'''</span>  <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>using</span></span> non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
          
        <span class=keyword1><span class=command>from</span></span>  𝒱<span class=hidden>⇩</span><sub>1</sub>IsViewOnE 𝒱<span class=hidden>⇩</span><sub>2</sub>IsViewOnE V2_subset_V1 C2_subset_C1  c<span class=hidden>⇩</span><sub>1</sub>_in_C<span class=hidden>⇩</span><sub>1</sub> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>  
          <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c<span class=hidden>⇩</span><sub>1</sub></span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> projection_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> V2_subset_V1 <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
           <span class=keyword1><span class=command>using</span></span> V2_subset_V1 <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_subset_eq_from_superset_eq subset_Un_eq<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
          <span class=keyword1><span class=command>using</span></span> V2_subset_V1 <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_subset_eq_from_superset_eq subset_Un_eq<span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span>  
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>›</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

        <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β'''</span>  <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span><span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=main>@</span> <span class=skolem>γ<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>›</span></span>
        <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
          <span class=keyword1><span class=command>using</span></span> witness <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
     <span class=keyword1><span class=command>qed</span></span>          
 <span class=keyword1><span class=command>}</span></span>  
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> D_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
<span class=keyword1><span class=command>qed</span></span>
<span class=keyword2><span class=keyword>end</span></span> 

<span class=keyword1><span class=command>context</span></span> BSPTaxonomyDifferentViewsSecondDim
<span class=keyword2><span class=keyword>begin</span></span>
<span class=comment1>(* lemma taken from lemma 3.5.5 from Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-FCD_implies_FCD_for_modified_view_gamma><span class=command>lemma</span></span> FCD_implies_FCD_for_modified_view_gamma<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>FCD <span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> 
     V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>;</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊇</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>;</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>⟧</span>
     <span class=main>⟹</span> FCD <span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"FCD <span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊇</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>v</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> C2_equals_C1 <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> <span class=skolem><span class=skolem>δ'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹FCD <span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>unfolding</span></span> FCD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>  
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span>set <span class=skolem>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊇</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> V2_subset_V1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>using</span></span> non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> C2_equals_C1 <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>δ'</span> <span class=bound>α'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> 
                         <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=bound>δ'</span><span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>                
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> FCD_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
<span class=keyword1><span class=command>qed</span></span>  

<span class=comment1>(* lemma taken from lemma 3.5.10 in Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-SI_implies_SI_for_modified_view><span class=command>lemma</span></span> SI_implies_SI_for_modified_view <span class=main>:</span> 
<span class=quoted><span class=quoted>"SI <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> SI <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span>  SI<span class=main>:</span> <span class=quoted><span class=quoted>"SI <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command><span class=improper>with</span></span></span>  C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span>   alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> SI  <span class=keyword1><span class=command>unfolding</span></span> SI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> SI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>  


<span class=comment1>(* lemma taken from lemma 3.5.10 in Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-BSI_implies_BSI_for_modified_view><span class=command>lemma</span></span> BSI_implies_BSI_for_modified_view <span class=main>:</span> 
<span class=quoted><span class=quoted>"BSI <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> BSI <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span>  BSI<span class=main>:</span> <span class=quoted><span class=quoted>"BSI <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command><span class=improper>with</span></span></span>  C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span>   alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> BSI  <span class=keyword1><span class=command>unfolding</span></span> BSI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> V2_subset_V1  C2_equals_C1
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>metis</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>  

<span class=comment1>(* lemma taken from lemma 3.5.10 in Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-I_implies_I_for_modified_view><span class=command>lemma</span></span> I_implies_I_for_modified_view <span class=main>:</span> 
<span class=quoted><span class=quoted>"I <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>⟹</span> I <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span>  I<span class=main>:</span> <span class=quoted><span class=quoted>"I <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>from</span></span> V2_subset_V1 C2_equals_C1 <span class=keyword1><span class=command>have</span></span> V<span class=hidden>⇩</span><sub>2</sub>_union_C<span class=hidden>⇩</span><sub>2</sub>_subset_V<span class=hidden>⇩</span><sub>1</sub>_union_C<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command><span class=improper>with</span></span></span> C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span>   alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> 
            <span class=bound>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> 
              <span class=main>∧</span> <span class=bound>β'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> I  <span class=keyword1><span class=command>unfolding</span></span> I_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span>  V<span class=hidden>⇩</span><sub>2</sub>_union_C<span class=hidden>⇩</span><sub>2</sub>_subset_V<span class=hidden>⇩</span><sub>1</sub>_union_C<span class=hidden>⇩</span><sub>1</sub> V2_subset_V1  C2_equals_C1
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> 
              <span class=bound>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>  
                <span class=main>∧</span> <span class=bound>β'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>metis</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> I_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>  

<span class=comment1>(* lemma taken from lemma 3.5.10 in Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-SIA_implies_SIA_for_modified_view><span class=command>lemma</span></span> SIA_implies_SIA_for_modified_view <span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>SIA <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>⊇</span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span> <span class=main>⟧</span> <span class=main>⟹</span> SIA <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span>  SIA<span class=main>:</span> <span class=quoted><span class=quoted>"SIA <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>   ρ<span class=hidden>⇩</span><sub>2</sub>_supseteq_ρ<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>⊇</span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span>"</span></span> 
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> admissible_c_ρ<span class=hidden>⇩</span><sub>2</sub>_𝒱<span class=hidden>⇩</span><sub>2</sub><span class=main>:</span><span class=quoted><span class=quoted>"Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command><span class=improper>with</span></span></span>  C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span>   alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> ρ<span class=hidden>⇩</span><sub>2</sub>_supseteq_ρ<span class=hidden>⇩</span><sub>1</sub>  admissible_c_ρ<span class=hidden>⇩</span><sub>2</sub>_𝒱<span class=hidden>⇩</span><sub>2</sub> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_implies_Adm_for_modified_rho<span class=main>)</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> SIA  <span class=keyword1><span class=command>unfolding</span></span> SIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> SIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>  


<span class=comment1>(* lemma taken from lemma 3.5.10 in Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-BSIA_implies_BSIA_for_modified_view><span class=command>lemma</span></span> BSIA_implies_BSIA_for_modified_view <span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>BSIA <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>⊇</span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span> <span class=main>⟧</span> <span class=main>⟹</span> BSIA <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span>  BSIA<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>   ρ<span class=hidden>⇩</span><sub>2</sub>_supseteq_ρ<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>⊇</span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span>"</span></span> 
  <span class=keyword1><span class=command>from</span></span> V2_subset_V1 C2_equals_C1
  <span class=keyword1><span class=command>have</span></span> V<span class=hidden>⇩</span><sub>2</sub>_union_C<span class=hidden>⇩</span><sub>2</sub>_subset_V<span class=hidden>⇩</span><sub>1</sub>_union_C<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> admissible_c_ρ<span class=hidden>⇩</span><sub>2</sub>_𝒱<span class=hidden>⇩</span><sub>2</sub><span class=main>:</span><span class=quoted><span class=quoted>"Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command><span class=improper>with</span></span></span>  C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span>   alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> ρ<span class=hidden>⇩</span><sub>2</sub>_supseteq_ρ<span class=hidden>⇩</span><sub>1</sub>  admissible_c_ρ<span class=hidden>⇩</span><sub>2</sub>_𝒱<span class=hidden>⇩</span><sub>2</sub> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_implies_Adm_for_modified_rho<span class=main>)</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> BSIA  <span class=keyword1><span class=command>unfolding</span></span> BSIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> V2_subset_V1  C2_equals_C1 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>metis</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>  

<span class=comment1>(* lemma taken from lemma 3.5.10 in Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-IA_implies_IA_for_modified_view><span class=command>lemma</span></span> IA_implies_IA_for_modified_view <span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>IA <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>⊇</span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span> <span class=main>⟧</span> <span class=main>⟹</span> IA <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span>  IA<span class=main>:</span> <span class=quoted><span class=quoted>"IA <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>   ρ<span class=hidden>⇩</span><sub>2</sub>_supseteq_ρ<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>⊇</span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span>"</span></span> 
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span>  alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> admissible_c_ρ<span class=hidden>⇩</span><sub>2</sub>_𝒱<span class=hidden>⇩</span><sub>2</sub><span class=main>:</span><span class=quoted><span class=quoted>"Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command><span class=improper>with</span></span></span> C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span>   alpha_C<span class=hidden>⇩</span><sub>2</sub>_empty C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> ρ<span class=hidden>⇩</span><sub>2</sub>_supseteq_ρ<span class=hidden>⇩</span><sub>1</sub>  admissible_c_ρ<span class=hidden>⇩</span><sub>2</sub>_𝒱<span class=hidden>⇩</span><sub>2</sub> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_implies_Adm_for_modified_rho<span class=main>)</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> <span class=bound>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>β'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> IA  <span class=keyword1><span class=command>unfolding</span></span> IA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span>   V2_subset_V1 C2_equals_C1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span>  <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α'</span> <span class=bound>β'</span><span class=main>.</span> <span class=bound>β'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>  <span class=main>∧</span> <span class=bound>β'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> V2_subset_V1  C2_equals_C1   non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>metis</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> IA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* lemma taken from lemma 3.5.14 from Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-FCI_implies_FCI_for_modified_view_gamma><span class=command>lemma</span></span> FCI_implies_FCI_for_modified_view_gamma<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>FCI <span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span>
     V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>;</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊇</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>;</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>⟧</span>
     <span class=main>⟹</span> FCI <span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"FCI <span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊇</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>v</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> C2_equals_C1 <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span> 
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> <span class=skolem><span class=skolem>δ'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹FCI <span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>unfolding</span></span> FCI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>  
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span>set <span class=skolem>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊇</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> V2_subset_V1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>δ'</span> <span class=bound>α'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> 
                         <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span>  <span class=bound>δ'</span><span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
               <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>                
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> FCI_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
<span class=keyword1><span class=command>qed</span></span>  


<span class=comment1>(* lemma taken from lemma 3.5.14 from Heiko Mantel's dissertation*)</span>
<span class=keyword1 id=BSPTaxonomy-FCIA_implies_FCIA_for_modified_view_rho_gamma><span class=command>lemma</span></span> FCIA_implies_FCIA_for_modified_view_rho_gamma<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>FCIA <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>⊇</span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span><span class=main>;</span>
     V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>;</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊇</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>;</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>⟧</span>
     <span class=main>⟹</span> FCIA <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"FCIA <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>⊇</span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊇</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>v</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
       <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Υ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>v</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span>  V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>∇<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> C2_equals_C1 <span class=quoted><span class=quoted>‹<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>ρ<span class=hidden>⇩</span><sub>2</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span><span class=main>)</span> <span class=main>⊇</span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span><span class=main>(</span><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span><span class=main>)</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span> 
       <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_implies_Adm_for_modified_rho<span class=main>)</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> <span class=skolem><span class=skolem>δ'</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹FCIA <span class=free>ρ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span> <span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>unfolding</span></span> FCIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>  
    
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span>set <span class=skolem>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>⊇</span>  N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span><span class=main>∩</span>Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> V2_subset_V1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> non_empty_projection_on_subset <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>1</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>ultimately</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>δ'</span> <span class=bound>α'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>δ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span><span class=main>)</span> 
                         <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span>  <span class=bound>δ'</span><span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span><span class=main>↿</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span><span class=main>↿</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱<span class=hidden>⇩</span><sub>2</sub></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>                
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> FCIA_def <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
<span class=keyword1><span class=command>qed</span></span>   
<span class=keyword2><span class=keyword>end</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=PropertyLibrary>
<div class=head>
<h1>Theory PropertyLibrary</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> PropertyLibrary
<span class=keyword2><span class=keyword>imports</span></span> <a href=#InformationFlowProperties>InformationFlowProperties</a> <span class=quoted>"<a href=#EventSystems>../SystemSpecification/EventSystems</a>"</span> <span class=quoted>"<a href=#BSPTaxonomy>../Verification/Basics/BSPTaxonomy</a>"</span>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* The following properties assume a partition of the
event set into a set of low events (L) and a set of high
events (H), where low events are visible *)</span>
<span class=keyword1><span class=command>definition</span></span> 
<span class=entity>HighInputsConfidential</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> V_rec"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>HighInputsConfidential</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=main>≡</span> <span class=main>⦇</span> V<span class=main>=</span><span class=free><span class=bound><span class=entity>L</span></span></span><span class=main>,</span> N<span class=main>=</span><span class=free><span class=bound><span class=entity>H</span></span></span><span class=main>-</span><span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>,</span> C<span class=main>=</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=main>⦈</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span> <span class=entity>HighConfidential</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> V_rec"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>HighConfidential</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>≡</span> <span class=main>⦇</span> V<span class=main>=</span><span class=free><span class=bound><span class=entity>L</span></span></span><span class=main>,</span> N<span class=main>=</span><span class=main>{}</span><span class=main>,</span> C<span class=main>=</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>⦈</span>"</span></span>

<span class=keyword1><span class=command>fun</span></span> <span class=entity>interleaving</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> list <span class=main>⇒</span> <span class=tfree>'e</span> list <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>interleaving</span> <span class=free><span class=bound><span class=entity>t1</span></span></span> <span class=main>[]</span> <span class=main>=</span> <span class=main>{</span><span class=free><span class=bound><span class=entity>t1</span></span></span><span class=main>}</span>"</span></span> <span class=main>|</span>
<span class=quoted><span class=quoted>"<span class=free>interleaving</span> <span class=main>[]</span> <span class=free><span class=bound><span class=entity>t2</span></span></span> <span class=main>=</span> <span class=main>{</span><span class=free><span class=bound><span class=entity>t2</span></span></span><span class=main>}</span>"</span></span> <span class=main>|</span> 
<span class=quoted><span class=quoted>"<span class=free>interleaving</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>e1</span></span></span> <span class=main>#</span> <span class=free><span class=bound><span class=entity>t1</span></span></span><span class=main>)</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>e2</span></span></span> <span class=main>#</span> <span class=free><span class=bound><span class=entity>t2</span></span></span><span class=main>)</span> <span class=main>=</span> 
  <span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=main>∃</span><span class=bound>t'</span><span class=main>.</span> <span class=bound>t</span><span class=main>=</span><span class=main>(</span><span class=free><span class=bound><span class=entity>e1</span></span></span> <span class=main>#</span> <span class=bound>t'</span><span class=main>)</span> <span class=main>∧</span> <span class=bound>t'</span> <span class=main>∈</span> <span class=free>interleaving</span> <span class=free><span class=bound><span class=entity>t1</span></span></span> <span class=main>(</span><span class=free><span class=bound><span class=entity>e2</span></span></span> <span class=main>#</span><span class=free><span class=bound><span class=entity>t2</span></span></span><span class=main>)</span><span class=main>)</span><span class=main>}</span>
  <span class=main>∪</span> <span class=main>{</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=main>∃</span><span class=bound>t'</span><span class=main>.</span> <span class=bound>t</span><span class=main>=</span><span class=main>(</span><span class=free><span class=bound><span class=entity>e2</span></span></span> <span class=main>#</span> <span class=bound>t'</span><span class=main>)</span> <span class=main>∧</span> <span class=bound>t'</span> <span class=main>∈</span> <span class=free>interleaving</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>e1</span></span></span> <span class=main>#</span> <span class=free><span class=bound><span class=entity>t1</span></span></span><span class=main>)</span> <span class=free><span class=bound><span class=entity>t2</span></span></span><span class=main>)</span><span class=main>}</span>"</span></span>


<span class=comment1>(* Generalized Noninterference [McC87] *)</span>
<span class=comment1>(* MAKS representation *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>GNI</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> IFP_type"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>GNI</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=main>≡</span> <span class=main>(</span> <span class=main>{</span>HighInputsConfidential <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>}</span><span class=main>,</span> <span class=main>{</span>BSD<span class=main>,</span> BSI<span class=main>}</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=PropertyLibrary-GNI_valid><span class=command>lemma</span></span> GNI_valid<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>L</span> <span class=main>∩</span> <span class=free>H</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> IFP_valid <span class=main>(</span><span class=free>L</span> <span class=main>∪</span> <span class=free>H</span><span class=main>)</span> <span class=main>(</span>GNI <span class=free>L</span> <span class=free>H</span> <span class=free>IE</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> IFP_valid_def GNI_def HighInputsConfidential_def isViewOn_def 
    V_valid_def VN_disjoint_def VC_disjoint_def NC_disjoint_def
  <span class=keyword1><span class=command>using</span></span> BasicSecurityPredicates.BSP_valid_BSD BasicSecurityPredicates.BSP_valid_BSI 
  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
<span class=comment1>(* Literature representation *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>litGNI</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>litGNI</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span> <span class=bound>t1</span> <span class=bound>t2</span> <span class=bound>t3</span><span class=main>.</span> 
    <span class=bound>t1</span> <span class=main>@</span> <span class=bound>t2</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>t3</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∪</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>-</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> <span class=bound>t2</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∪</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>-</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span><span class=main>)</span>
     <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>t4</span><span class=main>.</span> <span class=bound>t1</span> <span class=main>@</span> <span class=bound>t4</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>t4</span><span class=main>↿</span><span class=main>(</span><span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∪</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> <span class=bound>t3</span><span class=main>↿</span><span class=main>(</span><span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∪</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span><span class=main>)</span><span class=main>)</span>"</span></span>  

<span class=comment1>(* Interleaving-based Generalized Noninterference [ZL97] *)</span>
<span class=comment1>(* MAKS representation *)</span> 
<span class=keyword1><span class=command>definition</span></span> <span class=entity>IBGNI</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> IFP_type"</span></span>
<span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=free>IBGNI</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=main>≡</span> <span class=main>(</span> <span class=main>{</span>HighInputsConfidential <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>}</span><span class=main>,</span> <span class=main>{</span>D<span class=main>,</span> I<span class=main>}</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=PropertyLibrary-IBGNI_valid><span class=command>lemma</span></span> IBGNI_valid<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>L</span> <span class=main>∩</span> <span class=free>H</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> IFP_valid <span class=main>(</span><span class=free>L</span> <span class=main>∪</span> <span class=free>H</span><span class=main>)</span> <span class=main>(</span>IBGNI <span class=free>L</span> <span class=free>H</span> <span class=free>IE</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> IFP_valid_def IBGNI_def HighInputsConfidential_def isViewOn_def 
    V_valid_def VN_disjoint_def VC_disjoint_def NC_disjoint_def
  <span class=keyword1><span class=command>using</span></span> BasicSecurityPredicates.BSP_valid_D BasicSecurityPredicates.BSP_valid_I 
  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>    

<span class=comment1>(* Literature representation *)</span> 
<span class=keyword1><span class=command>definition</span></span> 
<span class=entity>litIBGNI</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set <span class=main>⇒</span> bool"</span></span>  
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>litIBGNI</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span> <span class=bound>τ_l</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=main>∀</span> <span class=bound>t_hi</span> <span class=bound>t</span><span class=main>.</span> 
    <span class=main>(</span>set <span class=bound>t_hi</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span>  <span class=main>∧</span> <span class=bound>t</span> <span class=main>∈</span> interleaving <span class=bound>t_hi</span> <span class=main>(</span><span class=bound>τ_l</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span><span class=main>)</span> 
      <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>τ'</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=bound>τ'</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∪</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> <span class=bound>t</span><span class=main>)</span>"</span></span>  

<span class=comment1>(* Forward Correctability [JT88] *)</span>
<span class=comment1>(* MAKS representation *)</span>  
<span class=keyword1><span class=command>definition</span></span> <span class=entity>FC</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> IFP_type"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>FC</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=main>≡</span> 
  <span class=main>(</span> <span class=main>{</span>HighInputsConfidential <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>}</span><span class=main>,</span> 
  <span class=main>{</span>BSD<span class=main>,</span> BSI<span class=main>,</span> <span class=main>(</span>FCD <span class=main>⦇</span> Nabla<span class=main>=</span><span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>,</span> Delta<span class=main>=</span><span class=main>{}</span><span class=main>,</span> Upsilon<span class=main>=</span><span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=main>⦈</span><span class=main>)</span><span class=main>,</span> 
             <span class=main>(</span>FCI <span class=main>⦇</span> Nabla<span class=main>=</span><span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>,</span> Delta<span class=main>=</span><span class=main>{}</span><span class=main>,</span> Upsilon<span class=main>=</span><span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=main>⦈</span> <span class=main>)</span><span class=main>}</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=PropertyLibrary-FC_valid><span class=command>lemma</span></span> FC_valid<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>L</span> <span class=main>∩</span> <span class=free>H</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> IFP_valid <span class=main>(</span><span class=free>L</span> <span class=main>∪</span> <span class=free>H</span><span class=main>)</span> <span class=main>(</span>FC <span class=free>L</span> <span class=free>H</span> <span class=free>IE</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> IFP_valid_def FC_def HighInputsConfidential_def isViewOn_def 
    V_valid_def VN_disjoint_def VC_disjoint_def NC_disjoint_def
  <span class=keyword1><span class=command>using</span></span> BasicSecurityPredicates.BSP_valid_BSD BasicSecurityPredicates.BSP_valid_BSI
    BasicSecurityPredicates.BSP_valid_FCD BasicSecurityPredicates.BSP_valid_FCI
  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  

<span class=comment1>(* Literature representation *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>litFC</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>litFC</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>t_1</span> <span class=bound>t_2</span><span class=main>.</span> <span class=main>∀</span> <span class=bound>hi</span> <span class=main>∈</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span><span class=main>.</span> 
  <span class=main>(</span>
    <span class=main>(</span><span class=main>∀</span> <span class=bound>li</span> <span class=main>∈</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span><span class=main>.</span> 
      <span class=bound>t_1</span> <span class=main>@</span> <span class=main>[</span><span class=bound>li</span><span class=main>]</span> <span class=main>@</span> <span class=bound>t_2</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>t_2</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> 
      <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>t_3</span><span class=main>.</span> <span class=bound>t_1</span> <span class=main>@</span> <span class=main>[</span><span class=bound>hi</span><span class=main>]</span> <span class=main>@</span> <span class=main>[</span><span class=bound>li</span><span class=main>]</span> <span class=main>@</span> <span class=bound>t_3</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> 
                   <span class=main>∧</span> <span class=bound>t_3</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>=</span> <span class=bound>t_2</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∧</span> <span class=bound>t_3</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span><span class=main>)</span>
      <span class=main>∧</span> <span class=main>(</span><span class=bound>t_1</span> <span class=main>@</span> <span class=bound>t_2</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>t_2</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> 
         <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>t_3</span><span class=main>.</span> <span class=bound>t_1</span> <span class=main>@</span> <span class=main>[</span><span class=bound>hi</span><span class=main>]</span>  <span class=main>@</span> <span class=bound>t_3</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> 
                      <span class=main>∧</span> <span class=bound>t_3</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>=</span> <span class=bound>t_2</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∧</span> <span class=bound>t_3</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span><span class=main>)</span>
     <span class=main>∧</span> <span class=main>(</span><span class=main>∀</span> <span class=bound>li</span> <span class=main>∈</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span><span class=main>.</span> 
          <span class=bound>t_1</span> <span class=main>@</span> <span class=main>[</span><span class=bound>hi</span><span class=main>]</span> <span class=main>@</span> <span class=main>[</span><span class=bound>li</span><span class=main>]</span> <span class=main>@</span> <span class=bound>t_2</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>t_2</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> 
           <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>t_3</span><span class=main>.</span> <span class=bound>t_1</span> <span class=main>@</span> <span class=main>[</span><span class=bound>li</span><span class=main>]</span> <span class=main>@</span> <span class=bound>t_3</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> 
                        <span class=main>∧</span> <span class=bound>t_3</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>=</span> <span class=bound>t_2</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∧</span> <span class=bound>t_3</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span><span class=main>)</span> 
          <span class=main>∧</span> <span class=main>(</span><span class=bound>t_1</span> <span class=main>@</span> <span class=main>[</span><span class=bound>hi</span><span class=main>]</span>  <span class=main>@</span> <span class=bound>t_2</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=bound>t_2</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> 
             <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>t_3</span><span class=main>.</span> <span class=bound>t_1</span>  <span class=main>@</span> <span class=bound>t_3</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> 
                          <span class=main>∧</span> <span class=bound>t_3</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>=</span> <span class=bound>t_2</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∧</span> <span class=bound>t_3</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span><span class=main>)</span>
  <span class=main>)</span>"</span></span>  

<span class=comment1>(* Nondeducibility for outputs [GN88] *)</span>
<span class=comment1>(* MAKS representation *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>NDO</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> IFP_type"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>NDO</span> <span class=free><span class=bound><span class=entity>UI</span></span></span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>≡</span> 
  <span class=main>(</span> <span class=main>{</span>HighConfidential <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span><span class=main>}</span><span class=main>,</span> <span class=main>{</span>BSD<span class=main>,</span> <span class=main>(</span>BSIA <span class=main>(</span><span class=main>λ</span> <span class=bound>𝒱</span><span class=main>.</span> C<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>UI</span></span></span><span class=main>)</span><span class=main>)</span><span class=main>)</span><span class=main>}</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=PropertyLibrary-NDO_valid><span class=command>lemma</span></span> NDO_valid<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>L</span> <span class=main>∩</span> <span class=free>H</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> IFP_valid <span class=main>(</span><span class=free>L</span> <span class=main>∪</span> <span class=free>H</span><span class=main>)</span> <span class=main>(</span>NDO <span class=free>UI</span> <span class=free>L</span> <span class=free>H</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> IFP_valid_def NDO_def HighConfidential_def isViewOn_def 
    V_valid_def VN_disjoint_def VC_disjoint_def NC_disjoint_def
  <span class=keyword1><span class=command>using</span></span> BasicSecurityPredicates.BSP_valid_BSD
        BasicSecurityPredicates.BSP_valid_BSIA<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>λ</span> <span class=bound>𝒱</span><span class=main>.</span> C<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> <span class=free>UI</span><span class=main>)</span><span class=main>)</span>"</span></span><span class=main>]</span>
  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
  
<span class=comment1>(* Literature representation *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>litNDO</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>litNDO</span> <span class=free><span class=bound><span class=entity>UI</span></span></span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>τ_l</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=main>∀</span> <span class=bound>τ_hlui</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span>  <span class=main>∀</span> <span class=bound>t</span><span class=main>.</span> 
    <span class=bound>t</span><span class=main>↿</span><span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>=</span> <span class=bound>τ_l</span><span class=main>↿</span><span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∧</span> <span class=bound>t</span><span class=main>↿</span><span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∪</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>UI</span></span></span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> <span class=bound>τ_hlui</span><span class=main>↿</span><span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∪</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>UI</span></span></span><span class=main>)</span><span class=main>)</span> <span class=main>⟶</span> <span class=bound>t</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span>"</span></span>  
  
<span class=comment1>(* Noninference [ZL97] *)</span>
<span class=comment1>(* MAKS representation *)</span>  
<span class=keyword1><span class=command>definition</span></span> <span class=entity>NF</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> IFP_type"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>NF</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>≡</span> <span class=main>(</span> <span class=main>{</span>HighConfidential <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span><span class=main>}</span><span class=main>,</span> <span class=main>{</span>R<span class=main>}</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=PropertyLibrary-NF_valid><span class=command>lemma</span></span> NF_valid<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>L</span> <span class=main>∩</span> <span class=free>H</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> IFP_valid <span class=main>(</span><span class=free>L</span> <span class=main>∪</span> <span class=free>H</span><span class=main>)</span> <span class=main>(</span>NF <span class=free>L</span> <span class=free>H</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> IFP_valid_def NF_def HighConfidential_def isViewOn_def 
    V_valid_def VN_disjoint_def VC_disjoint_def NC_disjoint_def
  <span class=keyword1><span class=command>using</span></span> BasicSecurityPredicates.BSP_valid_R
  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>     

<span class=comment1>(* Literature representation *)</span>  
<span class=keyword1><span class=command>definition</span></span> <span class=entity>litNF</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>litNF</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> <span class=main>∀</span><span class=bound>τ</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=bound>τ</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span>"</span></span>


<span class=comment1>(* Generalized Noninference [ZL97] *)</span>
<span class=comment1>(* MAKS representation *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>GNF</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> IFP_type"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>GNF</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=main>≡</span> <span class=main>(</span> <span class=main>{</span>HighInputsConfidential <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>}</span><span class=main>,</span> <span class=main>{</span>R<span class=main>}</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=PropertyLibrary-GNF_valid><span class=command>lemma</span></span> GNF_valid<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>L</span> <span class=main>∩</span> <span class=free>H</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> IFP_valid <span class=main>(</span><span class=free>L</span> <span class=main>∪</span> <span class=free>H</span><span class=main>)</span> <span class=main>(</span>GNF <span class=free>L</span> <span class=free>H</span> <span class=free>IE</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> IFP_valid_def GNF_def HighInputsConfidential_def isViewOn_def 
    V_valid_def VN_disjoint_def VC_disjoint_def NC_disjoint_def
  <span class=keyword1><span class=command>using</span></span> BasicSecurityPredicates.BSP_valid_R
  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>       

<span class=comment1>(* Literature representation *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>litGNF</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>litGNF</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>IE</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>τ</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=main>∃</span><span class=bound>τ'</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=bound>τ'</span><span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>∩</span> <span class=free><span class=bound><span class=entity>IE</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>τ'</span><span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>=</span> <span class=bound>τ</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span>"</span></span>  
  
<span class=comment1>(* Separability [ZL97] *)</span>
<span class=comment1>(* MAKS representation *)</span>  
<span class=keyword1><span class=command>definition</span></span> <span class=entity>SEP</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> IFP_type"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>SEP</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>≡</span> <span class=main>(</span> <span class=main>{</span>HighConfidential <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span><span class=main>}</span><span class=main>,</span> <span class=main>{</span>BSD<span class=main>,</span> <span class=main>(</span>BSIA <span class=main>(</span><span class=main>λ</span> <span class=bound>𝒱</span><span class=main>.</span> C<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span><span class=main>}</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=PropertyLibrary-SEP_valid><span class=command>lemma</span></span> SEP_valid<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>L</span> <span class=main>∩</span> <span class=free>H</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> IFP_valid <span class=main>(</span><span class=free>L</span> <span class=main>∪</span> <span class=free>H</span><span class=main>)</span> <span class=main>(</span>SEP <span class=free>L</span> <span class=free>H</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> IFP_valid_def SEP_def HighConfidential_def isViewOn_def 
    V_valid_def VN_disjoint_def VC_disjoint_def NC_disjoint_def
  <span class=keyword1><span class=command>using</span></span> BasicSecurityPredicates.BSP_valid_BSD
        BasicSecurityPredicates.BSP_valid_BSIA<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"<span class=main>λ</span> <span class=bound>𝒱</span><span class=main>.</span> C<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span>
  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>     
    
<span class=comment1>(* Literature representation *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>litSEP</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>litSEP</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>τ_l</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=main>∀</span> <span class=bound>τ_h</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> 
    interleaving <span class=main>(</span><span class=bound>τ_l</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span><span class=main>)</span> <span class=main>(</span><span class=bound>τ_h</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>H</span></span></span><span class=main>)</span> <span class=main>⊆</span> <span class=main>{</span><span class=bound><span class=bound>τ</span></span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>.</span> <span class=bound>τ</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>=</span> <span class=bound>τ_l</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span><span class=main>}</span> "</span></span>  

<span class=comment1>(* Perfect Security Property [ZL97] *)</span>
<span class=comment1>(* MAKS representation *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>PSP</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> IFP_type"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>PSP</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=main>≡</span> 
  <span class=main>(</span> <span class=main>{</span>HighConfidential <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span><span class=main>}</span><span class=main>,</span> <span class=main>{</span>BSD<span class=main>,</span> <span class=main>(</span>BSIA <span class=main>(</span><span class=main>λ</span> <span class=bound>𝒱</span><span class=main>.</span> C<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span><span class=main>}</span><span class=main>)</span>"</span></span>

<span class=keyword1 id=PropertyLibrary-PSP_valid><span class=command>lemma</span></span> PSP_valid<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>L</span> <span class=main>∩</span> <span class=free>H</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟹</span> IFP_valid <span class=main>(</span><span class=free>L</span> <span class=main>∪</span> <span class=free>H</span><span class=main>)</span> <span class=main>(</span>PSP <span class=free>L</span> <span class=free>H</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>unfolding</span></span> IFP_valid_def PSP_def HighConfidential_def isViewOn_def 
    V_valid_def VN_disjoint_def VC_disjoint_def NC_disjoint_def
  <span class=keyword1><span class=command>using</span></span> BasicSecurityPredicates.BSP_valid_BSD
        BasicSecurityPredicates.BSP_valid_BSIA<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"<span class=main>λ</span> <span class=bound>𝒱</span><span class=main>.</span> C<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=bound>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span>
  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>         

<span class=comment1>(* Literature representation *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>litPSP</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> set <span class=main>⇒</span> <span class=tfree>'e</span> set <span class=main>⇒</span> <span class=main>(</span><span class=tfree>'e</span> list<span class=main>)</span> set <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>litPSP</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=free><span class=bound><span class=entity>H</span></span></span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>≡</span> 
  <span class=main>(</span><span class=main>∀</span><span class=bound>τ</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>.</span> <span class=bound>τ</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>L</span></span></span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>)</span> 
    <span class=main>∧</span> <span class=main>(</span><span class=main>∀</span> <span class=bound>α</span> <span class=bound>β</span><span class=main>.</span> <span class=main>(</span><span class=bound>β</span> <span class=main>@</span> <span class=bound>α</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>∧</span> <span class=main>(</span><span class=bound>α</span> <span class=main>↿</span> <span class=free><span class=bound><span class=entity>H</span></span></span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> 
                <span class=main>⟶</span> <span class=main>(</span><span class=main>∀</span> <span class=bound>h</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>H</span></span></span><span class=main>.</span> <span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>h</span><span class=main>]</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span> <span class=main>⟶</span> <span class=bound>β</span> <span class=main>@</span> <span class=main>[</span><span class=bound>h</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>Tr</span></span></span><span class=main>)</span><span class=main>)</span>"</span></span>  

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=SecureSystems>
<div class=head>
<h1>Theory SecureSystems</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> SecureSystems
<span class=keyword2><span class=keyword>imports</span></span> <span class=quoted>"<a href=#StateEventSystems>../../SystemSpecification/StateEventSystems</a>"</span>
  <span class=quoted>"<a href=#InformationFlowProperties>../../SecuritySpecification/InformationFlowProperties</a>"</span>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=keyword1><span class=command>locale</span></span> SecureESIFP <span class=main>=</span>
<span class=keyword2><span class=keyword>fixes</span></span> <span class=free>ES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec"</span></span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>IFP</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> IFP_type"</span></span>

<span class=keyword2><span class=keyword>assumes</span></span> validES<span class=main>:</span> <span class=quoted><span class=quoted>"ES_valid <span class=free>ES</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> validIFPES<span class=main>:</span> <span class=quoted><span class=quoted>"IFP_valid E<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span> <span class=free>IFP</span>"</span></span>

<span class=comment1>(* sublocale relations for SecureESIFP *)</span>

<span class=comment1>(* body of SecureESIFP *)</span>
<span class=keyword1><span class=command>context</span></span> SecureESIFP
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* defines whether information flow property IFP 
  is satisfied for event system ES *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>ES_sat_IFP</span> <span class=main>::</span> <span class=quoted><span class=quoted>"bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>ES_sat_IFP</span> <span class=main>≡</span> IFPIsSatisfied <span class=free>IFP</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES</span></sub><span class=hidden>⇙</span>"</span></span>

<span class=keyword2><span class=keyword>end</span></span>


<span class=keyword1><span class=command>locale</span></span> SecureSESIFP <span class=main>=</span>
<span class=keyword2><span class=keyword>fixes</span></span> <span class=free>SES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec"</span></span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>IFP</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> IFP_type"</span></span>

<span class=keyword2><span class=keyword>assumes</span></span> validSES<span class=main>:</span> <span class=quoted><span class=quoted>"SES_valid <span class=free>SES</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> validIFPSES<span class=main>:</span> <span class=quoted><span class=quoted>"IFP_valid E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>IFP</span>"</span></span>

<span class=comment1>(* sublocale relations for SecureSESIFP *)</span>

<span class=comment1>(* make theorems from SecureESIFP w.r.t. induceES visible in SecureSESIFP *)</span>
<span class=keyword1><span class=command>sublocale</span></span> SecureSESIFP <span class=main>⊆</span> SecureESIFP <span class=quoted><span class=quoted>"induceES <span class=free>SES</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>IFP</span>"</span></span>
<span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold_locales</span><span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> induceES_yields_ES<span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> validSES<span class=main><span class=keyword3>,</span></span>
  <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def<span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> validIFPSES<span class=main>)</span>

<span class=comment1>(* body of SecureSESIFP *)</span>
<span class=keyword1><span class=command>context</span></span> SecureSESIFP
<span class=keyword2><span class=keyword>begin</span></span>

<span class=keyword1><span class=command>abbreviation</span></span> <span class=entity>SES_sat_IFP</span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>SES_sat_IFP</span> <span class=main>≡</span> ES_sat_IFP"</span></span>

<span class=keyword2><span class=keyword>end</span></span>


<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=UnwindingConditions>
<div class=head>
<h1>Theory UnwindingConditions</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> UnwindingConditions
<span class=keyword2><span class=keyword>imports</span></span> <span class=quoted>"<a href=#BSPTaxonomy>../Basics/BSPTaxonomy</a>"</span>
  <span class=quoted>"<a href=#StateEventSystems>../../SystemSpecification/StateEventSystems</a>"</span>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=keyword1><span class=command>locale</span></span> Unwinding <span class=main>=</span>
<span class=keyword2><span class=keyword>fixes</span></span> <span class=free>SES</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=tfree>'s</span><span class=main>,</span> <span class=tfree>'e</span><span class=main>)</span> SES_rec"</span></span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>𝒱</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec"</span></span>

<span class=keyword2><span class=keyword>assumes</span></span> validSES<span class=main>:</span> <span class=quoted><span class=quoted>"SES_valid <span class=free>SES</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> validVU<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=free>𝒱</span> E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>

<span class=comment1>(* sublocale relations for Unwinding *)</span>
<span class=keyword1><span class=command>sublocale</span></span> Unwinding <span class=main>⊆</span> BSPTaxonomyDifferentCorrections <span class=quoted><span class=quoted>"induceES <span class=free>SES</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold_locales</span><span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_yields_ES validSES<span class=main><span class=keyword3>,</span></span>
    <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def validVU<span class=main>)</span>

<span class=comment1>(* body of Unwinding *)</span>
<span class=keyword1><span class=command>context</span></span> Unwinding
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* output step consistency (osc) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>osc</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'s</span> rel <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>osc</span> <span class=free><span class=bound><span class=entity>ur</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>s1</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>s2'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>e</span> <span class=main>∈</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>-</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span>
    <span class=main>(</span>reachable <span class=free>SES</span> <span class=bound>s1</span> <span class=main>∧</span> reachable <span class=free>SES</span> <span class=bound>s1'</span> 
       <span class=main>∧</span> <span class=bound>s1'</span> <span class=bound>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s2'</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>s1'</span><span class=main>,</span> <span class=bound>s1</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>ur</span></span></span><span class=main>)</span>
    <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>s2</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ</span><span class=main>.</span> <span class=bound>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=bound>e</span><span class=main>]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> 
          <span class=main>∧</span> <span class=bound>s1</span> <span class=bound>δ</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s2</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>s2'</span><span class=main>,</span> <span class=bound>s2</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>ur</span></span></span><span class=main>)</span>"</span></span>

<span class=comment1>(* locally-respects forwards (lrf) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>lrf</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'s</span> rel <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>lrf</span> <span class=free><span class=bound><span class=entity>ur</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>.</span> 
  <span class=main>(</span><span class=main>(</span>reachable <span class=free>SES</span> <span class=bound>s</span> <span class=main>∧</span> <span class=bound>s</span> <span class=bound>c</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span><span class=main>)</span> <span class=main>⟶</span> <span class=main>(</span><span class=bound>s'</span><span class=main>,</span> <span class=bound>s</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>ur</span></span></span><span class=main>)</span>"</span></span>

<span class=comment1>(* locally-respects backwards (lrb) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>lrb</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'s</span> rel <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>lrb</span> <span class=free><span class=bound><span class=entity>ur</span></span></span> <span class=main>≡</span> <span class=main>∀</span><span class=bound>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>.</span> 
  <span class=main>(</span>reachable <span class=free>SES</span> <span class=bound>s</span> <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span><span class=bound>s</span> <span class=bound>c</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>s</span><span class=main>,</span> <span class=bound>s'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>ur</span></span></span><span class=main>)</span><span class=main>)</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=comment1>(* forward-correctably respects forwards (fcrf) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>fcrf</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Gamma <span class=main>⇒</span> <span class=tfree>'s</span> rel <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>fcrf</span> <span class=free><span class=bound><span class=entity>Γ</span></span></span> <span class=free><span class=bound><span class=entity>ur</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> <span class=main>∀</span><span class=bound>v</span> <span class=main>∈</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> <span class=main>∀</span><span class=bound>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span>
    <span class=main>(</span><span class=main>(</span>reachable <span class=free>SES</span> <span class=bound>s</span> <span class=main>∧</span> <span class=bound>s</span> <span class=main>(</span><span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>[</span><span class=bound>v</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span><span class=main>)</span>
      <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>s''</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ</span><span class=main>.</span> <span class=main>(</span><span class=main>∀</span><span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>set <span class=bound>δ</span><span class=main>)</span><span class=main>.</span> <span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∧</span>
             <span class=bound>s</span> <span class=main>(</span><span class=bound>δ</span> <span class=main>@</span> <span class=main>[</span><span class=bound>v</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s''</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>s'</span><span class=main>,</span> <span class=bound>s''</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>ur</span></span></span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=comment1>(* forward-correctably respects backwards (fcrb) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>fcrb</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Gamma <span class=main>⇒</span> <span class=tfree>'s</span> rel <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span> 
<span class=quoted><span class=quoted>"<span class=free>fcrb</span> <span class=free><span class=bound><span class=entity>Γ</span></span></span> <span class=free><span class=bound><span class=entity>ur</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> <span class=main>∀</span><span class=bound>v</span> <span class=main>∈</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> <span class=main>∀</span><span class=bound>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>s''</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span>
  <span class=main>(</span><span class=main>(</span>reachable <span class=free>SES</span> <span class=bound>s</span> <span class=main>∧</span> <span class=bound>s</span> <span class=bound>v</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s''</span><span class=main>)</span>
    <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ</span><span class=main>.</span> <span class=main>(</span><span class=main>∀</span><span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>set <span class=bound>δ</span><span class=main>)</span><span class=main>.</span> <span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∧</span>
          <span class=bound>s</span> <span class=main>(</span><span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ</span> <span class=main>@</span> <span class=main>[</span><span class=bound>v</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>s''</span><span class=main>,</span> <span class=bound>s'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>ur</span></span></span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=comment1>(* ρ-enabledness *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>En</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Rho <span class=main>⇒</span> <span class=tfree>'s</span> <span class=main>⇒</span> <span class=tfree>'e</span> <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>En</span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>s</span></span></span> <span class=free><span class=bound><span class=entity>e</span></span></span> <span class=main>≡</span> 
  <span class=main>∃</span><span class=bound>β</span> <span class=bound>γ</span><span class=main>.</span> <span class=main>∃</span><span class=bound>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∃</span><span class=bound>s''</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span>
    s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free><span class=bound><span class=entity>s</span></span></span> <span class=main>∧</span> <span class=main>(</span><span class=bound>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=bound>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free>𝒱</span><span class=main>)</span><span class=main>)</span> 
     <span class=main>∧</span> s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>γ</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span> <span class=main>∧</span> <span class=bound>s'</span> <span class=free><span class=bound><span class=entity>e</span></span></span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s''</span>"</span></span>

<span class=comment1>(* locally-respects backwards for enabled events (lrbe) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>lrbe</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Rho <span class=main>⇒</span> <span class=tfree>'s</span> rel <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>lrbe</span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>ur</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>.</span>  
  <span class=main>(</span><span class=main>(</span>reachable <span class=free>SES</span> <span class=bound>s</span> <span class=main>∧</span> <span class=main>(</span>En <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=bound>s</span> <span class=bound>c</span><span class=main>)</span><span class=main>)</span> 
    <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span><span class=bound>s</span> <span class=bound>c</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>s</span><span class=main>,</span> <span class=bound>s'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>ur</span></span></span><span class=main>)</span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=comment1>(* forward-correctable respects backwards for enabled events (fcrbe) *)</span>
<span class=keyword1><span class=command>definition</span></span> <span class=entity>fcrbe</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> Gamma <span class=main>⇒</span> <span class=tfree>'e</span> Rho <span class=main>⇒</span> <span class=tfree>'s</span> rel <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>fcrbe</span> <span class=free><span class=bound><span class=entity>Γ</span></span></span> <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=free><span class=bound><span class=entity>ur</span></span></span> <span class=main>≡</span> 
  <span class=main>∀</span><span class=bound>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> <span class=main>∀</span><span class=bound>v</span> <span class=main>∈</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>.</span> <span class=main>∀</span><span class=bound>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∀</span><span class=bound>s''</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span>
  <span class=main>(</span><span class=main>(</span>reachable <span class=free>SES</span> <span class=bound>s</span> <span class=main>∧</span> <span class=bound>s</span> <span class=bound>v</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s''</span> <span class=main>∧</span> <span class=main>(</span>En <span class=free><span class=bound><span class=entity>ρ</span></span></span> <span class=bound>s</span> <span class=bound>c</span><span class=main>)</span><span class=main>)</span>
    <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ</span><span class=main>.</span> <span class=main>(</span><span class=main>∀</span><span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>set <span class=bound>δ</span><span class=main>)</span><span class=main>.</span> <span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>Γ</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∧</span>
           <span class=bound>s</span> <span class=main>(</span><span class=main>[</span><span class=bound>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ</span> <span class=main>@</span> <span class=main>[</span><span class=bound>v</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>s''</span><span class=main>,</span> <span class=bound>s'</span><span class=main>)</span> <span class=main>∈</span> <span class=free><span class=bound><span class=entity>ur</span></span></span><span class=main>)</span><span class=main>)</span>"</span></span>

<span class=keyword2><span class=keyword>end</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=AuxiliaryLemmas>
<div class=head>
<h1>Theory AuxiliaryLemmas</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> AuxiliaryLemmas
<span class=keyword2><span class=keyword>imports</span></span> <a href=#UnwindingConditions>UnwindingConditions</a>
<span class=keyword2><span class=keyword>begin</span></span>


<span class=keyword1><span class=command>context</span></span> Unwinding
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* Main lemma on output step consistency 
 (Lemma 5.4.2 in Heiko Mantel's dissertation)*)</span>
<span class=keyword1 id=AuxiliaryLemmas-osc_property><span class=command>lemma</span></span> osc_property<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>s1</span> <span class=bound>s1'</span><span class=main>.</span> <span class=main>⟦</span> osc <span class=free>ur</span><span class=main>;</span> <span class=bound>s1</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=bound>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> 
  reachable <span class=free>SES</span> <span class=bound>s1</span><span class=main>;</span> reachable <span class=free>SES</span> <span class=bound>s1'</span><span class=main>;</span> enabled <span class=free>SES</span> <span class=bound>s1'</span> <span class=free>α</span><span class=main>;</span> <span class=main>(</span><span class=bound>s1'</span><span class=main>,</span> <span class=bound>s1</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span> <span class=main>⟧</span>
  <span class=main>⟹</span> <span class=main>(</span><span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=free>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> enabled <span class=free>SES</span> <span class=bound>s1</span> <span class=bound>α'</span><span class=main>)</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>α</span></span><span class=main>)</span>
  <span class=keyword3><span class=command>case</span></span> Nil
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span>
    <span class=main>[]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> enabled <span class=free>SES</span> <span class=skolem>s1</span> <span class=main>[]</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def projection_def<span class=main>)</span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> exI<span class=main>)</span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>e1</span> <span class=skolem>α1</span><span class=main>)</span>
  <span class=keyword3><span class=command>assume</span></span> osc_true<span class=main>:</span> <span class=quoted><span class=quoted>"osc <span class=free>ur</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> s1_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> s1'_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> e1α1_C_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>α1</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> reachable_s1<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> reachable_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1'</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> enabled_s1'_e1α1<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1'</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>α1</span><span class=main>)</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> unwindingrel_s1'_s1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>s1'</span><span class=main>,</span> <span class=skolem>s1</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span>

  <span class=keyword1><span class=command>have</span></span> e1α1_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>a</span> <span class=main>∈</span> <span class=main>(</span>set <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>α1</span><span class=main>)</span><span class=main>)</span><span class=main>.</span> <span class=bound>a</span> <span class=main>∈</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>-</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> reachable_s1' <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> enabled_s1'_e1α1 <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1337</span></span>
      <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>α1</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1337</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>α1</span><span class=main>)</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1337</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>α1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> validSES induceES_yields_ES<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"<span class=free>SES</span>"</span></span><span class=main>]</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>a</span> <span class=main>∈</span> <span class=main>(</span>set <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>α1</span><span class=main>)</span><span class=main>)</span><span class=main>)</span><span class=main>.</span> <span class=bound>a</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def ES_valid_def traces_contain_events_def<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>a</span> <span class=main>∈</span> <span class=main>(</span>set <span class=main>(</span><span class=skolem>e1</span> <span class=main>#</span> <span class=skolem>α1</span><span class=main>)</span><span class=main>)</span><span class=main>.</span> <span class=bound>a</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> e1α1_C_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def filter_empty_conv<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>

  <span class=keyword1><span class=command>from</span></span> enabled_s1'_e1α1 <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s2'</span></span> <span class=keyword2><span class=keyword>where</span></span> 
    s1'_e1_s2'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=skolem>e1</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2'</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> validSES <span class=keyword1><span class=command>have</span></span> s2'_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> SES_valid_def correct_transition_relation_def<span class=main>)</span>
  <span class=keyword1><span class=command>have</span></span> reachable_s2'<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s2'</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> reachable_s1' <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t</span></span> <span class=keyword2><span class=keyword>where</span></span> 
      path_to_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>t</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>from</span></span> s1'_e1_s2' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>[</span><span class=skolem>e1</span><span class=main>]</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>with</span></span> path_to_s1' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>t</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>e1</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> path_trans<span class=main>)</span>
    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> exI<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>from</span></span> s1'_e1_s2' enabled_s1'_e1α1 <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>sn'</span></span> <span class=keyword2><span class=keyword>where</span></span> 
    <span class=quoted><span class=quoted>"<span class=skolem>s2'</span> <span class=skolem>α1</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>sn'</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>hence</span></span> enabled_s2'_α1<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s2'</span> <span class=skolem>α1</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def<span class=main>)</span>
  <span class=keyword1><span class=command>from</span></span> e1α1_no_c <span class=keyword1><span class=command>have</span></span> e1_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e1</span> <span class=main>∈</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>-</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
  <span class=keyword1><span class=command>from</span></span> e1α1_no_c <span class=keyword1><span class=command>have</span></span> α1_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>a</span><span class=main>∈</span><span class=main>(</span>set <span class=skolem>α1</span><span class=main>)</span><span class=main>.</span> <span class=main>(</span><span class=bound>a</span> <span class=main>∈</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>-</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
  <span class=keyword1><span class=command>hence</span></span> α1_proj_C_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
  <span class=keyword1><span class=command>from</span></span> osc_true <span class=keyword1><span class=command>have</span></span> 
    <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=skolem>s1</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=skolem>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=skolem>s2'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>;</span> 
      <span class=skolem>e1</span> <span class=main>∈</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>-</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span> reachable <span class=free>SES</span> <span class=skolem>s1</span><span class=main>;</span> reachable <span class=free>SES</span> <span class=skolem>s1'</span><span class=main>;</span> 
      <span class=skolem>s1'</span> <span class=skolem>e1</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2'</span><span class=main>;</span> <span class=main>(</span><span class=skolem>s1'</span><span class=main>,</span> <span class=skolem>s1</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span> <span class=main>⟧</span> 
     <span class=main>⟹</span> <span class=main>(</span><span class=main>∃</span><span class=bound>s2</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ</span><span class=main>.</span> <span class=bound>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
        <span class=main>∧</span> <span class=main>(</span><span class=bound>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>[</span><span class=skolem>e1</span><span class=main>]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=skolem>s1</span> <span class=bound>δ</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s2</span> <span class=main>∧</span> 
       <span class=main>(</span><span class=main>(</span><span class=skolem>s2'</span><span class=main>,</span> <span class=bound>s2</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span><span class=main>)</span><span class=main>)</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> osc_def<span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> s1_in_S s1'_in_S e1_no_c reachable_s1 reachable_s1' 
    s2'_in_S s1'_e1_s2' unwindingrel_s1'_s1 
  <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s2</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=keyword2><span class=keyword>where</span></span> 
    osc_conclusion<span class=main>:</span> 
      <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span>
      <span class=main>(</span><span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>[</span><span class=skolem>e1</span><span class=main>]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=skolem>s1</span> <span class=skolem>δ</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span> <span class=main>∧</span> 
      <span class=main>(</span><span class=main>(</span><span class=skolem>s2'</span><span class=main>,</span> <span class=skolem>s2</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> δ_proj_C_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
  <span class=keyword1><span class=command>from</span></span> osc_conclusion <span class=keyword1><span class=command>have</span></span> s2_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>from</span></span> osc_conclusion <span class=keyword1><span class=command>have</span></span> unwindingrel_s2'_s2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>s2'</span><span class=main>,</span> <span class=skolem>s2</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>have</span></span> reachable_s2<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s2</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> reachable_s1 <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t</span></span> <span class=keyword2><span class=keyword>where</span></span> 
      path_to_s1<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>t</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>from</span></span> osc_conclusion <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=skolem>δ</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> path_to_s1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>t</span> <span class=main>@</span> <span class=skolem>δ</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> path_trans<span class=main>)</span>
    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> exI<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>

  <span class=keyword1><span class=command>from</span></span> Cons osc_true s2_in_S s2'_in_S α1_proj_C_empty
    reachable_s2 reachable_s2' enabled_s2'_α1 unwindingrel_s2'_s2
  <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α''</span></span> <span class=keyword2><span class=keyword>where</span></span> α''_props<span class=main>:</span>
    <span class=quoted><span class=quoted>"<span class=skolem>α''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=skolem>α''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> enabled <span class=free>SES</span> <span class=skolem>s2</span> <span class=skolem>α''</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>with</span></span> osc_conclusion <span class=keyword1><span class=command>have</span></span>  δα''_props<span class=main>:</span>
    <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>δ</span> <span class=main>@</span> <span class=skolem>α''</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> 
    <span class=main>(</span><span class=skolem>δ</span> <span class=main>@</span> <span class=skolem>α''</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>e1</span><span class=main>#</span><span class=skolem>α1</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> enabled <span class=free>SES</span> <span class=skolem>s1</span> <span class=main>(</span><span class=skolem>δ</span> <span class=main>@</span> <span class=skolem>α''</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> path_trans<span class=main>)</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>δ</span> <span class=main>@</span> <span class=skolem>α''</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>using</span></span> δα''_props <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Paths will not bring us out of the domain of states.  *)</span>
<span class=keyword1 id=AuxiliaryLemmas-path_state_closure><span class=command>lemma</span></span> path_state_closure<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=free>s</span> <span class=free>τ</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s'</span><span class=main>;</span> <span class=free>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=free>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=main>(</span><span class=keyword2><span class=keyword>is</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=var>?P</span> <span class=free>s</span> <span class=free>τ</span> <span class=free>s'</span><span class=main>;</span> <span class=var>?S</span> <span class=free>s</span> <span class=free>SES</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=var>?S</span> <span class=free>s'</span> <span class=free>SES</span> "</span></span><span class=main>)</span>
<span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=free>τ</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=free>s</span></span> <span class=quoted><span class=free>s'</span></span><span class=main>)</span>
  <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword1><span class=command>with</span></span> validSES <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> SES_valid_def correct_transition_relation_def<span class=main>)</span>
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>e</span> <span class=skolem>τ</span><span class=main>)</span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword3><span class=command>assume</span></span> path_eτ<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?P</span> <span class=skolem>s</span> <span class=main>(</span><span class=skolem>e</span> <span class=main>#</span> <span class=skolem>τ</span><span class=main>)</span> <span class=skolem>s'</span>"</span></span> 
    <span class=keyword3><span class=command>assume</span></span> induct_hypo<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⋀</span> <span class=bound>s</span> <span class=bound>s'</span><span class=main>.</span> <span class=main>⟦</span> <span class=var>?P</span> <span class=bound>s</span> <span class=skolem>τ</span> <span class=bound>s'</span><span class=main>;</span> <span class=var>?S</span> <span class=bound>s</span> <span class=free>SES</span> <span class=main>⟧</span> <span class=main>⟹</span> <span class=var>?S</span> <span class=bound>s'</span> <span class=free>SES</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> path_eτ <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s''</span></span> <span class=keyword2><span class=keyword>where</span></span> s_e_s''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s</span> <span class=skolem>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s''</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> path_def<span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> validSES <span class=keyword1><span class=command>have</span></span> s''_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?S</span> <span class=skolem>s''</span> <span class=free>SES</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> SES_valid_def correct_transition_relation_def<span class=main>)</span>
    
    <span class=keyword1><span class=command>from</span></span> s_e_s'' path_eτ <span class=keyword1><span class=command>have</span></span> path_τ<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?P</span> <span class=skolem>s''</span> <span class=skolem>τ</span> <span class=skolem>s'</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>from</span></span> path_τ s''_in_S <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> induct_hypo<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(* Theorem 5.4.7 split into two parts *)</span>

<span class=comment1>(* first part *)</span>
<span class=keyword1><span class=command>theorem</span></span> En_to_Adm<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> reachable <span class=free>SES</span> <span class=free>s</span><span class=main>;</span> En <span class=free>ρ</span> <span class=free>s</span> <span class=free>e</span><span class=main>⟧</span> 
<span class=main>⟹</span> <span class=main>∃</span><span class=bound>β</span><span class=main>.</span> <span class=main>(</span> s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s</span> <span class=main>∧</span> Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=bound>β</span> <span class=free>e</span> <span class=main>)</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"En <span class=free>ρ</span> <span class=free>s</span> <span class=free>e</span>"</span></span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>β</span></span> <span class=skolem><span class=skolem>γ</span></span> <span class=skolem><span class=skolem>s'</span></span> <span class=skolem><span class=skolem>s''</span></span> 
    <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>   <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span> 
    <span class=keyword2><span class=keyword>and</span></span>   s0_γ_s'<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>γ</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span>"</span></span> 
    <span class=keyword2><span class=keyword>and</span></span>   s'_e_s''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s'</span> <span class=free>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s''</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> En_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>moreover</span></span> 
    <span class=keyword1><span class=command>from</span></span> s0_γ_s' s'_e_s'' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s''</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans_single<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main>)</span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* second part *)</span>
<span class=keyword1><span class=command>theorem</span></span> Adm_to_En<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=free>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>;</span> Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=free>β</span> <span class=free>e</span> <span class=main>⟧</span>
<span class=main>⟹</span> <span class=main>∃</span><span class=bound>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span>s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s</span> <span class=main>∧</span> En <span class=free>ρ</span> <span class=bound>s</span> <span class=free>e</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>from</span></span> validSES <span class=keyword1><span class=command>have</span></span> s0_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> SES_valid_def s0_is_state_def<span class=main>)</span> 
  
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=free>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s</span></span>
    <span class=keyword2><span class=keyword>where</span></span> s0_β_s<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>from</span></span> this <span class=keyword1><span class=command>have</span></span> s_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span> s0_in_S
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_state_closure<span class=main>)</span>

  <span class=keyword3><span class=command>assume</span></span>  <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=free>β</span> <span class=free>e</span>"</span></span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span>
    <span class=keyword2><span class=keyword>where</span></span> ργ_is_ρβ<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=free>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>   <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s''</span><span class=main>.</span> s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s''</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def induceES_def possible_traces_def enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s''</span></span>
    <span class=keyword2><span class=keyword>where</span></span>  s0_γe_s''<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=free>e</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s''</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>from</span></span> this <span class=keyword1><span class=command>have</span></span> s''_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s''</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>using</span></span> s0_in_S
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_state_closure<span class=main>)</span>
  
  <span class=keyword1><span class=command>from</span></span> path_split_single<span class=main>[</span><span class=operator>OF</span> s0_γe_s''<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s'</span></span> 
    <span class=keyword2><span class=keyword>where</span></span> s0_γ_s'<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>γ</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> s'_e_s''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s'</span> <span class=free>e</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s''</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

  <span class=keyword1><span class=command>from</span></span> path_state_closure<span class=main>[</span><span class=operator>OF</span> s0_γ_s' s0_in_S<span class=main>]</span> <span class=keyword1><span class=command>have</span></span> s'_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span><span class=keyword1><span class=command>.</span></span> 
  
  <span class=keyword1><span class=command>from</span></span> s'_in_S s''_in_S s0_β_s ργ_is_ρβ s0_γ_s' s'_e_s'' s_in_S <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> En_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(* It is a common pattern in the unwinding theorem proofs to obtain 
 a state from a given trace in a state event system and deduce some of its
 properties. This can be accomplished with the following lemma: 
*)</span>
<span class=keyword1 id=AuxiliaryLemmas-state_from_induceES_trace><span class=command>lemma</span></span> state_from_induceES_trace<span class=main>:</span> 
  <span class=quoted><span class=quoted>"<span class=main>⟦</span>  <span class=main>(</span><span class=free>β</span> <span class=main>@</span> <span class=free>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> <span class=main>∃</span><span class=bound>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s</span> <span class=main>∧</span> enabled <span class=free>SES</span> <span class=bound>s</span> <span class=free>α</span> <span class=main>∧</span> reachable <span class=free>SES</span> <span class=bound>s</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    
    <span class=keyword3><span class=command>assume</span></span> βα_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>β</span> <span class=main>@</span> <span class=free>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s'</span></span> <span class=keyword2><span class=keyword>where</span></span>  s0_βα_s'<span class=main>:</span><span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=free>β</span> <span class=main>@</span> <span class=free>α</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    
    <span class=keyword1><span class=command>from</span></span> path_split<span class=main>[</span><span class=operator>OF</span> s0_βα_s'<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> s0_β_s<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s</span> <span class=free>α</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>    
    <span class=keyword1><span class=command>hence</span></span> enabled_s_α<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s</span> <span class=free>α</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def<span class=main>)</span>
    
    <span class=keyword1><span class=command>from</span></span> s0_β_s <span class=keyword1><span class=command>have</span></span> reachable_s<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    
    <span class=keyword1><span class=command>from</span></span> validSES <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> SES_valid_def s0_is_state_def<span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> s0_β_s <span class=keyword1><span class=command>have</span></span> s_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_state_closure<span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> s0_β_s enabled_s_α reachable_s <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Another common pattern in unwinding results: *)</span>
<span class=keyword1 id=AuxiliaryLemmas-path_split2><span class=command>lemma</span></span> path_split2<span class=main>:</span><span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=free>β</span> <span class=main>@</span> <span class=free>α</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s</span> 
  <span class=main>⟹</span> <span class=main>∃</span><span class=bound>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span> s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span> <span class=main>∧</span> <span class=bound>s'</span> <span class=free>α</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s</span> <span class=main>∧</span> reachable <span class=free>SES</span> <span class=bound>s'</span> <span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
  <span class=keyword3><span class=command>assume</span></span> s0_βα_s<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=free>β</span> <span class=main>@</span> <span class=free>α</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s</span>"</span></span>

  <span class=keyword1><span class=command>from</span></span> path_split<span class=main>[</span><span class=operator>OF</span> s0_βα_s<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s'</span></span> 
    <span class=keyword2><span class=keyword>where</span></span> s0_β_s'<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s'</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> s'_α_s<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s'</span> <span class=free>α</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s'</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>  
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> s0_β_s' validSES path_state_closure <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> SES_valid_def s0_is_state_def<span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span>

  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>using</span></span> s'_α_s s0_β_s'
    <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span> 


<span class=comment1>(* Variant for singleton lists *)</span>
<span class=keyword1 id=AuxiliaryLemmas-path_split_single2><span class=command>lemma</span></span> path_split_single2<span class=main>:</span>
  <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=free>β</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s</span>
  <span class=main>⟹</span> <span class=main>∃</span><span class=bound>s'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span> s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s'</span> <span class=main>∧</span> <span class=bound>s'</span> <span class=free>x</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s</span> <span class=main>∧</span> reachable <span class=free>SES</span> <span class=bound>s'</span> <span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
  <span class=keyword3><span class=command>assume</span></span> s0_βx_s<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=free>β</span> <span class=main>@</span> <span class=main>[</span><span class=free>x</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=free>s</span>"</span></span>

  <span class=keyword1><span class=command>from</span></span> path_split2<span class=main>[</span><span class=operator>OF</span> s0_βx_s<span class=main>]</span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span> 

      
<span class=keyword1 id=AuxiliaryLemmas-modified_view_valid><span class=command>lemma</span></span> modified_view_valid<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=main>⦇</span>V <span class=main>=</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>⦈</span> E<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>using</span></span> validVU 
    <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def VC_disjoint_def VN_disjoint_def NC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
<span class=keyword2><span class=keyword>end</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=UnwindingResults>
<div class=head>
<h1>Theory UnwindingResults</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> UnwindingResults
<span class=keyword2><span class=keyword>imports</span></span> <a href=#AuxiliaryLemmas>AuxiliaryLemmas</a>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=keyword1><span class=command>context</span></span> Unwinding
<span class=keyword2><span class=keyword>begin</span></span>
<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_BSD<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> lrf <span class=free>ur</span><span class=main>;</span> osc <span class=free>ur</span> <span class=main>⟧</span> <span class=main>⟹</span> BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> lrf_true<span class=main>:</span> <span class=quoted><span class=quoted>"lrf <span class=free>ur</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> osc_true<span class=main>:</span> <span class=quoted><span class=quoted>"osc <span class=free>ur</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span> <span class=comment1>(* show that the conclusion of the BSP follows from the assumptions *)</span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> c_in_C<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> βcα_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> α_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
 
    <span class=keyword1><span class=command>from</span></span> state_from_induceES_trace<span class=main>[</span><span class=operator>OF</span> βcα_in_Tr<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> s1'_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> enabled_s1'_α<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1'</span> <span class=skolem>α</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> s0_βc_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> reachable_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>from</span></span> path_split_single2<span class=main>[</span><span class=operator>OF</span> s0_βc_s1'<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1</span></span>
      <span class=keyword2><span class=keyword>where</span></span> s1_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> s0_β_s1<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> s1_c_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=skolem>c</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> reachable_s1<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> s1_in_S s1'_in_S c_in_C reachable_s1 s1_c_s1' lrf_true 
    <span class=keyword1><span class=command>have</span></span> s1'_ur_s1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>s1'</span><span class=main>,</span> <span class=skolem>s1</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> lrf_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> osc_property<span class=main>[</span><span class=operator>OF</span> osc_true s1_in_S s1'_in_S α_contains_no_c reachable_s1
      reachable_s1' enabled_s1'_α s1'_ur_s1<span class=main>]</span>
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> α'_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α'_V_is_α_V<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> enabled_s1_α'<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1</span> <span class=skolem>α'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  
    <span class=keyword1><span class=command>have</span></span> βα'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>note</span></span> s0_β_s1
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> enabled_s1_α' <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s2</span></span>
        <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=skolem>α'</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span> ⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span>
    
    <span class=keyword1><span class=command>from</span></span> βα'_in_Tr α'_V_is_α_V α'_contains_no_c <span class=keyword1><span class=command>have</span></span> 
      <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>α'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> BSD_def<span class=main>)</span> 
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_BSI<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> lrb <span class=free>ur</span><span class=main>;</span> osc <span class=free>ur</span> <span class=main>⟧</span> <span class=main>⟹</span> BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> lrb_true<span class=main>:</span> <span class=quoted><span class=quoted>"lrb <span class=free>ur</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> osc_true<span class=main>:</span> <span class=quoted><span class=quoted>"osc <span class=free>ur</span>"</span></span>
  
  <span class=keyword1><span class=command>{</span></span>   <span class=comment1>(* show that the conclusion of the BSP follows from the assumptions *)</span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> c_in_C<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> βα_in_ind_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> α_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> state_from_induceES_trace<span class=main>[</span><span class=operator>OF</span> βα_in_ind_Tr<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1</span></span>
      <span class=keyword2><span class=keyword>where</span></span> s1_in_S <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> path_β_yields_s1<span class=main>:</span>  <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> enabled_s1_α<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1</span> <span class=skolem>α</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> reachable_s1<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> reachable_s1 s1_in_S c_in_C  lrb_true 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s1'</span><span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=skolem>s1</span> <span class=skolem>c</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s1'</span> <span class=main>∧</span> <span class=main>(</span><span class=skolem>s1</span><span class=main>,</span> <span class=bound>s1'</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> lrb_def<span class=main>)</span> 
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> s1'_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s1_trans_c_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=skolem>c</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s1_s1'_in_ur<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>s1</span><span class=main>,</span> <span class=skolem>s1'</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>have</span></span> reachable_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1'</span>"</span></span> 
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> path_β_yields_s1 s1_trans_c_s1' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans_single<span class=main>)</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span>
    
    <span class=keyword1><span class=command>from</span></span> osc_property<span class=main>[</span><span class=operator>OF</span> osc_true s1'_in_S s1_in_S α_contains_no_c 
      reachable_s1' reachable_s1 enabled_s1_α s1_s1'_in_ur<span class=main>]</span>
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> α'_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α'_V_is_α_V<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> enabled_s1'_α'<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1'</span> <span class=skolem>α'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>have</span></span> βcα'_in_ind_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> path_β_yields_s1 s1_trans_c_s1' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans_single<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> enabled_s1'_α' <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s2</span></span>
        <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=skolem>α'</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span>
    
    <span class=keyword1><span class=command>from</span></span> βcα'_in_ind_Tr α'_V_is_α_V α'_contains_no_c 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=skolem>c</span> <span class=main>#</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> BSI_def<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* unwinding theorem for BSP BSIA *)</span>
<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_BSIA<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> lrbe <span class=free>ρ</span> <span class=free>ur</span><span class=main>;</span> osc <span class=free>ur</span> <span class=main>⟧</span> <span class=main>⟹</span> BSIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> lrbe_true<span class=main>:</span> <span class=quoted><span class=quoted>"lrbe <span class=free>ρ</span> <span class=free>ur</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> osc_true<span class=main>:</span> <span class=quoted><span class=quoted>"osc <span class=free>ur</span>"</span></span>
  
  <span class=keyword1><span class=command>{</span></span> <span class=comment1>(* show that the conclusion of the BSP follows from the assumptions *)</span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> c_in_C<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> βα_in_ind_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> α_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    
    <span class=keyword3><span class=command>assume</span></span> adm<span class=main>:</span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> state_from_induceES_trace<span class=main>[</span><span class=operator>OF</span> βα_in_ind_Tr<span class=main>]</span> 
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> s1_in_S <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s0_β_s1<span class=main>:</span>  <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> enabled_s1_α<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1</span> <span class=skolem>α</span>"</span></span>  
      <span class=keyword2><span class=keyword>and</span></span> reachable_s1<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

        <span class=comment1>(* case distinction whether En is true or not *)</span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>cases</span>
      <span class=keyword3><span class=command>assume</span></span> en<span class=main>:</span> <span class=quoted><span class=quoted>"En <span class=free>ρ</span> <span class=skolem>s1</span> <span class=skolem>c</span>"</span></span> <span class=comment1>(*first case, en is true *)</span>

      <span class=keyword1><span class=command>from</span></span> reachable_s1 s1_in_S c_in_C en lrbe_true 
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s1'</span><span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=skolem>s1</span> <span class=skolem>c</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s1'</span> <span class=main>∧</span> <span class=main>(</span><span class=skolem>s1</span><span class=main>,</span> <span class=bound>s1'</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> lrbe_def<span class=main>)</span> 
      <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1'</span></span> 
        <span class=keyword2><span class=keyword>where</span></span> s1'_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> s1_trans_c_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=skolem>c</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> s1_s1'_in_ur<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>s1</span><span class=main>,</span> <span class=skolem>s1'</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

      <span class=keyword1><span class=command>have</span></span> reachable_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1'</span>"</span></span> 
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span> s0_β_s1 s1_trans_c_s1' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans_single<span class=main>)</span>
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span> 

      <span class=keyword1><span class=command>from</span></span> osc_property<span class=main>[</span><span class=operator>OF</span> osc_true s1'_in_S s1_in_S α_contains_no_c 
        reachable_s1' reachable_s1 enabled_s1_α s1_s1'_in_ur<span class=main>]</span> 
      <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
        <span class=keyword2><span class=keyword>where</span></span> α'_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α'_V_is_α_V<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> enabled_s1'_α'<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1'</span> <span class=skolem>α'</span>"</span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      
      <span class=keyword1><span class=command>have</span></span> βcα'_in_ind_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span> s0_β_s1 s1_trans_c_s1' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans_single<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> enabled_s1'_α' <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s2</span></span>
          <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=skolem>α'</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
      
      <span class=keyword1><span class=command>from</span></span> βcα'_in_ind_Tr α'_V_is_α_V α'_contains_no_c <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>next</span></span> <span class=comment1>(* second case, en is false *)</span>
      <span class=keyword3><span class=command>assume</span></span> not_en<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>¬</span> En <span class=free>ρ</span> <span class=skolem>s1</span> <span class=skolem>c</span>"</span></span>
      
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?A</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱</span> <span class=free>ρ</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>β</span> <span class=skolem>c</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?E</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span>s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s</span> <span class=main>∧</span> En <span class=free>ρ</span> <span class=bound>s</span> <span class=skolem>c</span><span class=main>)</span>"</span></span>

      <span class=keyword1><span class=command>{</span></span> <span class=comment1>(* show the contraposition of Adm_to_En *)</span>
        <span class=keyword3><span class=command>assume</span></span> adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?A</span>"</span></span> 
        
        <span class=keyword1><span class=command>from</span></span> s0_β_s1 <span class=keyword1><span class=command>have</span></span> β_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main>)</span>
        
        <span class=keyword1><span class=command>from</span></span>  β_in_Tr adm <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?E</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> Adm_to_En<span class=main>)</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>hence</span></span> Adm_to_En_contr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>¬</span> <span class=var>?E</span> <span class=main>⟹</span> <span class=main>¬</span> <span class=var>?A</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>with</span></span> s1_in_S s0_β_s1 not_en <span class=keyword1><span class=command>have</span></span> not_adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>¬</span> <span class=var>?A</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>with</span></span> adm <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> BSIA_def<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_FCD<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> fcrf <span class=free>Γ</span> <span class=free>ur</span><span class=main>;</span> osc <span class=free>ur</span> <span class=main>⟧</span> <span class=main>⟹</span> FCD <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
  <span class=keyword3><span class=command>assume</span></span> fcrf<span class=main>:</span> <span class=quoted><span class=quoted>"fcrf <span class=free>Γ</span> <span class=free>ur</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> osc<span class=main>:</span> <span class=quoted><span class=quoted>"osc <span class=free>ur</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span> <span class=comment1>(* show that the conclusion of the BSP follows from the assumptions *)</span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>

    <span class=keyword3><span class=command>assume</span></span> c_in_C_inter_Y<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> v_in_V_inter_Nabla<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> βcvα_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> α_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>

    <span class=keyword1><span class=command>from</span></span> state_from_induceES_trace<span class=main>[</span><span class=operator>OF</span> βcvα_in_Tr<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> s1'_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s0_βcv_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> enabled_s1'_α<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1'</span> <span class=skolem>α</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> reachable_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>from</span></span> path_split2<span class=main>[</span><span class=operator>OF</span> s0_βcv_s1'<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> s1_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s0_β_s1<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s1_cv_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> reachable_s1<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> c_in_C_inter_Y v_in_V_inter_Nabla s1_in_S s1'_in_S reachable_s1 s1_cv_s1' fcrf
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s1''</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ</span><span class=main>.</span> <span class=main>(</span><span class=main>∀</span><span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>set <span class=bound>δ</span><span class=main>)</span><span class=main>.</span> <span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∧</span>
      <span class=skolem>s1</span> <span class=main>(</span><span class=bound>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s1''</span> <span class=main>∧</span> <span class=main>(</span><span class=skolem>s1'</span><span class=main>,</span> <span class=bound>s1''</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> fcrf_def<span class=main>)</span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1''</span></span> <span class=skolem><span class=skolem>δ</span></span>
      <span class=keyword2><span class=keyword>where</span></span> s1''_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1''</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> δ_in_N_inter_Delta_star<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>∀</span><span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>set <span class=skolem>δ</span><span class=main>)</span><span class=main>.</span> <span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s1_δv_s1''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>(</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1''</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s1'_ur_s1''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>s1'</span><span class=main>,</span> <span class=skolem>s1''</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      
    <span class=keyword1><span class=command>have</span></span> reachable_s1''<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1''</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> s0_β_s1 s1_δv_s1'' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1''</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span>

    <span class=keyword1><span class=command>from</span></span> osc_property<span class=main>[</span><span class=operator>OF</span>  osc s1''_in_S s1'_in_S α_contains_no_c 
      reachable_s1'' reachable_s1' enabled_s1'_α s1'_ur_s1''<span class=main>]</span>
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span>  α'_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α'_V_is_α_V<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> enabled_s1''_α'<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1''</span> <span class=skolem>α'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>have</span></span> βδvα'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span> s0_β_s1 s1_δv_s1'' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1''</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> enabled_s1''_α' <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s2</span></span>
          <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1''</span> <span class=skolem>α'</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α'</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s2</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>

      <span class=keyword1><span class=command>from</span></span> δ_in_N_inter_Delta_star βδvα'_in_Tr α'_V_is_α_V α'_contains_no_c
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ'</span><span class=main>.</span> set <span class=bound>δ'</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> 
        <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCD_def<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_FCI<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> fcrb <span class=free>Γ</span> <span class=free>ur</span><span class=main>;</span> osc <span class=free>ur</span> <span class=main>⟧</span> <span class=main>⟹</span> FCI <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> fcrb<span class=main>:</span> <span class=quoted><span class=quoted>"fcrb <span class=free>Γ</span> <span class=free>ur</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> osc<span class=main>:</span> <span class=quoted><span class=quoted>"osc <span class=free>ur</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span> <span class=comment1>(* show that the conclusion of the BSP follows from the assumptions *)</span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>

    <span class=keyword3><span class=command>assume</span></span> c_in_C_inter_Y<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> v_in_V_inter_Nabla<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> βvα_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> α_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  
    <span class=keyword1><span class=command>from</span></span> state_from_induceES_trace<span class=main>[</span><span class=operator>OF</span> βvα_in_Tr<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1''</span></span>
      <span class=keyword2><span class=keyword>where</span></span> s1''_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1''</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s0_βv_s1''<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span> ⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1''</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> enabled_s1''_α<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1''</span> <span class=skolem>α</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> reachable_s1''<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1''</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> path_split_single2<span class=main>[</span><span class=operator>OF</span> s0_βv_s1''<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> s1_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s0_β_s1<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s1_v_s1''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=skolem>v</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1''</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> reachable_s1<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> c_in_C_inter_Y v_in_V_inter_Nabla s1_in_S 
      s1''_in_S reachable_s1 s1_v_s1'' fcrb 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ</span><span class=main>.</span> <span class=main>(</span><span class=main>∀</span><span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>set <span class=bound>δ</span><span class=main>)</span><span class=main>.</span> <span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>
      <span class=main>∧</span> <span class=skolem>s1</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s1'</span>
      <span class=main>∧</span> <span class=main>(</span><span class=skolem>s1''</span><span class=main>,</span> <span class=bound>s1'</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> fcrb_def<span class=main>)</span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1'</span></span> <span class=skolem><span class=skolem>δ</span></span>
      <span class=keyword2><span class=keyword>where</span></span> s1'_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> δ_in_N_inter_Delta_star<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>∀</span><span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>set <span class=skolem>δ</span><span class=main>)</span><span class=main>.</span> <span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s1_cδv_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s1''_ur_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>s1''</span><span class=main>,</span> <span class=skolem>s1'</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>have</span></span> reachable_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1'</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> s0_β_s1 s1_cδv_s1' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span>
    
    <span class=keyword1><span class=command>from</span></span> osc_property<span class=main>[</span><span class=operator>OF</span> osc s1'_in_S s1''_in_S α_contains_no_c 
      reachable_s1' reachable_s1'' enabled_s1''_α s1''_ur_s1'<span class=main>]</span>
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span>  α'_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α'_V_is_α_V<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> enabled_s1'_α'<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1'</span> <span class=skolem>α'</span>"</span></span> 
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>have</span></span> βcδvα'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?l1</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span>"</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?l2</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span>"</span></span>
      <span class=keyword1><span class=command>from</span></span> s0_β_s1 s1_cδv_s1' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=var>?l1</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> enabled_s1'_α' <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1337</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=var>?l2</span> ⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1337</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=var>?l1</span> <span class=main>@</span> <span class=var>?l2</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1337</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main>)</span> 
    <span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>from</span></span> δ_in_N_inter_Delta_star βcδvα'_in_Tr α'_V_is_α_V α'_contains_no_c
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span> <span class=bound>δ'</span><span class=main>.</span>
      set <span class=bound>δ'</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCI_def<span class=main>)</span>     
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_FCIA<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> fcrbe <span class=free>Γ</span> <span class=free>ρ</span> <span class=free>ur</span><span class=main>;</span> osc <span class=free>ur</span> <span class=main>⟧</span> <span class=main>⟹</span> FCIA <span class=free>ρ</span> <span class=free>Γ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> fcrbe<span class=main>:</span> <span class=quoted><span class=quoted>"fcrbe <span class=free>Γ</span> <span class=free>ρ</span> <span class=free>ur</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> osc<span class=main>:</span> <span class=quoted><span class=quoted>"osc <span class=free>ur</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span> <span class=comment1>(* show that the conclusion of the BSP follows from the assumptions *)</span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v</span>

    <span class=keyword3><span class=command>assume</span></span> c_in_C_inter_Y<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> v_in_V_inter_Nabla<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v</span> <span class=main>∈</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> βvα_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> α_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> adm<span class=main>:</span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>

    <span class=keyword1><span class=command>from</span></span> state_from_induceES_trace<span class=main>[</span><span class=operator>OF</span> βvα_in_Tr<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1''</span></span>
      <span class=keyword2><span class=keyword>where</span></span> s1''_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1''</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s0_βv_s1''<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1''</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> enabled_s1''_α<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1''</span> <span class=skolem>α</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> reachable_s1''<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1''</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> path_split_single2<span class=main>[</span><span class=operator>OF</span> s0_βv_s1''<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> s1_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s0_β_s1<span class=main>:</span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> s1_v_s1''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=skolem>v</span>⟶<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1''</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> reachable_s1<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
    
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span> <span class=bound>δ'</span><span class=main>.</span><span class=main>(</span>set <span class=bound>δ'</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span><span class=main>)</span>
      <span class=keyword3><span class=command>assume</span></span> en<span class=main>:</span> <span class=quoted><span class=quoted>"En <span class=free>ρ</span> <span class=skolem>s1</span> <span class=skolem>c</span>"</span></span>

      <span class=keyword1><span class=command>from</span></span> c_in_C_inter_Y v_in_V_inter_Nabla s1_in_S s1''_in_S reachable_s1 s1_v_s1'' en fcrbe
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>∃</span><span class=bound>δ</span><span class=main>.</span> <span class=main>(</span><span class=main>∀</span><span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>set <span class=bound>δ</span><span class=main>)</span><span class=main>.</span> <span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>
        <span class=main>∧</span> <span class=skolem>s1</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span> ⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s1'</span>
        <span class=main>∧</span> <span class=main>(</span><span class=skolem>s1''</span><span class=main>,</span> <span class=bound>s1'</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> fcrbe_def<span class=main>)</span>
      <span class=keyword1><span class=command>then</span></span>  <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1'</span></span> <span class=skolem><span class=skolem>δ</span></span>
        <span class=keyword2><span class=keyword>where</span></span> s1'_in_S<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ_in_N_inter_Delta_star<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>∀</span><span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>set <span class=skolem>δ</span><span class=main>)</span><span class=main>.</span> <span class=bound>d</span> <span class=main>∈</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> s1_cδv_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span> ⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> s1''_ur_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>s1''</span><span class=main>,</span> <span class=skolem>s1'</span><span class=main>)</span> <span class=main>∈</span> <span class=free>ur</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>

      <span class=keyword1><span class=command>have</span></span> reachable_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"reachable <span class=free>SES</span> <span class=skolem>s1'</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span> s0_β_s1 s1_cδv_s1' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span><span class=main>)</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> reachable_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
      
      <span class=keyword1><span class=command>from</span></span> osc_property<span class=main>[</span><span class=operator>OF</span> osc s1'_in_S s1''_in_S α_contains_no_c reachable_s1' 
        reachable_s1'' enabled_s1''_α s1''_ur_s1'<span class=main>]</span>
      <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α'</span></span> 
        <span class=keyword2><span class=keyword>where</span></span>  α'_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α'_V_is_α_V<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> enabled_s1'_α'<span class=main>:</span> <span class=quoted><span class=quoted>"enabled <span class=free>SES</span> <span class=skolem>s1'</span> <span class=skolem>α'</span>"</span></span> 
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

      <span class=keyword1><span class=command>have</span></span> βcδvα'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?l1</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v</span><span class=main>]</span>"</span></span>
        <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?l2</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>α'</span>"</span></span>
        <span class=keyword1><span class=command>from</span></span> s0_β_s1 s1_cδv_s1' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=var>?l1</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1'</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> enabled_s1'_α' <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1337</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=var>?l2</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1337</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> enabled_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=var>?l1</span> <span class=main>@</span> <span class=var>?l2</span><span class=main>)</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>s1337</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> path_trans<span class=main>)</span>
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main>)</span> 
      <span class=keyword1><span class=command>qed</span></span>

      <span class=keyword1><span class=command>from</span></span> δ_in_N_inter_Delta_star βcδvα'_in_Tr α'_V_is_α_V α'_contains_no_c
      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>assume</span></span> not_en<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>¬</span> En <span class=free>ρ</span> <span class=skolem>s1</span> <span class=skolem>c</span>"</span></span>
      
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?A</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?E</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>s</span> <span class=main>∈</span> S<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=main>(</span>s0<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span>⟹<span class=hidden>⇘</span><sub><span class=free>SES</span></sub><span class=hidden>⇙</span> <span class=bound>s</span> <span class=main>∧</span> En <span class=free>ρ</span> <span class=bound>s</span> <span class=skolem>c</span><span class=main>)</span>"</span></span>

      <span class=keyword1><span class=command>{</span></span> <span class=comment1>(* show the contraposition of Adm_to_En *)</span>
        <span class=keyword3><span class=command>assume</span></span> adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?A</span>"</span></span> 
        
        <span class=keyword1><span class=command>from</span></span> s0_β_s1 <span class=keyword1><span class=command>have</span></span> β_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> induceES_def possible_traces_def enabled_def<span class=main>)</span>
        
        <span class=keyword1><span class=command>from</span></span>  β_in_Tr adm <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?E</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> Adm_to_En<span class=main>)</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>hence</span></span> Adm_to_En_contr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>¬</span> <span class=var>?E</span> <span class=main>⟹</span> <span class=main>¬</span> <span class=var>?A</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>with</span></span> s1_in_S s0_β_s1 not_en <span class=keyword1><span class=command>have</span></span> not_adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>¬</span> <span class=var>?A</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>with</span></span> adm <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span>  
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> FCIA_def<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_SD<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span><span class=main>;</span> 
  Unwinding.lrf <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span><span class=main>;</span> Unwinding.osc <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> view'_def <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span>V <span class=main>=</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>⦈</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> lrf_view' <span class=main>:</span> <span class=quoted><span class=quoted>"Unwinding.lrf <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> osc_view' <span class=main>:</span> <span class=quoted><span class=quoted>"Unwinding.osc <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span>"</span></span>

  <span class=keyword1><span class=command>interpret</span></span> modified_view<span class=main>:</span> Unwinding <span class=quoted><span class=quoted>"<span class=free>SES</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold_locales</span><span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> validSES<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> view'_def modified_view_valid<span class=main>)</span>
      
  <span class=keyword1><span class=command>from</span></span> lrf_view' osc_view' <span class=keyword1><span class=command>have</span></span> BSD_view' <span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule_tac</span> ur<span class=main><span class=main>=</span></span><span class=quoted><span class=quoted>"<span class=free>ur</span>"</span></span> <span class=keyword2><span class=keyword><span class=quasi_keyword>in</span></span></span> modified_view.unwinding_theorem_BSD<span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> view'_def BSD_implies_SD_for_modified_view <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_SI<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span><span class=main>;</span> 
  Unwinding.lrb <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span><span class=main>;</span> Unwinding.osc <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> view'_def <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>⦈</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> lrb_view' <span class=main>:</span> <span class=quoted><span class=quoted>"Unwinding.lrb <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> osc_view' <span class=main>:</span> <span class=quoted><span class=quoted>"Unwinding.osc <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span>"</span></span>

  <span class=keyword1><span class=command>interpret</span></span> modified_view<span class=main>:</span> Unwinding <span class=quoted><span class=quoted>"<span class=free>SES</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold_locales</span><span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> validSES<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> view'_def modified_view_valid<span class=main>)</span>

  <span class=keyword1><span class=command>from</span></span> lrb_view' osc_view' <span class=keyword1><span class=command>have</span></span> BSI_view' <span class=main>:</span> <span class=quoted><span class=quoted>"BSI <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule_tac</span> ur<span class=main><span class=main>=</span></span><span class=quoted><span class=quoted>"<span class=free>ur</span>"</span></span> <span class=keyword2><span class=keyword><span class=quasi_keyword>in</span></span></span> modified_view.unwinding_theorem_BSI<span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> view'_def BSI_implies_SI_for_modified_view <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_SIA<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span><span class=main>;</span> <span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>=</span> <span class=free>ρ</span> <span class=free>𝒱'</span><span class=main>;</span> 
  Unwinding.lrbe <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ρ</span> <span class=free>ur</span><span class=main>;</span> Unwinding.osc <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> view'_def <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>⦈</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> ρ_eq <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>=</span> <span class=free>ρ</span> <span class=free>𝒱'</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> lrbe_view' <span class=main>:</span> <span class=quoted><span class=quoted>"Unwinding.lrbe <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ρ</span> <span class=free>ur</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> osc_view' <span class=main>:</span> <span class=quoted><span class=quoted>"Unwinding.osc <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span>"</span></span>

  <span class=keyword1><span class=command>interpret</span></span> modified_view<span class=main>:</span> Unwinding <span class=quoted><span class=quoted>"<span class=free>SES</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold_locales</span><span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> validSES<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> view'_def modified_view_valid<span class=main>)</span>

  <span class=keyword1><span class=command>from</span></span> lrbe_view' osc_view' <span class=keyword1><span class=command>have</span></span> BSIA_view' <span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ</span> <span class=free>𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule_tac</span> ur<span class=main><span class=main>=</span></span><span class=quoted><span class=quoted>"<span class=free>ur</span>"</span></span> <span class=keyword2><span class=keyword><span class=quasi_keyword>in</span></span></span> modified_view.unwinding_theorem_BSIA<span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> view'_def BSIA_implies_SIA_for_modified_view ρ_eq <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span> 

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_SR<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span> V <span class=main>=</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span><span class=main>;</span> 
  Unwinding.lrf <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span><span class=main>;</span> Unwinding.osc <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> SR <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> view'_def <span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>𝒱'</span> <span class=main>=</span> <span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>⦈</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> lrf_view' <span class=main>:</span> <span class=quoted><span class=quoted>"Unwinding.lrf <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> osc_view' <span class=main>:</span> <span class=quoted><span class=quoted>"Unwinding.osc <span class=free>SES</span> <span class=free>𝒱'</span> <span class=free>ur</span>"</span></span>

  <span class=keyword1><span class=command>from</span></span> lrf_view' osc_view' view'_def <span class=keyword1><span class=command>have</span></span> S_view <span class=main>:</span> <span class=quoted><span class=quoted>"SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule_tac</span> ur<span class=main><span class=main>=</span></span><span class=quoted><span class=quoted>"<span class=free>ur</span>"</span></span> <span class=keyword2><span class=keyword><span class=quasi_keyword>in</span></span></span>  unwinding_theorem_SD<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> SD_implies_SR <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_D<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> lrf <span class=free>ur</span><span class=main>;</span> osc <span class=free>ur</span> <span class=main>⟧</span> <span class=main>⟹</span> D <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"lrf <span class=free>ur</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"osc <span class=free>ur</span>"</span></span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> unwinding_theorem_BSD<span class=main>)</span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> BSD_implies_D<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_I<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> lrb <span class=free>ur</span><span class=main>;</span> osc <span class=free>ur</span> <span class=main>⟧</span> <span class=main>⟹</span> I <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"lrb <span class=free>ur</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"osc <span class=free>ur</span>"</span></span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> unwinding_theorem_BSI<span class=main>)</span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> BSI_implies_I<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_IA<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> lrbe <span class=free>ρ</span> <span class=free>ur</span><span class=main>;</span> osc <span class=free>ur</span> <span class=main>⟧</span> <span class=main>⟹</span> IA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"lrbe <span class=free>ρ</span> <span class=free>ur</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"osc <span class=free>ur</span>"</span></span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> unwinding_theorem_BSIA<span class=main>)</span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> BSIA_implies_IA<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1><span class=command>theorem</span></span> unwinding_theorem_R<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> lrf <span class=free>ur</span><span class=main>;</span> osc <span class=free>ur</span> <span class=main>⟧</span> <span class=main>⟹</span> R <span class=free>𝒱</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"lrf <span class=free>ur</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"osc <span class=free>ur</span>"</span></span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> unwinding_theorem_BSD<span class=main>)</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"D <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span>induceES <span class=free>SES</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> BSD_implies_D<span class=main>)</span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> D_implies_R<span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword2><span class=keyword>end</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=CompositionBase>
<div class=head>
<h1>Theory CompositionBase</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> CompositionBase
<span class=keyword2><span class=keyword>imports</span></span> <span class=quoted>"<a href=#BSPTaxonomy>../Basics/BSPTaxonomy</a>"</span>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=keyword1><span class=command>definition</span></span> 
<span class=entity>properSeparationOfViews</span> <span class=main>::</span> 
<span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> V_rec <span class=main>⇒</span> <span class=tfree>'e</span> V_rec <span class=main>⇒</span> <span class=tfree>'e</span> V_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>properSeparationOfViews</span> <span class=free><span class=bound><span class=entity>ES1</span></span></span> <span class=free><span class=bound><span class=entity>ES2</span></span></span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>𝒱1</span></span></span> <span class=free><span class=bound><span class=entity>𝒱2</span></span></span> <span class=main>≡</span>
   V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span>
   <span class=main>∧</span> V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span>
   <span class=main>∧</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span>
   <span class=main>∧</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span>
   <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>

<span class=keyword1><span class=command>definition</span></span>
<span class=entity>wellBehavedComposition</span> <span class=main>::</span> 
<span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> ES_rec <span class=main>⇒</span> <span class=tfree>'e</span> V_rec <span class=main>⇒</span> <span class=tfree>'e</span> V_rec <span class=main>⇒</span> <span class=tfree>'e</span> V_rec <span class=main>⇒</span> bool"</span></span>
<span class=keyword2><span class=keyword>where</span></span>
<span class=quoted><span class=quoted>"<span class=free>wellBehavedComposition</span> <span class=free><span class=bound><span class=entity>ES1</span></span></span> <span class=free><span class=bound><span class=entity>ES2</span></span></span> <span class=free><span class=bound><span class=entity>𝒱</span></span></span> <span class=free><span class=bound><span class=entity>𝒱1</span></span></span> <span class=free><span class=bound><span class=entity>𝒱2</span></span></span> <span class=main>≡</span>
<span class=main>(</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>)</span>
  <span class=main>∨</span> <span class=main>(</span><span class=main>∃</span><span class=bound>ρ1</span><span class=main>.</span> <span class=main>(</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> total <span class=free><span class=bound><span class=entity>ES1</span></span></span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> 
            <span class=main>∧</span> BSIA <span class=bound>ρ1</span> <span class=free><span class=bound><span class=entity>𝒱1</span></span></span> Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>)</span><span class=main>)</span>
  <span class=main>∨</span> <span class=main>(</span><span class=main>∃</span><span class=bound>ρ2</span><span class=main>.</span> <span class=main>(</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> total <span class=free><span class=bound><span class=entity>ES2</span></span></span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> 
            <span class=main>∧</span> BSIA <span class=bound>ρ2</span> <span class=free><span class=bound><span class=entity>𝒱2</span></span></span> Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>)</span><span class=main>)</span>
  <span class=main>∨</span> <span class=main>(</span><span class=main>∃</span><span class=bound>ρ1</span> <span class=bound>ρ2</span> <span class=bound>Γ1</span> <span class=bound>Γ2</span><span class=main>.</span> <span class=main>(</span> 
      ∇<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Δ<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Υ<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> ∇<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Δ<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Υ<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> BSIA <span class=bound>ρ1</span> <span class=free><span class=bound><span class=entity>𝒱1</span></span></span> Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> BSIA <span class=bound>ρ2</span> <span class=free><span class=bound><span class=entity>𝒱2</span></span></span> Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> total <span class=free><span class=bound><span class=entity>ES1</span></span></span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> total <span class=free><span class=bound><span class=entity>ES2</span></span></span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span><span class=main>)</span>
      <span class=main>∧</span> FCIA <span class=bound>ρ1</span> <span class=bound>Γ1</span> <span class=free><span class=bound><span class=entity>𝒱1</span></span></span> Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∧</span> FCIA <span class=bound>ρ2</span> <span class=bound>Γ2</span> <span class=free><span class=bound><span class=entity>𝒱2</span></span></span> Tr<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> ∇<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> C<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>𝒱2</span></span></span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free><span class=bound><span class=entity>ES1</span></span></span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>)</span><span class=main>)</span>"</span></span>

<span class=keyword1><span class=command>locale</span></span> Compositionality <span class=main>=</span>
<span class=keyword2><span class=keyword>fixes</span></span> <span class=free>ES1</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec"</span></span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>ES2</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec"</span></span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>𝒱</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec"</span></span> <span class=comment1>(* view of the composed system *)</span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>𝒱1</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec"</span></span> <span class=comment1>(* view for component ES1 *)</span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>𝒱2</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec"</span></span> <span class=comment1>(* view for component ES2 *)</span>

<span class=comment1>(* assumptions about the event systems *)</span>
<span class=keyword2><span class=keyword>assumes</span></span> validES1<span class=main>:</span> <span class=quoted><span class=quoted>"ES_valid <span class=free>ES1</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> validES2<span class=main>:</span> <span class=quoted><span class=quoted>"ES_valid <span class=free>ES2</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> composableES1ES2<span class=main>:</span> <span class=quoted><span class=quoted>"composable <span class=free>ES1</span> <span class=free>ES2</span>"</span></span>

<span class=comment1>(* basic assumptions about the views *)</span>
<span class=keyword2><span class=keyword>and</span></span> validVC<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=free>𝒱</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> validV1<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=free>𝒱1</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> validV2<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=free>𝒱2</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>


<span class=comment1>(* the following assumptions constitute proper separation of views 
  (Def. 6.3.2 in Heiko Mantel's dissertation) *)</span>
<span class=keyword2><span class=keyword>and</span></span> propSepViews<span class=main>:</span> <span class=quoted><span class=quoted>"properSeparationOfViews <span class=free>ES1</span> <span class=free>ES2</span> <span class=free>𝒱</span> <span class=free>𝒱1</span> <span class=free>𝒱2</span>"</span></span> 

<span class=comment1>(* the following assumptions constitute well behaved composition (Def. 6.3.6 in Mantel's dissertation) *)</span>
<span class=keyword2><span class=keyword>and</span></span> well_behaved_composition<span class=main>:</span> <span class=quoted><span class=quoted>"wellBehavedComposition <span class=free>ES1</span> <span class=free>ES2</span> <span class=free>𝒱</span> <span class=free>𝒱1</span> <span class=free>𝒱2</span>"</span></span>



<span class=comment1>(* sublocale relations for Compositionality *)</span>
<span class=keyword1><span class=command>sublocale</span></span> Compositionality <span class=main>⊆</span> BSPTaxonomyDifferentCorrections <span class=quoted><span class=quoted>"<span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span>
  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold_locales</span><span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> composeES_yields_ES<span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> validES1<span class=main><span class=keyword3>,</span></span>
    <span class=operator>rule</span> validES2<span class=main><span class=keyword3>,</span></span> <span class=operator>rule</span> validVC<span class=main>)</span>


<span class=comment1>(* body of Compositionality *)</span>
<span class=keyword1><span class=command>context</span></span> Compositionality
<span class=keyword2><span class=keyword>begin</span></span>


<span class=comment1>(* proper separation of views implies the following equality *)</span>
<span class=keyword1 id=CompositionBase-Vv_is_Vv1_union_Vv2><span class=command>lemma</span></span> Vv_is_Vv1_union_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> validVC <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=CompositionBase-disjoint_Nv1_Vv2><span class=command>lemma</span></span> disjoint_Nv1_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>from</span></span> validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>from</span></span> validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span> 
    <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> VN_disjoint_def V_valid_def inf_assoc inf_commute isViewOn_def<span class=main>)</span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>      
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=CompositionBase-disjoint_Nv2_Vv1><span class=command>lemma</span></span> disjoint_Nv2_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>from</span></span> validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>from</span></span> validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
    <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> VN_disjoint_def V_valid_def inf_assoc inf_commute isViewOn_def<span class=main>)</span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>      
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* An extended variant of the merge_property.
 Useful for the proof of the generalized zipping lemma. *)</span>
<span class=keyword1 id="CompositionBase-merge_property'"><span class=command>lemma</span></span> merge_property'<span class=main>:</span> <span class=quoted><span class=quoted>" <span class=main>⟦</span> set <span class=free>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> set <span class=free>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> 
  <span class=free>t1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=free>t2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=free>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> <span class=free>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> 
  <span class=free>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> <span class=free>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>⟧</span> 
<span class=main>⟹</span> <span class=main>∃</span> <span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=free>t1</span> <span class=main>∧</span> <span class=bound>t</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=free>t2</span> <span class=main>∧</span> <span class=bound>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=bound>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> set <span class=bound>t</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> t1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=free>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> t2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=free>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> t1_t2_synchronized<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>t1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=free>t2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> t1Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> t2Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> t1Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> t2Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>

  <span class=keyword1><span class=command>from</span></span> merge_property<span class=main>[</span><span class=operator>OF</span> t1_in_E1star t2_in_E2star t1_t2_synchronized<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t</span></span>
    <span class=keyword2><span class=keyword>where</span></span> t_is_interleaving<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=free>t1</span> <span class=main>∧</span> <span class=skolem>t</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=free>t2</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> t_contains_only_events_from_t1_t2<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t</span> <span class=main>⊆</span> set <span class=free>t1</span> <span class=main>∪</span> set <span class=free>t2</span>"</span></span>
    <span class=keyword1><span class=command>unfolding</span></span> Let_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>from</span></span> t1Vv_empty t2Vv_empty t_contains_only_events_from_t1_t2
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
    <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute Vv_is_Vv1_union_Vv2 projection_on_union projection_sequence t_is_interleaving<span class=main>)</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> t1Cv_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=bound>c</span> <span class=main>∉</span> set <span class=free>t1</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def filter_empty_conv<span class=main><span class=keyword3>,</span></span> <span class=operator>fast</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> t2Cv_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=bound>c</span> <span class=main>∉</span> set <span class=free>t2</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def filter_empty_conv<span class=main><span class=keyword3>,</span></span> <span class=operator>fast</span><span class=main>)</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span>
      <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=bound>c</span> <span class=main>∉</span> <span class=main>(</span>set <span class=free>t1</span> <span class=main>∪</span> set <span class=free>t2</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>with</span></span> t_contains_only_events_from_t1_t2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>.</span> <span class=bound>c</span> <span class=main>∉</span> set <span class=skolem>t</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> filter_empty_conv<span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>from</span></span> t1_in_E1star t2_in_E2star t_contains_only_events_from_t1_t2 
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword1 id=CompositionBase-Nv1_union_Nv2_subsetof_Nv><span class=command>lemma</span></span> Nv1_union_Nv2_subsetof_Nv<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>e</span>
    <span class=keyword3><span class=command>assume</span></span> e_in_N1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> 
      e_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> e_notin_V1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> e_notin_C1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∉</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def NC_disjoint_def
        VN_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span><span class=main><span class=keyword3>+</span></span>
    
    <span class=keyword1><span class=command>from</span></span> e_in_E1 e_notin_V1 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> e_in_E1 e_notin_C1 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∉</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> e_in_E1 validVC
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def NC_disjoint_def VN_disjoint_def
         composeES_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>e</span>
    <span class=keyword3><span class=command>assume</span></span> e_in_N2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> 
      e_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> E_ES <span class=free>ES2</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> e_notin_V2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> e_notin_C2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∉</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def NC_disjoint_def VN_disjoint_def
        <span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span><span class=main><span class=keyword3>+</span></span>
    
    <span class=keyword1><span class=command>from</span></span> e_in_E2 e_notin_V2 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> e_in_E2 e_notin_C2 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∉</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> e_in_E2 validVC
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>e</span> <span class=main>∈</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def VN_disjoint_def NC_disjoint_def
         composeES_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword2><span class=keyword>end</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=CompositionSupport>
<div class=head>
<h1>Theory CompositionSupport</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> CompositionSupport
<span class=keyword2><span class=keyword>imports</span></span> <a href=#CompositionBase>CompositionBase</a>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=keyword1><span class=command>locale</span></span> CompositionSupport <span class=main>=</span>
<span class=keyword2><span class=keyword>fixes</span></span> <span class=free>ESi</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> ES_rec"</span></span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>𝒱</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec"</span></span>
<span class=keyword2><span class=keyword>and</span></span> <span class=free>𝒱i</span> <span class=main>::</span> <span class=quoted><span class=quoted>"<span class=tfree>'e</span> V_rec"</span></span>

<span class=comment1>(* assumption about the component event system *)</span>
<span class=keyword2><span class=keyword>assumes</span></span> validESi<span class=main>:</span> <span class=quoted><span class=quoted>"ES_valid <span class=free>ESi</span>"</span></span>

<span class=comment1>(* assumption about the views (part of proper separation) *)</span>
<span class=keyword2><span class=keyword>and</span></span> validVi<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=free>𝒱i</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> Vv_inter_Ei_is_Vvi<span class=main>:</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> Cv_inter_Ei_subsetof_Cvi<span class=main>:</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>

<span class=comment1>(* sublocale relations for CompositionSupport *)</span>

<span class=comment1>(* body of CompositionSupport *)</span>
<span class=keyword1><span class=command>context</span></span> CompositionSupport
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* This lemma is used in the compositionality proof for BSD.
  Assuming that BSD holds for a subsystem ESi and given a trace β @ [c] @ α of the composed system,
  we can obtain a trace (β ↿ E<span class=hidden>⇘</span><sub>ESi</sub><span class=hidden>⇙</span>) @ α_i' of ESi where α_i' contains no 
  events that are confidential in ESi and (α_i' ↿ V<span class=hidden>⇘</span><sub>𝒱i</sub><span class=hidden>⇙</span>) = (α ↿ V<span class=hidden>⇘</span><sub>𝒱i</sub><span class=hidden>⇙</span>) holds.
  
 𝒱 and 𝒱i denote views on the composition and subsystem respectively.
  We assume that 𝒱 and 𝒱i are properly separated. *)</span>
<span class=keyword1 id=CompositionSupport-BSD_in_subsystem><span class=command>lemma</span></span> BSD_in_subsystem<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=free>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=main>(</span><span class=main>(</span><span class=free>β</span> <span class=main>@</span> <span class=main>[</span><span class=free>c</span><span class=main>]</span> <span class=main>@</span> <span class=free>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>;</span> BSD <span class=free>𝒱i</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> <span class=main>∃</span><span class=bound>α_i'</span><span class=main>.</span> <span class=main>(</span> <span class=main>(</span><span class=main>(</span><span class=free>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α_i'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> 
  <span class=main>∧</span> <span class=main>(</span><span class=bound>α_i'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=bound>α_i'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=main>(</span><span class=main>[</span><span class=free>c</span><span class=main>]</span> <span class=main>@</span> <span class=free>α</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=free>β</span></span> <span class=quoted><span class=free>c</span></span> <span class=quoted><span class=free>α</span></span><span class=main>)</span>
  <span class=keyword3><span class=command>case</span></span> 0
  <span class=comment1>(* show that ([c] @ α) ↿ E<span class=hidden>⇘</span><sub>ESi</sub><span class=hidden>⇙</span> is a suitable choice for α_i' *)</span>
  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?L</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
  
  <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> β_E1_cα_E1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> validVi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VN_disjoint_def VC_disjoint_def NC_disjoint_def 
          <span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_concatenation_commute<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> validVi Cv_inter_Ei_subsetof_Cvi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def  V_valid_def VC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_on_subset<span class=main>)</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?L</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_on_intersection<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>                
  <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>
  
  <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span> <span class=skolem><span class=skolem>c_i</span></span> <span class=skolem><span class=skolem>δ</span></span>
    <span class=keyword2><span class=keyword>where</span></span> c_i_in_C𝒱i<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c_i</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>   cα_is_γc_iδ<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>=</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>   δ_no_C𝒱i<span class=main>:</span>  <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>   n_is_len_γδ_C𝒱i<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=skolem>δ</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  
  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?L1</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>γ</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?L2</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>δ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>

  <span class=keyword1><span class=command>note</span></span> c_i_in_C𝒱i
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> list_with_c_i_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>@</span> <span class=var>?L2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> c_i_in_C𝒱i validVi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def
        VN_disjoint_def NC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>4<span class=main>)</span> cα_is_γc_iδ <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L1</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=var>?L2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>moreover</span></span> 
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?L2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> validVi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>x</span><span class=main>.</span> <span class=main>(</span><span class=bound>x</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def
        VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> δ_no_C𝒱i <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>            
  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>5<span class=main>)</span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ'</span></span>
    <span class=keyword2><span class=keyword>where</span></span> δ'_1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L1</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> δ'_2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?L2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> δ'_3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSD_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>hence</span></span> δ'_2'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?L2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> validVi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>x</span><span class=main>.</span> <span class=main>(</span><span class=bound>x</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>x</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>x</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def
        VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>with</span></span> δ'_2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>
  
  <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=skolem>γ</span></span><span class=main>)</span> <span class=comment1>(* need to distinguish between these cases as the inductive 
      hypothesis can only be applied to one case. *)</span>
    <span class=keyword3><span class=command>case</span></span> Nil
    <span class=keyword1><span class=command>with</span></span> cα_is_γc_iδ <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> δ_is_α<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>=</span> <span class=skolem>α</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=keyword1><span class=command>from</span></span> δ'_1 <span class=keyword1><span class=command>have</span></span> δ'_1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Nil<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> δ'_2'
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> δ'_3
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> δ_is_α<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
  <span class=keyword1><span class=command>next</span></span>
    <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>x</span> <span class=skolem>γ'</span><span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> cα_is_γc_iδ <span class=keyword1><span class=command>have</span></span> γ_is_cγ'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ'</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>with</span></span> n_is_len_γδ_C𝒱i <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ'</span> <span class=main>@</span> <span class=skolem>δ</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> δ_no_C𝒱i δ'_3 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ'</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>3<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>γ'</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> δ'_1 validESi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>=</span> <span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?L</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>γ</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ'</span>"</span></span>
        
        <span class=keyword1><span class=command>from</span></span> δ'_1 validESi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>e</span> <span class=main>∈</span> set <span class=var>?L</span><span class=main>.</span> <span class=bound>e</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main>)</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>with</span></span> δ'_1  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?L1</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>with</span></span> γ_is_cγ' δ'_1  <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>5<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ'</span> <span class=main>@</span> <span class=skolem>δ'</span>"</span></span> <span class=quoted><span class=skolem>β</span></span><span class=main>]</span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α_i'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> α_i'_1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α_i'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α_i'_2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α_i'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ'</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α_i'_3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α_i'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α_i'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ'</span> <span class=main>@</span> <span class=skolem>δ</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span> cα_is_γc_iδ γ_is_cγ' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>with</span></span> validVi c_i_in_C𝒱i <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def
            VN_disjoint_def NC_disjoint_def projection_concatenation_commute 
            projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> α_i'_2 δ'_2' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α_i'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ'</span> <span class=main>@</span> <span class=skolem>δ</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(*
    Variant of the previous lemma with different propositions (note the lack of a confidential event c).
*)</span>
<span class=keyword1 id=CompositionSupport-BSD_in_subsystem2><span class=command>lemma</span></span> BSD_in_subsystem2<span class=main>:</span>
<span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=main>(</span><span class=main>(</span><span class=free>β</span> <span class=main>@</span> <span class=free>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>;</span> BSD <span class=free>𝒱i</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α_i'</span><span class=main>.</span> <span class=main>(</span> <span class=main>(</span><span class=main>(</span><span class=free>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α_i'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>α_i'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=bound>α_i'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=free>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=free>β</span></span> <span class=quoted><span class=free>α</span></span><span class=main>)</span>
  <span class=keyword3><span class=command>case</span></span> 0
  <span class=comment1>(* show that α ↿ E<span class=hidden>⇘</span><sub>ESi</sub><span class=hidden>⇙</span>  is a suitable choice for α_i' *)</span>
  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?L</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
  
  <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> β_E1_α_E1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=var>?L</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> validVi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def
        VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?L</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>rule</span> projection_on_intersection<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>                
  <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  
<span class=keyword1><span class=command>next</span></span>
  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>
  
  <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span> <span class=skolem><span class=skolem>c_i</span></span> <span class=skolem><span class=skolem>δ</span></span>
    <span class=keyword2><span class=keyword>where</span></span> c_i_in_C𝒱i<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c_i</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>   α_is_γc_iδ<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>=</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>   δ_no_C𝒱i<span class=main>:</span>  <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span>   n_is_len_γδ_C𝒱i<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=skolem>δ</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  
  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?L1</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>γ</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?L2</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>δ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>


  <span class=comment1>(* first apply BSD to get rid of c_i in α *)</span>
  <span class=keyword1><span class=command>note</span></span> c_i_in_C𝒱i
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> list_with_c_i_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>@</span> <span class=var>?L2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> c_i_in_C𝒱i validVi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def
        VN_disjoint_def NC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>3<span class=main>)</span> α_is_γc_iδ <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L1</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=var>?L2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>moreover</span></span> 
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?L2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>from</span></span> validVi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>x</span><span class=main>.</span> <span class=main>(</span><span class=bound>x</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def
        VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> δ_no_C𝒱i <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
  <span class=keyword1><span class=command>qed</span></span>            
  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>4<span class=main>)</span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ'</span></span>
    <span class=keyword2><span class=keyword>where</span></span> δ'_1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?L1</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> δ'_2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?L2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> δ'_3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSD_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>hence</span></span> δ'_2'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?L2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> validVi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>x</span><span class=main>.</span> <span class=main>(</span><span class=bound>x</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>x</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>x</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def
        VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>with</span></span> δ'_2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>

  <span class=comment1>(* now that we eliminated c_i, we can apply the inductive hypothesis for ?β = β and ?α = γ @ δ' *)</span>
  <span class=keyword1><span class=command>from</span></span> n_is_len_γδ_C𝒱i δ_no_C𝒱i δ'_3 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>=</span> <span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?L</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>γ</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ'</span>"</span></span>
        
          <span class=keyword1><span class=command>from</span></span> δ'_1 validESi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span><span class=bound>e</span> <span class=main>∈</span> set <span class=var>?L</span><span class=main>.</span> <span class=bound>e</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main>)</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>with</span></span> δ'_1  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?L1</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>with</span></span> δ'_1  <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>moreover</span></span>
  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>4<span class=main>)</span> Suc<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=skolem>δ'</span>"</span></span> <span class=quoted><span class=skolem>β</span></span><span class=main>]</span> 
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α_i'</span></span> 
    <span class=keyword2><span class=keyword>where</span></span> res1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α_i'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ESi</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword2><span class=keyword>and</span></span> res2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α_i'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> res3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α_i'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

  <span class=comment1>(* Show that the resulting α_i' is suitable *)</span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α_i'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
      <span class=keyword1><span class=command>from</span></span> c_i_in_C𝒱i validVi <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c_i</span><span class=main>]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def
        VN_disjoint_def NC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>with</span></span> α_is_γc_iδ δ'_2' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=skolem>δ'</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱i</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>with</span></span> res2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>with</span></span> res1 res3 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword2><span class=keyword>end</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=GeneralizedZippingLemma>
<div class=head>
<h1>Theory GeneralizedZippingLemma</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> GeneralizedZippingLemma
<span class=keyword2><span class=keyword>imports</span></span> <a href=#CompositionBase>CompositionBase</a>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=keyword1><span class=command>context</span></span> Compositionality
<span class=keyword2><span class=keyword>begin</span></span>

<span class=comment1>(* The proof of the generalized zipping lemma is split into parts
  generalized_zipping_lemma1 .. generalized_zipping_lemma4
  corresponding to the four cases of well behaved composition.
    
Afterwards the actual lemma is proved based on these four parts. *)</span>
 
<span class=comment1>(* Generalized zipping lemma for case one of lemma 6.4.4 *)</span>
<span class=keyword1 id=GeneralizedZippingLemma-generalized_zipping_lemma1><span class=command>lemma</span></span> generalized_zipping_lemma1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span><span class=main>;</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟧</span> <span class=main>⟹</span> 
  <span class=main>∀</span> <span class=bound>τ</span> <span class=bound>lambda</span> <span class=bound>t1</span> <span class=bound>t2</span><span class=main>.</span> <span class=main>(</span> <span class=main>(</span> set <span class=bound>τ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
  <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>
  <span class=main>∧</span> <span class=main>(</span><span class=bound>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> 
  <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>@</span> <span class=bound>t</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=bound>lambda</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span> <span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> Nv1_inter_E2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Nv2_inter_E1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span> <span class=skolem>lambda</span> <span class=skolem>t1</span> <span class=skolem>t2</span>
    <span class=keyword3><span class=command>assume</span></span> τ_in_Estar<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>τ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> lambda_in_Vvstar<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> τ_E1_t1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> τ_E2_t2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> lambda_E1_is_t1_Vv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> lambda_E2_is_t2_Vv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t1_no_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t2_no_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
   
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> set <span class=skolem>τ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      set <span class=skolem>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>;</span> 
      set <span class=skolem>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      set <span class=skolem>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>⟧</span>  
      <span class=main>⟹</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=bound>t</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>lambda</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>lambda</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>τ</span></span> <span class=quoted><span class=skolem>t1</span></span> <span class=quoted><span class=skolem>t2</span></span><span class=main>)</span>
        <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Nil <span class=skolem>τ</span> <span class=skolem>t1</span> <span class=skolem>t2</span><span class=main>)</span>
        
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=main>[]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Nil<span class=main>(</span>5<span class=main>)</span> validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def 
                    prefixclosed_def prefix_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> Nil<span class=main>(</span>6<span class=main>)</span> validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                    prefixclosed_def prefix_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>note</span></span> Nil<span class=main>(</span>1<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>next</span></span>
        <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>𝒱'</span> <span class=skolem>lambda'</span> <span class=skolem>τ</span> <span class=skolem>t1</span> <span class=skolem>t2</span><span class=main>)</span> 
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> v'_in_Vv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> 
              <span class=main>∨</span> <span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
              <span class=main>∨</span> <span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>  
              <span class=keyword1><span class=command>using</span></span> Vv_is_Vv1_union_Vv2 v'_in_Vv  propSepViews
              <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
              <span class=keyword1><span class=command>by</span></span> <span class=operator>fastforce</span>
            <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv1_inter_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> v'_in_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv propSepViews 
              <span class=keyword1><span class=command>have</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          
              <span class=comment1>(* split t1, t2 w. r. t. 𝒱' *)</span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>2<span class=main>,</span>4<span class=main>,</span>8<span class=main>)</span> v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r1</span></span> <span class=skolem><span class=skolem>s1</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t1_is_r1_v'_s1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>=</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r1_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r1_Vv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>,</span>5<span class=main>,</span>9<span class=main>)</span> v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r2</span></span> <span class=skolem><span class=skolem>s2</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t2_is_r2_v'_s2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>=</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r2_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r2_Vv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=comment1>(* properties of r1, s1 *)</span>
              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 <span class=keyword1><span class=command>have</span></span> r1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> s1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>s1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>6<span class=main>)</span> t1_is_r1_v'_s1 
              <span class=keyword1><span class=command>have</span></span> τE1_r1_v'_s1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>

              <span class=keyword1><span class=command>have</span></span> r1_in_Nv1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> r1_in_E1star
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1_Vv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Diff_eq Int_commute 
                      Int_empty_right disjoint_eq_subset_Compl 
                      list_subset_iff_projection_neutral projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1_Cv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Diff_eq  Int_commute 
                      Int_empty_right disjoint_eq_subset_Compl 
                      list_subset_iff_projection_neutral projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> validV1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Nv1_inter_E2_empty <span class=keyword1><span class=command>have</span></span> r1E2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute empty_subsetI projection_on_subset2 r1_Vv_empty<span class=main>)</span>                

              <span class=comment1>(* properties of r2, s2 *)</span>
              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>5<span class=main>)</span> t2_is_r2_v'_s2 <span class=keyword1><span class=command>have</span></span> r2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> s2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>s2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>7<span class=main>)</span> t2_is_r2_v'_s2 
              <span class=keyword1><span class=command>have</span></span> τE2_r2_v'_s2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>

              <span class=keyword1><span class=command>have</span></span> r2_in_Nv2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> r2_in_E2star
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r2_Vv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r2_Cv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> validV2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Nv2_inter_E1_empty <span class=keyword1><span class=command>have</span></span> r2E1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute empty_subsetI projection_on_subset2 r2_Vv_empty<span class=main>)</span>          
                            
              <span class=comment1>(* apply inductive hypothesis to lambda' s1 s2 *)</span>
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>2<span class=main>)</span> r1_in_E1star r2_in_E2star v'_in_E2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> s1_in_E1star s2_in_E2star
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>6<span class=main>)</span> r1_in_E1star r2E1_empty v'_in_E1 t1_is_r1_v'_s1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>s1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute 
                  list_subset_iff_projection_neutral projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>7<span class=main>)</span> r2_in_E2star r1E2_empty v'_in_E2 t2_is_r2_v'_s2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>s2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute 
                  list_subset_iff_projection_neutral projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>2<span class=main>,</span>4<span class=main>,</span>8<span class=main>)</span> v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 r1_Vv_empty v'_in_Vv1 Vv_is_Vv1_union_Vv2 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t1_is_r1_v'_s1 projection_concatenation_commute 
                      projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>,</span>5<span class=main>,</span>9<span class=main>)</span> v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 r2_Vv_empty v'_in_Vv2 Vv_is_Vv1_union_Vv2 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t2_is_r2_v'_s2 projection_concatenation_commute 
                      projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> s1_Cv1_empty s2_Cv2_empty Cons.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>s1</span></span> <span class=quoted><span class=skolem>s2</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> tau_t'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>

              <span class=comment1>(* conclude that ?t is a suitable choice *)</span>              
              <span class=keyword1><span class=command>note</span></span> tau_t'_in_Tr
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r1_Vv_empty r2_Vv_empty t'Vv_is_lambda' v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>                 
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  projection_on_subset2  r1_Cv1_empty r1_in_E1star<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  projection_on_subset2 r2_Cv2_empty r2_in_E2star<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> v'_in_Vv VIsViewOnE t'Cv_empty 
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv1_minus_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv propSepViews <span class=keyword1><span class=command>have</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> v'_in_Vv1_minus_E2 <span class=keyword1><span class=command>have</span></span> v'_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> v'_notin_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

               <span class=comment1>(* split t1 w.r.t. 𝒱' *)</span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> Cons<span class=main>(</span>4<span class=main>)</span> Cons<span class=main>(</span>8<span class=main>)</span> v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r1</span></span> <span class=skolem><span class=skolem>s1</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t1_is_r1_v'_s1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>=</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r1_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r1_Vv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=comment1>(* properties of r1 s1 *)</span>
              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 <span class=keyword1><span class=command>have</span></span> r1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> r1_in_Nv1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>note</span></span> r1_in_E1star
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r1_Vv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Diff_eq  Int_commute 
                    Int_empty_right disjoint_eq_subset_Compl 
                    list_subset_iff_projection_neutral projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r1_Cv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Diff_eq  Int_commute 
                    Int_empty_right disjoint_eq_subset_Compl 
                    list_subset_iff_projection_neutral projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> validV1
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Nv1_inter_E2_empty <span class=keyword1><span class=command>have</span></span> r1E2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>               
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute empty_subsetI 
                  projection_on_subset2 r1_Vv1_empty<span class=main>)</span>
             
              <span class=comment1>(* apply inductive hypothesis to lambda' r1 t2 *)</span>
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
              
              <span class=keyword1><span class=command>from</span></span> v'_in_E1 Cons<span class=main>(</span>2<span class=main>)</span> r1_in_Nv1star validV1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> isViewOn_def composeES_def V_valid_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons<span class=main>(</span>5<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Cons_eq_appendI append_eq_appendI calculation<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> eq_Nil_appendI 
                  list_subset_iff_projection_neutral Cons.prems<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> Cons.prems<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span> 
                  projection_concatenation_commute t1_is_r1_v'_s1<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>t2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> Cons<span class=main>(</span>7<span class=main>)</span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 v'_notin_E2 
                    r1_in_Nv1star Nv1_inter_E2_empty r1E2_empty
                    <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t1_is_r1_v'_s1 list_subset_iff_projection_neutral 
                        projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>8<span class=main>)</span> t1_is_r1_v'_s1 r1_Vv_empty v'_in_E1 v'_in_Vv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>9<span class=main>)</span> v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>         
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> s1_Cv1_empty Cons<span class=main>(</span>11<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>s1</span></span> <span class=quoted><span class=skolem>t2</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> tau_t'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>

              <span class=comment1>(* conclude that ?t is a suitable choice *)</span>      
              <span class=keyword1><span class=command>note</span></span> tau_t'_in_Tr
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r1_Vv_empty t'_Vv_is_lambda' v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>hence</span></span><span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>                 
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_on_subset2 r1_Cv1_empty r1_in_E1star<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> v'_in_Vv VIsViewOnE t'_Cv_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv2_minus_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv propSepViews 
              <span class=keyword1><span class=command>have</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> v'_in_Vv2_minus_E1 
              <span class=keyword1><span class=command>have</span></span> v'_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> validV1 
              <span class=keyword1><span class=command>have</span></span> v'_notin_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def V_valid_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

               <span class=comment1>(* split t2 w.r.t. 𝒱' *)</span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> Cons<span class=main>(</span>5<span class=main>)</span> Cons<span class=main>(</span>9<span class=main>)</span> v'_in_E2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r2</span></span> <span class=skolem><span class=skolem>s2</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t2_is_r2_v'_s2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>=</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r2_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r2_Vv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=comment1>(* properties of r2 s2 *)</span>
              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>5<span class=main>)</span> t2_is_r2_v'_s2 <span class=keyword1><span class=command>have</span></span> r2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> r2_in_Nv2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>note</span></span> r2_in_E2star
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r2_Vv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                    disjoint_eq_subset_Compl 
                    list_subset_iff_projection_neutral projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r2_Cv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                    disjoint_eq_subset_Compl 
                    list_subset_iff_projection_neutral projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> validV2
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Nv2_inter_E1_empty <span class=keyword1><span class=command>have</span></span> r2E1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>               
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute empty_subsetI 
                  projection_on_subset2 r2_Vv2_empty<span class=main>)</span>
             
              <span class=comment1>(* apply inductive hypothesis to lambda' t1 r2 *)</span>
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
              
              <span class=keyword1><span class=command>from</span></span> v'_in_E2 Cons<span class=main>(</span>2<span class=main>)</span> r2_in_Nv2star validV2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> composeES_def isViewOn_def V_valid_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons<span class=main>(</span>4<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>5<span class=main>)</span> t2_is_r2_v'_s2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>t1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> Cons<span class=main>(</span>6<span class=main>)</span> Cons<span class=main>(</span>3<span class=main>)</span> t2_is_r2_v'_s2 v'_notin_E1 r2_in_Nv2star 
                    Nv2_inter_E1_empty r2E1_empty
                    <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t2_is_r2_v'_s2 list_subset_iff_projection_neutral 
                        projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>              
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Cons_eq_appendI append_eq_appendI calculation<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> eq_Nil_appendI 
                  list_subset_iff_projection_neutral Cons.prems<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> Cons.prems<span class=main><span class=main>(</span></span>6<span class=main><span class=main>)</span></span> 
                  projection_concatenation_commute t2_is_r2_v'_s2<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>8<span class=main>)</span> v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>         
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>9<span class=main>)</span> t2_is_r2_v'_s2 r2_Vv_empty v'_in_E2 v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons<span class=main>(</span>10<span class=main>)</span> s2_Cv2_empty
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>t1</span></span> <span class=quoted><span class=skolem>s2</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> tau_t'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>

              <span class=comment1>(* conclude that ?t is a suitable choice *)</span>      
              <span class=keyword1><span class=command>note</span></span> tau_t'_in_Tr
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r2_Vv_empty t'_Vv_is_lambda' v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>                 
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_on_subset2 r2_Cv2_empty r2_in_E2star<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> v'_in_Vv VIsViewOnE t'_Cv_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
          <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

 <span class=comment1>(* Generalized zipping lemma for case two of lemma 6.4.4 *)</span>
<span class=keyword1 id=GeneralizedZippingLemma-generalized_zipping_lemma2><span class=command>lemma</span></span> generalized_zipping_lemma2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span><span class=main>;</span> total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span> BSIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> <span class=main>⟹</span> 
  <span class=main>∀</span> <span class=bound>τ</span> <span class=bound>lambda</span> <span class=bound>t1</span> <span class=bound>t2</span><span class=main>.</span> <span class=main>(</span> <span class=main>(</span> set <span class=bound>τ</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> set <span class=bound>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
  <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
  <span class=main>∧</span> <span class=main>(</span><span class=bound>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>
  <span class=main>∧</span> <span class=main>(</span><span class=bound>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> 
  <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>@</span> <span class=bound>t</span><span class=main>)</span> <span class=main>∈</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=bound>lambda</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span> <span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> Nv1_inter_E2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> total_ES1_Cv1_inter_Nv2<span class=main>:</span> <span class=quoted><span class=quoted>"total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> BSIA<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span> <span class=skolem>lambda</span> <span class=skolem>t1</span> <span class=skolem>t2</span>
    <span class=keyword3><span class=command>assume</span></span> τ_in_Estar<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>τ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> lambda_in_Vvstar<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> τ_E1_t1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> τ_E2_t2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> lambda_E1_is_t1_Vv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> lambda_E2_is_t2_Vv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t1_no_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t2_no_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>

      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> set <span class=skolem>τ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>;</span> set <span class=skolem>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>;</span> 
        set <span class=skolem>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> set <span class=skolem>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span> <span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> <span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>⟧</span>  
      <span class=main>⟹</span> <span class=main>(</span><span class=main>∃</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=bound>t</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>lambda</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>lambda</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>τ</span></span> <span class=quoted><span class=skolem>t1</span></span> <span class=quoted><span class=skolem>t2</span></span><span class=main>)</span>
        <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Nil <span class=skolem>τ</span> <span class=skolem>t1</span> <span class=skolem>t2</span><span class=main>)</span>
        
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=main>[]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Nil<span class=main>(</span>5<span class=main>)</span> validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def 
                    prefixclosed_def prefix_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> Nil<span class=main>(</span>6<span class=main>)</span> validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                    prefixclosed_def prefix_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>note</span></span> Nil<span class=main>(</span>1<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>next</span></span>
        <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>𝒱'</span> <span class=skolem>lambda'</span> <span class=skolem>τ</span> <span class=skolem>t1</span> <span class=skolem>t2</span><span class=main>)</span> 
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> v'_in_Vv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∨</span> <span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∨</span> <span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
              <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
              <span class=keyword1><span class=command>using</span></span> Vv_is_Vv1_union_Vv2 v'_in_Vv <span class=keyword1><span class=command>by</span></span> <span class=operator>fastforce</span>
            <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv1_inter_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> v'_in_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv propSepViews
              <span class=keyword1><span class=command>have</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=comment1>(* split t2 w.r.t. 𝒱' *)</span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>,</span>5<span class=main>,</span>9<span class=main>)</span> v'_in_E2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r2</span></span> <span class=skolem><span class=skolem>s2</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t2_is_r2_v'_s2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>=</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r2_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r2_Vv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=comment1>(* properties of r2 s2 *)</span>
              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>5<span class=main>)</span> t2_is_r2_v'_s2 <span class=keyword1><span class=command>have</span></span> r2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> s2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>s2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>7<span class=main>)</span> t2_is_r2_v'_s2 
              <span class=keyword1><span class=command>have</span></span> τE2_r2_v'_s2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>

              <span class=keyword1><span class=command>have</span></span> r2_in_Nv2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> r2_in_E2star
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r2_Vv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r2_Cv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> validV2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              
              <span class=keyword1><span class=command>have</span></span> r2E1_in_Nv2_inter_C1_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> set <span class=skolem>r2</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> r2_in_Nv2star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> 
                  <span class=keyword1><span class=command>from</span></span> validV1 propSepViews 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def isViewOn_def V_valid_def 
                    <span class=keyword1><span class=command>using</span></span> disjoint_Nv2_Vv1 <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
 
              <span class=keyword1><span class=command>note</span></span> outerCons_prems <span class=main>=</span> Cons.prems

              <span class=comment1>(* repair t1 by inserting r2 ↿ E<span class=hidden>⇘</span><sub>ES1</sub><span class=hidden>⇙</span> *)</span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> 
                <span class=main>∃</span> <span class=bound>t1'</span><span class=main>.</span> <span class=main>(</span> set <span class=bound>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>r2</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
                <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>     
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_self_conv outerCons_prems<span class=main><span class=main>(</span></span>9<span class=main><span class=main>)</span></span> 
                    outerCons_prems<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> outerCons_prems<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
              <span class=keyword1><span class=command>next</span></span>
                <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> xs_is_xsE1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>                      
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute snoc.prems<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>with</span></span> xs_is_xsE1 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> snoc.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>xs</span></span><span class=main>]</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1''</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> t1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> τ_xs_E1_t1''_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t1''Vv1_is_t1Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                              
                <span class=keyword1><span class=command>have</span></span> x_in_Cv1_inter_Nv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>hence</span></span> x_in_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> τ_xs_E1_t1''_in_Tr1 t1''Cv1_empty
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>x</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> τ_xs_E1_t1''_in_Tr1 validES1 
                    <span class=keyword1><span class=command>have</span></span> τ_xsE1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def 
                        prefixclosed_def prefix_def<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> x_in_Cv1_inter_Nv2 total_ES1_Cv1_inter_Nv2 
                    <span class=keyword1><span class=command>have</span></span> τ_xsE1_x_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
                    <span class=keyword1><span class=command>moreover</span></span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
                    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> BSIA
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1'</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> res1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> BSIA_def<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> res1 validES1 
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> res1 xs_is_xsE1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span>  <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> snoc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t1''Vv1_is_t1Vv1 res2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> res3
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> r2E1_in_Nv2_inter_C1_star<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> t1'_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> τr2E1_t1'_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t1'_Vv1_is_t1_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t1'_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=comment1>(* split t1' w.r.t. 𝒱' *)</span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> Cons<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span><span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> 
                  propSepViews
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> 
                    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> Cons<span class=main>(</span>8<span class=main>)</span> t1'_Vv1_is_t1_Vv1 v'_in_E1 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r1'</span></span> <span class=skolem><span class=skolem>s1'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> t1'_is_r1'_v'_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>=</span> <span class=skolem>r1'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r1'_Vv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=comment1>(* properties of r1' s1' *)</span>
              <span class=keyword1><span class=command>from</span></span> t1'_is_r1'_v'_s1' t1'_Cv1_empty 
              <span class=keyword1><span class=command>have</span></span> r1'_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
              
              <span class=keyword1><span class=command>from</span></span> t1'_is_r1'_v'_s1' t1'_Cv1_empty 
              <span class=keyword1><span class=command>have</span></span> s1'_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              
              <span class=keyword1><span class=command>from</span></span> t1'_in_E1star t1'_is_r1'_v'_s1' 
              <span class=keyword1><span class=command>have</span></span> r1'_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> propSepViews r1'_Vv1_empty 
              <span class=keyword1><span class=command>have</span></span> r1'_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_on_subset2 subset_iff_psubset_eq<span class=main>)</span>

              <span class=keyword1><span class=command>have</span></span> r1'_in_Nv1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
                  <span class=keyword1><span class=command>note</span></span> r1'_in_E1star
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1'_Vv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1'</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1'_Cv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1'</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> validV1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Nv1_inter_E2_empty <span class=keyword1><span class=command>have</span></span> r1'E2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>               
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute empty_subsetI 
                  projection_on_subset2 r1'_Vv1_empty<span class=main>)</span>
              
              <span class=comment1>(* apply inductive hypothesis to lambda' s1' s2 *)</span>
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>r1'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
           
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>2<span class=main>)</span> r2_in_E2star r1'_in_E1star v'_in_E2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> t1'_in_E1star t1'_is_r1'_v'_s1' 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> s2_in_E2star
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> τr2E1_t1'_in_Tr1 t1'_is_r1'_v'_s1' v'_in_E1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> v'_in_E1 r1'_in_E1star 
                  <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>r1'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span>  <span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute 
                      list_subset_iff_projection_neutral projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> τr2E1_t1'_in_Tr1 t1'_is_r1'_v'_s1' v'_in_E1 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r2_in_E2star v'_in_E2 r1'E2_empty τE2_r2_v'_s2_in_Tr2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral
                  projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>2<span class=main>,</span>4<span class=main>,</span>8<span class=main>)</span>  v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>            
                <span class=keyword1><span class=command>from</span></span> t1'_is_r1'_v'_s1' r1'_Vv1_empty r1'_in_E1star v'_in_Vv1 propSepViews
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>s1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>"</span></span> 
                    <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  projection_on_subset2 
                      r1'_Vv1_empty r1'_in_E1star subset_iff_psubset_eq<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> t1'_is_r1'_v'_s1' v'_in_Vv1 Vv_is_Vv1_union_Vv2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>                    
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t1'_is_r1'_v'_s1' projection_concatenation_commute 
                      projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute  outerCons_prems<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> 
                    projection_intersection_neutral 
                    t1'_Vv1_is_t1_Vv1 t1'_in_E1star<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>,</span>5<span class=main>,</span>9<span class=main>)</span> v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 r2_Vv_empty v'_in_Vv2 Vv_is_Vv1_union_Vv2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t2_is_r2_v'_s2 projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> s1'_Cv1_empty s2_Cv2_empty Cons.hyps<span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>s1'</span></span> <span class=quoted><span class=skolem>s2</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> tau_t'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>r1'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>

              <span class=comment1>(* conclude that ?t is a suitable choice *)</span>
              <span class=keyword1><span class=command>note</span></span> tau_t'_in_Tr
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r2_Vv_empty r1'_Vv_empty t'Vv_is_lambda' v'_in_Vv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> VIsViewOnE r2_Cv2_empty t'Cv_empty r1'_Cv1_empty v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> VIsViewOnE v'_in_Vv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r2_in_E2star r2_Cv2_empty propSepViews 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def  
                  <span class=keyword1><span class=command>using</span></span> projection_on_subset2 <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r1'_in_E1star r1'_Cv1_empty propSepViews
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
                  <span class=keyword1><span class=command>using</span></span> projection_on_subset2 <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> t'Cv_empty
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv1_minus_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv propSepViews <span class=keyword1><span class=command>have</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> v'_in_Vv1_minus_E2 <span class=keyword1><span class=command>have</span></span> v'_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> v'_notin_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=comment1>(* split t1 w.r.t. v' *)</span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> Cons<span class=main>(</span>4<span class=main>)</span> Cons<span class=main>(</span>8<span class=main>)</span> v'_in_E1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r1</span></span> <span class=skolem><span class=skolem>s1</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t1_is_r1_v'_s1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>=</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r1_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r1_Vv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=comment1>(* properties of r1 s1 *)</span>
              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> 
              <span class=keyword1><span class=command>have</span></span> r1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> 
              <span class=keyword1><span class=command>have</span></span> s1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 
              <span class=keyword1><span class=command>have</span></span> r1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> r1_in_Nv1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>note</span></span> r1_in_E1star
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r1_Vv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Diff_eq  
                    Int_commute Int_empty_right disjoint_eq_subset_Compl 
                    list_subset_iff_projection_neutral projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r1_Cv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Diff_eq 
                    Int_commute Int_empty_right disjoint_eq_subset_Compl 
                    list_subset_iff_projection_neutral projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> validV1
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Nv1_inter_E2_empty <span class=keyword1><span class=command>have</span></span> r1E2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>               
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute empty_subsetI projection_on_subset2 r1_Vv1_empty<span class=main>)</span>
             
             
              <span class=comment1>(* apply inductive hypothesis to lambda' s1 t2 *)</span>
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
              
              <span class=keyword1><span class=command>from</span></span> v'_in_E1 Cons<span class=main>(</span>2<span class=main>)</span> r1_in_Nv1star validV1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> composeES_def isViewOn_def V_valid_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons<span class=main>(</span>5<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>              
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Cons_eq_appendI append_eq_appendI calculation<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> eq_Nil_appendI 
                  list_subset_iff_projection_neutral Cons.prems<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> Cons.prems<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span> 
                  projection_concatenation_commute t1_is_r1_v'_s1<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>t2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> Cons<span class=main>(</span>7<span class=main>)</span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 v'_notin_E2 r1_in_Nv1star 
                    Nv1_inter_E2_empty r1E2_empty
                    <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t1_is_r1_v'_s1 list_subset_iff_projection_neutral 
                        projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>8<span class=main>)</span> t1_is_r1_v'_s1 r1_Vv_empty v'_in_E1 v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>9<span class=main>)</span> v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>         
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> s1_Cv1_empty Cons<span class=main>(</span>11<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>s1</span></span> <span class=quoted><span class=skolem>t2</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> τr1v't'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>
              
              <span class=comment1>(* conclude that ?t is a suitable choice *)</span>
              <span class=keyword1><span class=command>note</span></span> τr1v't'_in_Tr
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r1_Vv_empty t'_Vv_is_lambda' v'_in_Vv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def                
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  projection_on_subset2 r1_Cv1_empty r1_in_E1star<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> v'_in_Vv VIsViewOnE t'_Cv_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>              
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv2_minus_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv propSepViews 
              <span class=keyword1><span class=command>have</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> v'_in_Vv2_minus_E1 
              <span class=keyword1><span class=command>have</span></span> v'_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> validV1 
              <span class=keyword1><span class=command>have</span></span> v'_notin_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def 
                  VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=comment1>(* split t2 w.r.t. 𝒱' *)</span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> Cons<span class=main>(</span>5<span class=main>)</span> Cons<span class=main>(</span>9<span class=main>)</span> v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r2</span></span> <span class=skolem><span class=skolem>s2</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t2_is_r2_v'_s2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>=</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r2_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r2_Vv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=comment1>(* properties of r2 s2 *)</span>
              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>5<span class=main>)</span> t2_is_r2_v'_s2 <span class=keyword1><span class=command>have</span></span> r2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> r2_in_Nv2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>note</span></span> r2_in_E2star
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r2_Vv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                    disjoint_eq_subset_Compl list_subset_iff_projection_neutral projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r2_Cv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                    disjoint_eq_subset_Compl list_subset_iff_projection_neutral projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> validV2
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              
              <span class=keyword1><span class=command>have</span></span> r2E1_in_Nv2_inter_C1_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> set <span class=skolem>r2</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> r2_in_Nv2star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>from</span></span> validV1 propSepViews disjoint_Nv2_Vv1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def 
                    VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>

              <span class=keyword1><span class=command>note</span></span> outerCons_prems <span class=main>=</span> Cons.prems

              <span class=comment1>(* repair t1 by inserting r2 ↿ E<span class=hidden>⇘</span><sub>ES1</sub><span class=hidden>⇙</span> *)</span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> 
                <span class=main>∃</span> <span class=bound>t1'</span><span class=main>.</span> <span class=main>(</span> set <span class=bound>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>r2</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
                <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_self_conv outerCons_prems<span class=main><span class=main>(</span></span>9<span class=main><span class=main>)</span></span> outerCons_prems<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> 
                    outerCons_prems<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
              <span class=keyword1><span class=command>next</span></span>
                <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> xs_is_xsE1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>                      
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute snoc.prems<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> xs_is_xsE1 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> snoc.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>xs</span></span><span class=main>]</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1''</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> t1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> τ_xs_E1_t1''_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t1''Vv1_is_t1Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                
                <span class=keyword1><span class=command>have</span></span> x_in_Cv1_inter_Nv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>hence</span></span> x_in_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> τ_xs_E1_t1''_in_Tr1 t1''Cv1_empty
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>x</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> τ_xs_E1_t1''_in_Tr1 validES1 
                  <span class=keyword1><span class=command>have</span></span> τ_xsE1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def 
                      prefixclosed_def prefix_def<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> x_in_Cv1_inter_Nv2 total_ES1_Cv1_inter_Nv2 
                  <span class=keyword1><span class=command>have</span></span> τ_xsE1_x_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> BSIA
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1'</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> res1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> BSIA_def<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> res1 validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> res1 xs_is_xsE1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword3><span class=command>thus</span></span>  <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> snoc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t1''Vv1_is_t1Vv1 res2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> res3
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> r2E1_in_Nv2_inter_C1_star<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> t1'_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> τr2E1_t1'_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t1'_Vv1_is_t1_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t1'_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=comment1>(* apply inductive hypothesis on lambda' t1' s2 *)</span>
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
              
              <span class=keyword1><span class=command>from</span></span> v'_in_E2 Cons<span class=main>(</span>2<span class=main>)</span> r2_in_Nv2star validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> composeES_def isViewOn_def V_valid_def  
                  VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>5<span class=main>)</span> t2_is_r2_v'_s2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> t1'_in_E1star
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>              
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Cons_eq_appendI append_eq_appendI calculation<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> eq_Nil_appendI 
                  list_subset_iff_projection_neutral Cons.prems<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> Cons.prems<span class=main><span class=main>(</span></span>6<span class=main><span class=main>)</span></span> 
                  projection_concatenation_commute t2_is_r2_v'_s2<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> τr2E1_t1'_in_Tr1 v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>9<span class=main>)</span> t2_is_r2_v'_s2 r2_Vv_empty v'_in_E2 v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>10<span class=main>)</span> v'_notin_E1 t1'_Vv1_is_t1_Vv1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>         
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Int_commute 
                     projection_def projection_intersection_neutral 
                    t1'_in_E1star<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def         
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Int_commute 
                     projection_def 
                    projection_intersection_neutral Cons<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> Cons<span class=main>(</span>8<span class=main>)</span> v'_notin_E1 t1'_Vv1_is_t1_Vv1
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> s2_Cv2_empty t1'_Cv1_empty
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>t1'</span></span> <span class=quoted><span class=skolem>s2</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> τr2v't'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>
              
              <span class=comment1>(* conclude that ?t is a suitable choice *)</span>
              <span class=keyword1><span class=command>note</span></span> τr2v't'_in_Tr
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r2_Vv_empty t'_Vv_is_lambda' v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>from</span></span> projection_on_subset<span class=main>[</span><span class=operator>OF</span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>›</span></span> r2_Cv2_empty<span class=main>]</span> 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> r2_in_E2star<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>with</span></span> v'_in_Vv VIsViewOnE t'_Cv_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def 
                    VN_disjoint_def NC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
          <span class=keyword1><span class=command>qed</span></span> 
        <span class=keyword1><span class=command>qed</span></span> 
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

 <span class=comment1>(* Generalized zipping lemma for case three of lemma 6.4.4 *)</span>
<span class=keyword1 id=GeneralizedZippingLemma-generalized_zipping_lemma3><span class=command>lemma</span></span> generalized_zipping_lemma3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span><span class=main>;</span> total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span> BSIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> <span class=main>⟹</span> 
  <span class=main>∀</span> <span class=bound>τ</span> <span class=bound>lambda</span> <span class=bound>t1</span> <span class=bound>t2</span><span class=main>.</span> <span class=main>(</span> <span class=main>(</span> set <span class=bound>τ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
  <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
  <span class=main>∧</span> <span class=main>(</span><span class=bound>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>
  <span class=main>∧</span> <span class=main>(</span><span class=bound>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> 
  <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>@</span> <span class=bound>t</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=bound>lambda</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span> <span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> Nv2_inter_E1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> total_ES2_Cv2_inter_Nv1<span class=main>:</span> <span class=quoted><span class=quoted>"total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> BSIA<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span> <span class=skolem>lambda</span> <span class=skolem>t1</span> <span class=skolem>t2</span>
    <span class=keyword3><span class=command>assume</span></span> τ_in_Estar<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>τ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> lambda_in_Vvstar<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> τ_E1_t1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> τ_E2_t2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> lambda_E1_is_t1_Vv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> lambda_E2_is_t2_Vv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t1_no_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> t2_no_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>

    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> set <span class=skolem>τ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      set <span class=skolem>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>;</span> 
      set <span class=skolem>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      set <span class=skolem>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>⟧</span>  
      <span class=main>⟹</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=bound>t</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>lambda</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>lambda</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>τ</span></span> <span class=quoted><span class=skolem>t1</span></span> <span class=quoted><span class=skolem>t2</span></span><span class=main>)</span>
        <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Nil <span class=skolem>τ</span> <span class=skolem>t1</span> <span class=skolem>t2</span><span class=main>)</span>
        
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=main>[]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Nil<span class=main>(</span>5<span class=main>)</span> validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def 
                    prefixclosed_def prefix_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> Nil<span class=main>(</span>6<span class=main>)</span> validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def 
                    prefixclosed_def prefix_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>note</span></span> Nil<span class=main>(</span>1<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>next</span></span>
        <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>𝒱'</span> <span class=skolem>lambda'</span> <span class=skolem>τ</span> <span class=skolem>t1</span> <span class=skolem>t2</span><span class=main>)</span> 
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> v'_in_Vv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> 
              <span class=main>∨</span> <span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
              <span class=main>∨</span> <span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
              <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def             
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Diff_iff Int_commute Int_iff Un_iff  
                 Vv_is_Vv1_union_Vv2 v'_in_Vv<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv1_inter_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> v'_in_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv  
              <span class=keyword1><span class=command>have</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
               <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=comment1>(* split t1 w.r.t. 𝒱' *)</span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>2<span class=main>,</span>4<span class=main>,</span>8<span class=main>)</span> v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r1</span></span> <span class=skolem><span class=skolem>s1</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t1_is_r1_v'_s1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>=</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r1_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r1_Vv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=comment1>(* properties of r1 s1 *)</span>
              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 
              <span class=keyword1><span class=command>have</span></span> r1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> s1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>s1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>6<span class=main>)</span> t1_is_r1_v'_s1 
              <span class=keyword1><span class=command>have</span></span> τE1_r1_v'_s1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>

              <span class=keyword1><span class=command>have</span></span> r1_in_Nv1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> r1_in_E1star
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1_Vv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1_Cv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> validV1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def 
                      VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              
              <span class=keyword1><span class=command>have</span></span> r1E2_in_Nv1_inter_C2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> set <span class=skolem>r1</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> r1_in_Nv1star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> 
                  <span class=keyword1><span class=command>from</span></span> validV2  disjoint_Nv1_Vv2 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def  V_valid_def 
                      VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
 
              <span class=keyword1><span class=command>note</span></span> outerCons_prems <span class=main>=</span> Cons.prems

              <span class=comment1>(* repair t2 by inserting r1 ↿ E<span class=hidden>⇘</span><sub>ES2</sub><span class=hidden>⇙</span> *)</span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> 
                <span class=main>∃</span> <span class=bound>t2'</span><span class=main>.</span> <span class=main>(</span> set <span class=bound>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>r1</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
                <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>     
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_self_conv outerCons_prems<span class=main><span class=main>(</span></span>10<span class=main><span class=main>)</span></span> outerCons_prems<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> 
                    outerCons_prems<span class=main><span class=main>(</span></span>6<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
              <span class=keyword1><span class=command>next</span></span>
                <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> xs_is_xsE2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>                      
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute snoc.prems<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>with</span></span> xs_is_xsE2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> snoc.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>xs</span></span><span class=main>]</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2''</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> t2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> τ_xs_E2_t2''_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t2''Vv2_is_t2Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                              
                <span class=keyword1><span class=command>have</span></span> x_in_Cv2_inter_Nv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>hence</span></span> x_in_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> τ_xs_E2_t2''_in_Tr2 t2''Cv2_empty
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>x</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> τ_xs_E2_t2''_in_Tr2 validES2
                    <span class=keyword1><span class=command>have</span></span> τ_xsE2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                        prefixclosed_def prefix_def<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> x_in_Cv2_inter_Nv1 total_ES2_Cv2_inter_Nv1 
                    <span class=keyword1><span class=command>have</span></span> τ_xsE2_x_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
                    <span class=keyword1><span class=command>moreover</span></span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
                    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> BSIA
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2'</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> res1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> BSIA_def<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> res1 validES2
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> res1 xs_is_xsE2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span>  <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> snoc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t2''Vv2_is_t2Vv2 res2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> res3
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> r1E2_in_Nv1_inter_C2_star<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> t2'_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> τr1E2_t2'_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t2'_Vv2_is_t2_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t2'_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=comment1>(* split t2' w.r.t. 𝒱' *)</span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> Cons<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span><span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> Cons<span class=main>(</span>9<span class=main>)</span> t2'_Vv2_is_t2_Vv2 v'_in_E2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r2'</span></span> <span class=skolem><span class=skolem>s2'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> t2'_is_r2'_v'_s2'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>=</span> <span class=skolem>r2'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r2'_Vv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=comment1>(* properties of r2' s2' *)</span>
              <span class=keyword1><span class=command>from</span></span> t2'_is_r2'_v'_s2' t2'_Cv2_empty 
              <span class=keyword1><span class=command>have</span></span> r2'_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
              
              <span class=keyword1><span class=command>from</span></span> t2'_is_r2'_v'_s2' t2'_Cv2_empty 
              <span class=keyword1><span class=command>have</span></span> s2'_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              
              <span class=keyword1><span class=command>from</span></span> t2'_in_E2star t2'_is_r2'_v'_s2' 
              <span class=keyword1><span class=command>have</span></span> r2'_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span>  r2'_Vv2_empty 
              <span class=keyword1><span class=command>have</span></span> r2'_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_on_subset2 subset_iff_psubset_eq<span class=main>)</span>

              <span class=keyword1><span class=command>have</span></span> r2'_in_Nv2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
                  <span class=keyword1><span class=command>note</span></span> r2'_in_E2star
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r2'_Vv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2'</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r2'_Cv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2'</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> validV2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def 
                      VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Nv2_inter_E1_empty <span class=keyword1><span class=command>have</span></span> r2'E1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>               
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute empty_subsetI projection_on_subset2 r2'_Vv2_empty<span class=main>)</span>
              
              <span class=comment1>(* apply inductive hypothesis to lambda' s1 s2' *)</span>
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>r2'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
           
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>2<span class=main>)</span> r1_in_E1star r2'_in_E2star v'_in_E1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> s1_in_E1star
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> t2'_in_E2star t2'_is_r2'_v'_s2' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r1_in_E1star v'_in_E1 r2'E1_empty τE1_r1_v'_s1_in_Tr1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral 
                  projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> τr1E2_t2'_in_Tr2 t2'_is_r2'_v'_s2' v'_in_E2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> v'_in_E2 r2'_in_E2star 
                  <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>r2'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span>  <span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute 
                      list_subset_iff_projection_neutral projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> τr1E2_t2'_in_Tr2 t2'_is_r2'_v'_s2' v'_in_E2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>,</span>4<span class=main>,</span>8<span class=main>)</span> v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 r1_Vv_empty v'_in_Vv1 Vv_is_Vv1_union_Vv2
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t1_is_r1_v'_s1 projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>,</span>5<span class=main>,</span>9<span class=main>)</span>  v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>            
                <span class=keyword1><span class=command>from</span></span> t2'_is_r2'_v'_s2' r2'_Vv2_empty r2'_in_E2star v'_in_Vv2 propSepViews
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>s2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_on_subset2 
                      r2'_Vv2_empty r2'_in_E2star subset_iff_psubset_eq<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> t2'_is_r2'_v'_s2' v'_in_Vv2 Vv_is_Vv1_union_Vv2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>                    
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t2'_is_r2'_v'_s2' projection_concatenation_commute 
                      projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute  outerCons_prems<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> 
                    projection_intersection_neutral 
                    t2'_Vv2_is_t2_Vv2 t2'_in_E2star<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> s1_Cv1_empty s2'_Cv2_empty Cons.hyps<span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>s1</span></span> <span class=quoted><span class=skolem>s2'</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> tau_t'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>r2'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>

              <span class=comment1>(* conclude that ?t is a suitable choice *)</span>
              <span class=keyword1><span class=command>note</span></span> tau_t'_in_Tr
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r1_Vv_empty r2'_Vv_empty t'Vv_is_lambda' v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> VIsViewOnE r1_Cv1_empty t'Cv_empty r2'_Cv2_empty v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> VIsViewOnE v'_in_Vv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def V_valid_def VC_disjoint_def 
                    VN_disjoint_def NC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r1_in_E1star r1_Cv1_empty  
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews projection_on_subset2 <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def     
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r2'_in_E2star r2'_Cv2_empty 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews projection_on_subset2 <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def     
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> t'Cv_empty
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv1_minus_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv  <span class=keyword1><span class=command>have</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> v'_in_Vv1_minus_E2 <span class=keyword1><span class=command>have</span></span> v'_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> v'_notin_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
                  VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=comment1>(* split t1 w.r.t. 𝒱' *)</span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> Cons<span class=main>(</span>4<span class=main>)</span> Cons<span class=main>(</span>8<span class=main>)</span> v'_in_E1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r1</span></span> <span class=skolem><span class=skolem>s1</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t1_is_r1_v'_s1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>=</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r1_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r1_Vv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=comment1>(* properties of r1 s1 *)</span>
              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 <span class=keyword1><span class=command>have</span></span> r1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> r1_in_Nv1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>note</span></span> r1_in_E1star
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r1_Vv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Diff_eq 
                    Int_commute Int_empty_right disjoint_eq_subset_Compl 
                    list_subset_iff_projection_neutral projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r1_Cv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Diff_eq Int_commute Int_empty_right 
                    disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                    projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> validV1
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def V_valid_def VC_disjoint_def 
                    VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              
              <span class=keyword1><span class=command>have</span></span> r1E2_in_Nv1_inter_C2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> set <span class=skolem>r1</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> r1_in_Nv1star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>from</span></span> validV2  disjoint_Nv1_Vv2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
                    VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>

              <span class=keyword1><span class=command>note</span></span> outerCons_prems <span class=main>=</span> Cons.prems
              
              <span class=comment1>(* repair t2 by inserting r1↿ E<span class=hidden>⇘</span><sub>ES2</sub><span class=hidden>⇙</span> *)</span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> 
                <span class=main>∃</span> <span class=bound>t2'</span><span class=main>.</span> <span class=main>(</span> set <span class=bound>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>r1</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
                <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_self_conv outerCons_prems<span class=main><span class=main>(</span></span>10<span class=main><span class=main>)</span></span> outerCons_prems<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> 
                    outerCons_prems<span class=main><span class=main>(</span></span>6<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
              <span class=keyword1><span class=command>next</span></span>
                <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> xs_is_xsE2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>                      
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute snoc.prems<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> xs_is_xsE2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> snoc.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>xs</span></span><span class=main>]</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2''</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> t2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> τ_xs_E2_t2''_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t2''Vv2_is_t2Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                
                <span class=keyword1><span class=command>have</span></span> x_in_Cv2_inter_Nv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>hence</span></span> x_in_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> τ_xs_E2_t2''_in_Tr2 t2''Cv2_empty
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>x</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> τ_xs_E2_t2''_in_Tr2 validES2 
                  <span class=keyword1><span class=command>have</span></span> τ_xsE2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                      prefixclosed_def prefix_def<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> x_in_Cv2_inter_Nv1 total_ES2_Cv2_inter_Nv1 
                  <span class=keyword1><span class=command>have</span></span> τ_xsE2_x_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> BSIA
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2'</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> res1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> BSIA_def<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> res1 validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> res1 xs_is_xsE2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword3><span class=command>thus</span></span>  <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> snoc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t2''Vv2_is_t2Vv2 res2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> res3
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> r1E2_in_Nv1_inter_C2_star<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> t2'_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> τr1E2_t2'_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t2'_Vv2_is_t2_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t2'_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=comment1>(* apply inductive hypothesis to lambda' s1 t2 *)</span>
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
              
              <span class=keyword1><span class=command>from</span></span> v'_in_E1 Cons<span class=main>(</span>2<span class=main>)</span> r1_in_Nv1star validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> composeES_def isViewOn_def V_valid_def
                  VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> t2'_in_E2star
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>              
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Cons_eq_appendI append_eq_appendI calculation<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> eq_Nil_appendI 
                  list_subset_iff_projection_neutral Cons.prems<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> Cons.prems<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span> 
                  projection_concatenation_commute t1_is_r1_v'_s1<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> τr1E2_t2'_in_Tr2 v'_notin_E2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>8<span class=main>)</span> t1_is_r1_v'_s1 r1_Vv_empty v'_in_E1 v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>11<span class=main>)</span> v'_notin_E2 t2'_Vv2_is_t2_Vv2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>         
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>  
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Int_commute 
                     projection_def projection_intersection_neutral 
                    t2'_in_E2star<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>          
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Int_commute 
                     projection_def 
                    projection_intersection_neutral Cons<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> Cons<span class=main>(</span>9<span class=main>)</span> v'_notin_E2 t2'_Vv2_is_t2_Vv2
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> s1_Cv1_empty t2'_Cv2_empty
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>s1</span></span> <span class=quoted><span class=skolem>t2'</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> tau_t'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>
              
              <span class=comment1>(* conclude that ?t is a suitable choice *)</span>
              <span class=keyword1><span class=command>note</span></span> tau_t'_in_Tr
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r1_Vv_empty t'_Vv_is_lambda' v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>from</span></span> projection_on_subset<span class=main>[</span><span class=operator>OF</span> <span class=quoted><span class=quoted>‹E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>›</span></span> r1_Cv1_empty<span class=main>]</span> 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> r1_in_E1star<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>with</span></span> v'_in_Vv VIsViewOnE t'_Cv_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def V_valid_def  VC_disjoint_def 
                    VN_disjoint_def NC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>              
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv2_minus_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv  <span class=keyword1><span class=command>have</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def            
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> v'_in_Vv2_minus_E1 <span class=keyword1><span class=command>have</span></span> v'_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> v'_notin_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                  VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

               <span class=comment1>(* split t2 w.r.t. 𝒱' *)</span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> Cons<span class=main>(</span>5<span class=main>)</span> Cons<span class=main>(</span>9<span class=main>)</span> v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r2</span></span> <span class=skolem><span class=skolem>s2</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t2_is_r2_v'_s2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>=</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r2_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r2_Vv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=comment1>(* properties of r2 s2 *)</span>
              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>5<span class=main>)</span> t2_is_r2_v'_s2 <span class=keyword1><span class=command>have</span></span> r2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> r2_in_Nv2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>note</span></span> r2_in_E2star
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r2_Vv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                    disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                    projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r2_Cv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                    disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                    projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> validV2
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
                    VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Nv2_inter_E1_empty <span class=keyword1><span class=command>have</span></span> r2E1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>               
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute empty_subsetI projection_on_subset2 r2_Vv2_empty<span class=main>)</span>
             
              <span class=comment1>(* apply inductive hypothesis to lambda' t1 r2 *)</span>
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
              
              <span class=keyword1><span class=command>from</span></span> v'_in_E2 Cons<span class=main>(</span>2<span class=main>)</span> r2_in_Nv2star validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> composeES_def isViewOn_def V_valid_def
                  VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons<span class=main>(</span>4<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>5<span class=main>)</span> t2_is_r2_v'_s2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>t1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> Cons<span class=main>(</span>6<span class=main>)</span> Cons<span class=main>(</span>3<span class=main>)</span> t2_is_r2_v'_s2 v'_notin_E1 
                    r2_in_Nv2star Nv2_inter_E1_empty r2E1_empty
                    <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t2_is_r2_v'_s2 list_subset_iff_projection_neutral 
                        projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>              
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Cons_eq_appendI append_eq_appendI calculation<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> eq_Nil_appendI 
                  list_subset_iff_projection_neutral Cons.prems<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> Cons.prems<span class=main><span class=main>(</span></span>6<span class=main><span class=main>)</span></span> 
                  projection_concatenation_commute t2_is_r2_v'_s2<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>8<span class=main>)</span> v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>         
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>9<span class=main>)</span> t2_is_r2_v'_s2 r2_Vv_empty v'_in_E2 v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons<span class=main>(</span>10<span class=main>)</span> s2_Cv2_empty
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>t1</span></span> <span class=quoted><span class=skolem>s2</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> tau_t'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>

              <span class=comment1>(* conclude that ?t is a suitable choice *)</span>      
              <span class=keyword1><span class=command>note</span></span> tau_t'_in_Tr
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r2_Vv_empty t'_Vv_is_lambda' v'_in_Vv 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>  
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  projection_on_subset2 
                    r2_Cv2_empty r2_in_E2star<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> v'_in_Vv VIsViewOnE t'_Cv_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
          <span class=keyword1><span class=command>qed</span></span> 
        <span class=keyword1><span class=command>qed</span></span> 
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Generalized zipping lemma for case four of lemma 6.4.4 *)</span>
<span class=keyword1 id=GeneralizedZippingLemma-generalized_zipping_lemma4><span class=command>lemma</span></span> generalized_zipping_lemma4<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>  ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  BSIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span> total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span>
  FCIA <span class=free>ρ1</span> <span class=free>Γ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> FCIA <span class=free>ρ2</span> <span class=free>Γ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>;</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span><span class=main>;</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>⟧</span> <span class=main>⟹</span>
  <span class=main>∀</span> <span class=bound>τ</span> <span class=bound>lambda</span> <span class=bound>t1</span> <span class=bound>t2</span><span class=main>.</span> <span class=main>(</span> <span class=main>(</span> set <span class=bound>τ</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> set <span class=bound>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>  <span class=main>∧</span> set <span class=bound>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>
  <span class=main>∧</span> set <span class=bound>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
  <span class=main>∧</span> <span class=main>(</span><span class=bound>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>
  <span class=main>∧</span> <span class=main>(</span><span class=bound>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> 
  <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>@</span> <span class=bound>t</span><span class=main>)</span> <span class=main>∈</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=bound>lambda</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span> <span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> Nabla1_subsetof_E1<span class=main>:</span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword2><span class=keyword>and</span></span> Delta1_subsetof_E1<span class=main>:</span> <span class=quoted><span class=quoted>"Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword2><span class=keyword>and</span></span> Upsilon1_subsetof_E1<span class=main>:</span> <span class=quoted><span class=quoted>"Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> Nabla2_subsetof_E2<span class=main>:</span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword2><span class=keyword>and</span></span> Delta2_subsetof_E2<span class=main>:</span> <span class=quoted><span class=quoted>"Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword2><span class=keyword>and</span></span> Upsilon2_subsetof_E2<span class=main>:</span> <span class=quoted><span class=quoted>"Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> BSIA1<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword2><span class=keyword>and</span></span> BSIA2<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> ES1_total_Cv1_inter_Nv2<span class=main>:</span> <span class=quoted><span class=quoted>"total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
  <span class=keyword2><span class=keyword>and</span></span> ES2_total_Cv2_inter_Nv1<span class=main>:</span> <span class=quoted><span class=quoted>"total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> FCIA1<span class=main>:</span> <span class=quoted><span class=quoted>"FCIA <span class=free>ρ1</span> <span class=free>Γ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword2><span class=keyword>and</span></span> FCIA2<span class=main>:</span> <span class=quoted><span class=quoted>"FCIA <span class=free>ρ2</span> <span class=free>Γ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> Vv1_inter_Vv2_subsetof_Nabla1_union_Nabla2<span class=main>:</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> Cv1_inter_Nv2_subsetof_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span> 
  <span class=keyword2><span class=keyword>and</span></span> Cv2_inter_Nv1_subsetof_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> disjoint_Nv1_inter_Delta1_inter_E2<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span> 
  <span class=keyword2><span class=keyword>and</span></span> disjoint_Nv2_inter_Delta2_inter_E1<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
  
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ</span> <span class=skolem>lambda</span> <span class=skolem>t1</span> <span class=skolem>t2</span>

    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> set <span class=skolem>τ</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span>
      set <span class=skolem>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>;</span> 
      set <span class=skolem>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      set <span class=skolem>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span>
      <span class=main>(</span><span class=skolem>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>⟧</span>  
      <span class=main>⟹</span> <span class=main>(</span><span class=main>∃</span> <span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=bound>t</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>lambda</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>lambda</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>τ</span></span> <span class=quoted><span class=skolem>t1</span></span> <span class=quoted><span class=skolem>t2</span></span><span class=main>)</span>
        <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Nil <span class=skolem>τ</span> <span class=skolem>t1</span> <span class=skolem>t2</span><span class=main>)</span>
        
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=main>[]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Nil<span class=main>(</span>5<span class=main>)</span> validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                    prefixclosed_def prefix_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> Nil<span class=main>(</span>6<span class=main>)</span> validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                    prefixclosed_def prefix_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>note</span></span> Nil<span class=main>(</span>1<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[]</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>[]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>next</span></span>
        <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>𝒱'</span> <span class=skolem>lambda'</span> <span class=skolem>τ</span> <span class=skolem>t1</span> <span class=skolem>t2</span><span class=main>)</span> 
        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>

            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> v'_in_Vv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> 
              <span class=main>∨</span> <span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>
              <span class=main>∨</span> <span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
              <span class=main>∨</span> <span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?S</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> <span class=main>(</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>)</span> <span class=main>∪</span> <span class=main>(</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>  <span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?S</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
                  <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>note</span></span> Vv1_inter_Vv2_subsetof_Nabla1_union_Nabla2 
                  Vv_is_Vv1_union_Vv2 v'_in_Vv
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>{</span></span> 
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv1_inter_Vv2_inter_Nabla1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> v'_in_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> v'_in_Nabla2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3-4<span class=main>)</span> Cons<span class=main>(</span>8<span class=main>)</span> v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r1</span></span> <span class=skolem><span class=skolem>s1</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t1_is_r1_v'_s1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>=</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r1_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r1_Vv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 
              <span class=keyword1><span class=command>have</span></span> r1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> s1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>s1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> r1_in_Nv1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> r1_in_E1star
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1_Vv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1_Cv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> validV1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                      VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              
              <span class=keyword1><span class=command>have</span></span> r1E2_in_Nv1_inter_C2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> set <span class=skolem>r1</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> r1_in_Nv1star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> 
                  <span class=keyword1><span class=command>from</span></span> validV2  disjoint_Nv1_Vv2 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                      VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Cv2_inter_Nv1_subsetof_Upsilon2 
              <span class=keyword1><span class=command>have</span></span> r1E2_in_Nv1_inter_C2_Upsilon2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
 
              <span class=keyword1><span class=command>note</span></span> outerCons_prems <span class=main>=</span> Cons.prems

              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> 
                <span class=main>∃</span> <span class=bound>t2'</span><span class=main>.</span> <span class=main>(</span> set <span class=bound>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>r1</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
                <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>          
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_self_conv outerCons_prems<span class=main><span class=main>(</span></span>10<span class=main><span class=main>)</span></span> 
                    outerCons_prems<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> outerCons_prems<span class=main><span class=main>(</span></span>6<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
              <span class=keyword1><span class=command>next</span></span>
                <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> xs_is_xsE2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>                      
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute snoc.prems<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>with</span></span> xs_is_xsE2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> snoc.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>xs</span></span><span class=main>]</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2''</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> t2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> τ_xs_E2_t2''_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t2''Vv2_is_t2Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                              
                <span class=keyword1><span class=command>have</span></span> x_in_Cv2_inter_Nv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>hence</span></span> x_in_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> τ_xs_E2_t2''_in_Tr2 t2''Cv2_empty
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>x</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> τ_xs_E2_t2''_in_Tr2 validES2 
                    <span class=keyword1><span class=command>have</span></span> τ_xsE2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                        prefixclosed_def prefix_def<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> x_in_Cv2_inter_Nv1 ES2_total_Cv2_inter_Nv1 
                    <span class=keyword1><span class=command>have</span></span> τ_xsE2_x_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
                    <span class=keyword1><span class=command>moreover</span></span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
                    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> BSIA2
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2'</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> res1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> BSIA_def<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> res1 validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> res1 xs_is_xsE2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span>  <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> snoc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t2''Vv2_is_t2Vv2 res2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> res3
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> r1E2_in_Nv1_inter_C2_star<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> t2'_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> τr1E2_t2'_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t2'_Vv2_is_t2_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t2'_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> Cons<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span><span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span>  
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> Cons<span class=main>(</span>9<span class=main>)</span> t2'_Vv2_is_t2_Vv2 v'_in_E2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r2'</span></span> <span class=skolem><span class=skolem>s2'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> t2'_is_r2'_v'_s2'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>=</span> <span class=skolem>r2'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r2'_Vv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=keyword1><span class=command>from</span></span> t2'_is_r2'_v'_s2' t2'_Cv2_empty <span class=keyword1><span class=command>have</span></span> r2'_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
              
              <span class=keyword1><span class=command>from</span></span> t2'_is_r2'_v'_s2' t2'_Cv2_empty <span class=keyword1><span class=command>have</span></span> s2'_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              
              <span class=keyword1><span class=command>from</span></span> t2'_in_E2star t2'_is_r2'_v'_s2' <span class=keyword1><span class=command>have</span></span> r2'_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=keyword1><span class=command>have</span></span> r2'_in_Nv2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> r2'_in_E2star
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r2'_Vv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2'</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r2'_Cv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2'</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> validV2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                      VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
            
              <span class=keyword1><span class=command>have</span></span> r2'E1_in_Nv2_inter_C1_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> set <span class=skolem>r2'</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> r2'_in_Nv2star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> 
                  <span class=keyword1><span class=command>from</span></span> validV1  disjoint_Nv2_Vv1 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                      VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Cv1_inter_Nv2_subsetof_Upsilon1 
              <span class=keyword1><span class=command>have</span></span> r2'E1_in_Nv2_inter_Cv1_Upsilon1_star<span class=main>:</span> 
                <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            

              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span>
                <span class=main>∃</span> <span class=bound>s1'</span> <span class=bound>q1'</span><span class=main>.</span> <span class=main>(</span>
                set <span class=bound>s1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>q1'</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=bound>q1'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=bound>s1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>
                <span class=main>∧</span> <span class=bound>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>
                <span class=main>∧</span> <span class=bound>s1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>
                <span class=main>∧</span> <span class=bound>s1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>              
              <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>r2'</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
                <span class=keyword3><span class=command>case</span></span> Nil

                <span class=keyword1><span class=command>note</span></span> s1_in_E1star
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> outerCons_prems<span class=main>(</span>5<span class=main>)</span> t1_is_r1_v'_s1 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> Nil <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span><span class=keyword1><span class=command>..</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> s1_Cv1_empty
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                
              <span class=keyword1><span class=command>next</span></span>
                <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> xs_is_xsE1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword1><span class=command>with</span></span> xs_is_xsE1 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> snoc.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>xs</span></span><span class=main>]</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1''</span></span> <span class=skolem><span class=skolem>q1''</span></span> 
                  <span class=keyword2><span class=keyword>where</span></span> s1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>s1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> q1''_in_C1_inter_Upsilon1_inter_Delta1<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>q1''</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> τE1_r1_q1''_v'_s1''_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>q1''</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> q1''C1_Upsilon1_is_xsE1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> s1''V1_is_s1V1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> 
                  <span class=keyword2><span class=keyword>and</span></span> s1''C1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                
                <span class=keyword1><span class=command>have</span></span> x_in_Cv1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span> 
                  <span class=keyword2><span class=keyword>and</span></span> x_in_Cv1_inter_Nv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span> 
                      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> x_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

                <span class=keyword1><span class=command>note</span></span> x_in_Cv1_inter_Upsilon1
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> v'_in_Vv1_inter_Vv2_inter_Nabla1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> τE1_r1_q1''_v'_s1''_in_Tr1 s1''C1_empty
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>q1''</span><span class=main>)</span> <span class=skolem>x</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> τE1_r1_q1''_v'_s1''_in_Tr1 validES1 
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>q1''</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                        prefixclosed_def prefix_def<span class=main>)</span>                   
                    <span class=keyword1><span class=command>with</span></span> x_in_Cv1_inter_Nv2 ES1_total_Cv1_inter_Nv2 
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>q1''</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
                    <span class=keyword1><span class=command>moreover</span></span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>q1''</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>q1''</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
                    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Adm_def<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>note</span></span> FCIA1  
                <span class=keyword1><span class=command>ultimately</span></span>
                <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1'</span></span> <span class=skolem><span class=skolem>γ'</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> res1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>γ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>q1''</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>s1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>s1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res4<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> FCIA_def
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                 
                <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?q1'</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>q1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ'</span>"</span></span>

                <span class=keyword1><span class=command>from</span></span> res2 validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> res1 x_in_Cv1_inter_Upsilon1 q1''_in_C1_inter_Upsilon1_inter_Delta1 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?q1'</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> res2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=var>?q1'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> validV1 res1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                        <span class=keyword1><span class=command>from</span></span> res1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ'</span> <span class=main>=</span> <span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                        <span class=keyword1><span class=command>moreover</span></span>
                        <span class=keyword1><span class=command>from</span></span> validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                            VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                      <span class=keyword1><span class=command>qed</span></span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=var>?q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>q1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> q1''C1_Upsilon1_is_xsE1 x_in_Cv1_inter_Upsilon1 
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> xs_is_xsE1 snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> res3 s1''V1_is_s1V1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> res4
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> r2'E1_in_Nv2_inter_Cv1_Upsilon1_star<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s1'</span></span> <span class=skolem><span class=skolem>q1'</span></span> 
              <span class=keyword2><span class=keyword>where</span></span> s1'_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>s1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q1'_in_Cv1_inter_Upsilon1_union_Nv1_inter_Delta1<span class=main>:</span> 
              <span class=quoted><span class=quoted>"set <span class=skolem>q1'</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span> 
              <span class=keyword2><span class=keyword>and</span></span> τE1_r1_q1'_v'_s1'_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>q1'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q1'Cv1_inter_Upsilon1_is_r2'E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> s1'Vv1_is_s1_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> s1'Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

            <span class=keyword1><span class=command>from</span></span> q1'_in_Cv1_inter_Upsilon1_union_Nv1_inter_Delta1 validV1 
            <span class=keyword1><span class=command>have</span></span> q1'_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>q1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def 
                VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          
            <span class=keyword1><span class=command>have</span></span> r2'Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  projection_on_subset2 
                r2'_Cv2_empty r2'_in_E2star<span class=main>)</span>  

            <span class=comment1>(* application of merge_property' *)</span>
            <span class=keyword1><span class=command>from</span></span> validES1 τE1_r1_q1'_v'_s1'_in_Tr1 
            <span class=keyword1><span class=command>have</span></span> q1'_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>q1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>note</span></span> r2'_in_E2star
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> q1'E2_is_r2'E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> q1'_in_Cv1_inter_Upsilon1_union_Nv1_inter_Delta1 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>q1'</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span><span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_Un_distrib2 disjoint_Nv1_inter_Delta1_inter_E2<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> q1'Cv1_inter_Upsilon1_is_r2'E1 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def conj_commute<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> r2'_in_E2star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>  
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> q1'_in_Cv1_inter_Upsilon1_union_Nv1_inter_Delta1 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> q1'_in_E1star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span><span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>              
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_Un_distrib2<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Int_assoc Int_commute Int_left_commute Un_commute<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def 
                    VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span> 
              <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute  projection_intersection_neutral 
                r2'_Vv2_empty r2'_in_E2star<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> q1'Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> q1'_in_E1star <span class=keyword1><span class=command>have</span></span> foo<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute list_subset_iff_projection_neutral projection_intersection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>⊆</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>from</span></span> projection_subset_elim<span class=main>[</span><span class=operator>OF</span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>⊆</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>›</span></span><span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=skolem>q1'</span></span><span class=main>]</span> 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_commute<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> foo <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> q1'_in_Cv1_inter_Upsilon1_union_Nv1_inter_Delta1 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
                    <span class=main>=</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>fast</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
                     <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> validV1 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>
                  <span class=main>=</span> <span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def Int_commute<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> q1'Cv1_inter_Upsilon1_is_r2'E1 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>r2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>with</span></span> projection_on_intersection<span class=main>[</span><span class=operator>OF</span> r2'Cv_empty<span class=main>]</span> 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q1'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>           
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>note</span></span> r2'Cv_empty merge_property'<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>q1'</span></span> <span class=quoted><span class=skolem>r2'</span></span><span class=main>]</span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>q'</span></span>
              <span class=keyword2><span class=keyword>where</span></span> q'E1_is_q1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q1'</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q'E2_is_r2'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>r2'</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q'V_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q'C_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q'_in_E1_union_E2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>q'</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>unfolding</span></span> Let_def
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            
            <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>q'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
           
            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>2<span class=main>)</span> r1_in_E1star q'_in_E1_union_E2_star v'_in_E1 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>note</span></span> s1'_in_E1star
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> t2'_in_E2star t2'_is_r2'_v'_s2' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> q'E1_is_q1' r1_in_E1star v'_in_E1 q1'_in_E1star τE1_r1_q1'_v'_s1'_in_Tr1 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral 
                projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> τr1E2_t2'_in_Tr2 t2'_is_r2'_v'_s2' v'_in_E2 q'E2_is_r2' 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3-4<span class=main>)</span> Cons<span class=main>(</span>8<span class=main>)</span> v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 r1_Vv_empty v'_in_Vv1 Vv_is_Vv1_union_Vv2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t1_is_r1_v'_s1 projection_concatenation_commute 
                    projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute  projection_intersection_neutral 
                    s1'Vv1_is_s1_Vv1 s1'_in_E1star s1_in_E1star<span class=main>)</span>    
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>,</span>5<span class=main>,</span>9<span class=main>)</span>  v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>            
                <span class=keyword1><span class=command>from</span></span> t2'_is_r2'_v'_s2' r2'_Vv2_empty r2'_in_E2star v'_in_Vv2 propSepViews
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>s2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>"</span></span>   
                      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  projection_on_subset2 r2'_Vv2_empty 
                        r2'_in_E2star subset_iff_psubset_eq<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> t2'_is_r2'_v'_s2' v'_in_Vv2 Vv_is_Vv1_union_Vv2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>                    
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t2'_is_r2'_v'_s2' 
                        projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute  outerCons_prems<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> 
                    projection_intersection_neutral t2'_Vv2_is_t2_Vv2 t2'_in_E2star<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>note</span></span> s1'Cv1_empty s2'_Cv2_empty Cons.hyps<span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>s1'</span></span> <span class=quoted><span class=skolem>s2'</span></span><span class=main>]</span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
              <span class=keyword2><span class=keyword>where</span></span> τ_r1_q'_v'_t'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> t'Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> t'Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            
            <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>@</span> <span class=skolem>q'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>

            <span class=keyword1><span class=command>note</span></span> τ_r1_q'_v'_t'_in_Tr
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> r1_Vv_empty q'V_empty t'Vv_is_lambda' v'_in_Vv 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> VIsViewOnE r1_Cv1_empty t'Cv_empty q'C_empty v'_in_Vv 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> VIsViewOnE v'_in_Vv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
                    VN_disjoint_def NC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r1_in_E1star r1_Cv1_empty  
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>     
                  <span class=keyword1><span class=command>using</span></span> propSepViews projection_on_subset2 
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> t'Cv_empty q'C_empty
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>{</span></span>         
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv1_inter_Vv2_inter_Nabla2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> v'_in_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> v'_in_Nabla2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv  propSepViews
              <span class=keyword1><span class=command>have</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>,</span>5<span class=main>,</span>9<span class=main>)</span> v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r2</span></span> <span class=skolem><span class=skolem>s2</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t2_is_r2_v'_s2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>=</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r2_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r2_Vv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>5<span class=main>)</span> t2_is_r2_v'_s2 <span class=keyword1><span class=command>have</span></span> r2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> s2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>s2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> r2_in_Nv2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> r2_in_E2star
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r2_Vv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r2_Cv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> validV2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  
                      VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              
              <span class=keyword1><span class=command>have</span></span> r2E1_in_Nv2_inter_C1_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> set <span class=skolem>r2</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> r2_in_Nv2star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> 
                  <span class=keyword1><span class=command>from</span></span> validV1  disjoint_Nv2_Vv1 propSepViews
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                      VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Cv1_inter_Nv2_subsetof_Upsilon1 
              <span class=keyword1><span class=command>have</span></span> r2E1_in_Nv2_inter_C1_Upsilon1_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
 
              <span class=keyword1><span class=command>note</span></span> outerCons_prems <span class=main>=</span> Cons.prems

              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> 
                <span class=main>∃</span> <span class=bound>t1'</span><span class=main>.</span> <span class=main>(</span> set <span class=bound>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>r2</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
                <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>     
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_self_conv outerCons_prems<span class=main><span class=main>(</span></span>9<span class=main><span class=main>)</span></span> outerCons_prems<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> 
                    outerCons_prems<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
              <span class=keyword1><span class=command>next</span></span>
                <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> xs_is_xsE1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>                      
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute snoc.prems<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>with</span></span> xs_is_xsE1 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> snoc.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>xs</span></span><span class=main>]</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1''</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> t1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> τ_xs_E1_t1''_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t1''Vv1_is_t1Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                              
                <span class=keyword1><span class=command>have</span></span> x_in_Cv1_inter_Nv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>hence</span></span> x_in_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> τ_xs_E1_t1''_in_Tr1 t1''Cv1_empty
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>x</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> τ_xs_E1_t1''_in_Tr1 validES1
                    <span class=keyword1><span class=command>have</span></span> τ_xsE1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                        prefixclosed_def prefix_def<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> x_in_Cv1_inter_Nv2 ES1_total_Cv1_inter_Nv2 
                    <span class=keyword1><span class=command>have</span></span> τ_xsE1_x_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
                    <span class=keyword1><span class=command>moreover</span></span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
                    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> BSIA1
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1'</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> res1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> BSIA_def<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> res1 validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> res1 xs_is_xsE1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span>  <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> snoc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t1''Vv1_is_t1Vv1 res2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> res3
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> r2E1_in_Nv2_inter_C1_star<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> t1'_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> τr2E1_t1'_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t1'_Vv1_is_t1_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t1'_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> Cons<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span><span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> propSepViews 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> Cons<span class=main>(</span>8<span class=main>)</span> t1'_Vv1_is_t1_Vv1 v'_in_E1 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r1'</span></span> <span class=skolem><span class=skolem>s1'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> t1'_is_r1'_v'_s1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>=</span> <span class=skolem>r1'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r1'_Vv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=keyword1><span class=command>from</span></span> t1'_is_r1'_v'_s1' t1'_Cv1_empty <span class=keyword1><span class=command>have</span></span> r1'_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
              
              <span class=keyword1><span class=command>from</span></span> t1'_is_r1'_v'_s1' t1'_Cv1_empty <span class=keyword1><span class=command>have</span></span> s1'_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              
              <span class=keyword1><span class=command>from</span></span> t1'_in_E1star t1'_is_r1'_v'_s1' <span class=keyword1><span class=command>have</span></span> r1'_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=keyword1><span class=command>have</span></span> r1'_in_Nv1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
                  <span class=keyword1><span class=command>note</span></span> r1'_in_E1star
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1'_Vv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1'</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1'_Cv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1'</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> validV1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                      VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
            
              <span class=keyword1><span class=command>have</span></span> r1'E2_in_Nv1_inter_C2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> set <span class=skolem>r1'</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> r1'_in_Nv1star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> 
                  <span class=keyword1><span class=command>from</span></span> validV2 propSepViews disjoint_Nv1_Vv2 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                      VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Cv2_inter_Nv1_subsetof_Upsilon2 
              <span class=keyword1><span class=command>have</span></span> r1'E2_in_Nv1_inter_Cv2_Upsilon2_star<span class=main>:</span> 
                <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>            

              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span>
                <span class=main>∃</span> <span class=bound>s2'</span> <span class=bound>q2'</span><span class=main>.</span> <span class=main>(</span>
                set <span class=bound>s2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>q2'</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=bound>q2'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=bound>s2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
                <span class=main>∧</span> <span class=bound>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
                <span class=main>∧</span> <span class=bound>s2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>
                <span class=main>∧</span> <span class=bound>s2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>              
              <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>r1'</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
                <span class=keyword3><span class=command>case</span></span> Nil

                <span class=keyword1><span class=command>note</span></span> s2_in_E2star
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> outerCons_prems<span class=main>(</span>6<span class=main>)</span> t2_is_r2_v'_s2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> Nil <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span><span class=keyword1><span class=command>..</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> s2_Cv2_empty
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                
              <span class=keyword1><span class=command>next</span></span>
                <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> xs_is_xsE2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword1><span class=command>with</span></span> xs_is_xsE2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> snoc.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>xs</span></span><span class=main>]</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s2''</span></span> <span class=skolem><span class=skolem>q2''</span></span> 
                  <span class=keyword2><span class=keyword>where</span></span> s2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>s2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> q2''_in_C2_inter_Upsilon2_inter_Delta2<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>q2''</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> τE2_r2_q2''_v'_s2''_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>q2''</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> q2''C2_Upsilon2_is_xsE2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> s2''V2_is_s2V2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> 
                  <span class=keyword2><span class=keyword>and</span></span> s2''C2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                
                <span class=keyword1><span class=command>have</span></span> x_in_Cv2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span> 
                  <span class=keyword2><span class=keyword>and</span></span> x_in_Cv2_inter_Nv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span> 
                      <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> x_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def V_valid_def 
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

                <span class=keyword1><span class=command>note</span></span> x_in_Cv2_inter_Upsilon2
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> v'_in_Vv1_inter_Vv2_inter_Nabla2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> τE2_r2_q2''_v'_s2''_in_Tr2 s2''C2_empty
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>q2''</span><span class=main>)</span> <span class=skolem>x</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> τE2_r2_q2''_v'_s2''_in_Tr2 validES2
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>q2''</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                        prefixclosed_def prefix_def<span class=main>)</span>                   
                    <span class=keyword1><span class=command>with</span></span> x_in_Cv2_inter_Nv1 ES2_total_Cv2_inter_Nv1 
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>q2''</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
                    <span class=keyword1><span class=command>moreover</span></span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>q2''</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>q2''</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
                    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Adm_def<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>note</span></span> FCIA2  
                <span class=keyword1><span class=command>ultimately</span></span>
                <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s2'</span></span> <span class=skolem><span class=skolem>γ'</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> res1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>set <span class=skolem>γ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>q2''</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>s2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>s2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res4<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> FCIA_def
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                 
                <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?q2'</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>q2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ'</span>"</span></span>

                <span class=keyword1><span class=command>from</span></span> res2 validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> res1 x_in_Cv2_inter_Upsilon2 q2''_in_C2_inter_Upsilon2_inter_Delta2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?q2'</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> res2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=var>?q2'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> validV2 res1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                        <span class=keyword1><span class=command>from</span></span> res1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ'</span> <span class=main>=</span> <span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>γ'</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                        <span class=keyword1><span class=command>moreover</span></span>
                        <span class=keyword1><span class=command>from</span></span> validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def V_valid_def 
                            VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                      <span class=keyword1><span class=command>qed</span></span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=var>?q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>q2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> q2''C2_Upsilon2_is_xsE2 x_in_Cv2_inter_Upsilon2 
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> xs_is_xsE2 snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> res3 s2''V2_is_s2V2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> res4
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> r1'E2_in_Nv1_inter_Cv2_Upsilon2_star<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>s2'</span></span> <span class=skolem><span class=skolem>q2'</span></span> 
              <span class=keyword2><span class=keyword>where</span></span> s2'_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>s2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q2'_in_Cv2_inter_Upsilon2_union_Nv2_inter_Delta2<span class=main>:</span> 
              <span class=quoted><span class=quoted>"set <span class=skolem>q2'</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span> 
              <span class=keyword2><span class=keyword>and</span></span> τE2_r2_q2'_v'_s2'_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>q2'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q2'Cv2_inter_Upsilon2_is_r1'E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> s2'Vv2_is_s2_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> s2'Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

            <span class=keyword1><span class=command>from</span></span> q2'_in_Cv2_inter_Upsilon2_union_Nv2_inter_Delta2 validV2 
            <span class=keyword1><span class=command>have</span></span> q2'_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>q2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
                VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          
            <span class=keyword1><span class=command>have</span></span> r1'Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  projection_on_subset2 
                r1'_Cv1_empty r1'_in_E1star<span class=main>)</span>  

            <span class=comment1>(* application of merge_property' *)</span>
            <span class=keyword1><span class=command>from</span></span> validES2 τE2_r2_q2'_v'_s2'_in_Tr2 
            <span class=keyword1><span class=command>have</span></span> q2'_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>q2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>note</span></span> r1'_in_E1star
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> q2'E1_is_r1'E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> q2'_in_Cv2_inter_Upsilon2_union_Nv2_inter_Delta2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>q2'</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span><span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_Un_distrib2 disjoint_Nv2_inter_Delta2_inter_E1<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> q2'Cv2_inter_Upsilon2_is_r1'E2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def conj_commute<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> r1'_in_E1star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>  
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> q2'_in_Cv2_inter_Upsilon2_union_Nv2_inter_Delta2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> q2'_in_E2star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> propSepViews
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span><span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>              
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_Un_distrib2<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Int_assoc 
                    Int_commute Int_left_commute Un_commute<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute  projection_intersection_neutral 
                r1'_Vv1_empty r1'_in_E1star<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> q2'Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span> 
                <span class=keyword1><span class=command>from</span></span> q2'_in_E2star <span class=keyword1><span class=command>have</span></span> foo<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute list_subset_iff_projection_neutral 
                    projection_intersection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>from</span></span> projection_subset_elim<span class=main>[</span><span class=operator>OF</span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>›</span></span><span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=skolem>q2'</span></span><span class=main>]</span> 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_commute<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> foo <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> q2'_in_Cv2_inter_Upsilon2_union_Nv2_inter_Delta2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
                    <span class=main>=</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>fast</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
                  <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> validV2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>
                  <span class=main>=</span> <span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def Int_commute<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> q2'Cv2_inter_Upsilon2_is_r1'E2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>r1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>with</span></span> projection_on_intersection<span class=main>[</span><span class=operator>OF</span> r1'Cv_empty<span class=main>]</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>q2'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>           
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>note</span></span> r1'Cv_empty merge_property'<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>r1'</span></span> <span class=quoted><span class=skolem>q2'</span></span><span class=main>]</span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>q'</span></span>
              <span class=keyword2><span class=keyword>where</span></span> q'E2_is_q2'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>q2'</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q'E1_is_r1'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>r1'</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q'V_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q'C_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>q'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> q'_in_E1_union_E2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>q'</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>unfolding</span></span> Let_def
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            
            <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>q'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
           
            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>2<span class=main>)</span> r2_in_E2star q'_in_E1_union_E2_star v'_in_E2 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> t1'_in_E1star t1'_is_r1'_v'_s1' <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>note</span></span> s2'_in_E2star
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> τr2E1_t1'_in_Tr1 t1'_is_r1'_v'_s1' v'_in_E1 q'E1_is_r1' 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> q'E2_is_q2' r2_in_E2star v'_in_E2 q2'_in_E2star τE2_r2_q2'_v'_s2'_in_Tr2 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral 
                projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>2<span class=main>,</span>4<span class=main>,</span>8<span class=main>)</span>  v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>            
                <span class=keyword1><span class=command>from</span></span> t1'_is_r1'_v'_s1' r1'_Vv1_empty r1'_in_E1star 
                  v'_in_Vv1 propSepViews
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>s1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>[]</span>"</span></span>
                      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span>  projection_on_subset2 r1'_Vv1_empty 
                        r1'_in_E1star subset_iff_psubset_eq<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> t1'_is_r1'_v'_s1' v'_in_Vv1 Vv_is_Vv1_union_Vv2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>                    
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t1'_is_r1'_v'_s1' projection_concatenation_commute 
                        projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute outerCons_prems<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> 
                    projection_intersection_neutral t1'_Vv1_is_t1_Vv1 t1'_in_E1star<span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>,</span>5<span class=main>,</span>9<span class=main>)</span> v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 r2_Vv_empty v'_in_Vv2 Vv_is_Vv1_union_Vv2 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> t2_is_r2_v'_s2 projection_concatenation_commute 
                    projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> 
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute  projection_intersection_neutral 
                    s2'Vv2_is_s2_Vv2 s2'_in_E2star s2_in_E2star<span class=main>)</span>    
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>note</span></span> s1'_Cv1_empty s2'Cv2_empty Cons.hyps<span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>s1'</span></span> <span class=quoted><span class=skolem>s2'</span></span><span class=main>]</span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
              <span class=keyword2><span class=keyword>where</span></span> τ_r2_q'_v'_t'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> t'Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> t'Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            
            <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>@</span> <span class=skolem>q'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>

            <span class=keyword1><span class=command>note</span></span> τ_r2_q'_v'_t'_in_Tr
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> r2_Vv_empty q'V_empty t'Vv_is_lambda' v'_in_Vv 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> VIsViewOnE r2_Cv2_empty t'Cv_empty q'C_empty v'_in_Vv 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> VIsViewOnE v'_in_Vv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r2_in_E2star r2_Cv2_empty 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>     
                  <span class=keyword1><span class=command>using</span></span> propSepViews projection_on_subset2 <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> t'Cv_empty q'C_empty
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>{</span></span>
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv1_minus_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv  <span class=keyword1><span class=command>have</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> v'_in_Vv1_minus_E2 <span class=keyword1><span class=command>have</span></span> v'_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> v'_notin_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                  VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3-4<span class=main>)</span> Cons<span class=main>(</span>8<span class=main>)</span> v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r1</span></span> <span class=skolem><span class=skolem>s1</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t1_is_r1_v'_s1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>=</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s1</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r1_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r1_Vv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t1_is_r1_v'_s1 Cons<span class=main>(</span>10<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s1_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 <span class=keyword1><span class=command>have</span></span> r1_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> r1_in_Nv1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> r1_in_E1star
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1_Vv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> r1_Cv1_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r1</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                      disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                      projection_on_union<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> validV1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                      VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              
              <span class=keyword1><span class=command>have</span></span> r1E2_in_Nv1_inter_C2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> set <span class=skolem>r1</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> r1_in_Nv1star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> 
                  <span class=keyword1><span class=command>from</span></span> validV2  disjoint_Nv1_Vv2 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                      VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Cv2_inter_Nv1_subsetof_Upsilon2 
              <span class=keyword1><span class=command>have</span></span> r1E2_in_Nv1_inter_C2_Upsilon2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>note</span></span> outerCons_prems <span class=main>=</span> Cons.prems

              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> 
                <span class=main>∃</span> <span class=bound>t2'</span><span class=main>.</span> <span class=main>(</span> set <span class=bound>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>r1</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
                <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>          
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_self_conv outerCons_prems<span class=main><span class=main>(</span></span>10<span class=main><span class=main>)</span></span> outerCons_prems<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> 
                    outerCons_prems<span class=main><span class=main>(</span></span>6<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
              <span class=keyword1><span class=command>next</span></span>
                <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> xs_is_xsE2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r1</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>                      
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute snoc.prems<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>with</span></span> xs_is_xsE2 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> snoc.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>xs</span></span><span class=main>]</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2''</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> t2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> τ_xs_E2_t2''_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t2''Vv2_is_t2Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                              
                <span class=keyword1><span class=command>have</span></span> x_in_Cv2_inter_Nv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>hence</span></span> x_in_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> τ_xs_E2_t2''_in_Tr2 t2''Cv2_empty
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>x</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> τ_xs_E2_t2''_in_Tr2 validES2
                    <span class=keyword1><span class=command>have</span></span> τ_xsE2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                        prefixclosed_def prefix_def<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> x_in_Cv2_inter_Nv1 ES2_total_Cv2_inter_Nv1 
                    <span class=keyword1><span class=command>have</span></span> τ_xsE2_x_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
                    <span class=keyword1><span class=command>moreover</span></span>
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
                    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> BSIA2
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2'</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> res1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> BSIA_def<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> res1 validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t2'</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                    <span class=keyword1><span class=command>from</span></span> res1 xs_is_xsE2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword3><span class=command>thus</span></span>  <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> snoc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t2''Vv2_is_t2Vv2 res2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> res3
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> r1E2_in_Nv1_inter_C2_star<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t2'</span></span>
              <span class=keyword2><span class=keyword>where</span></span> t2'_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> τr1E2_t2'_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t2'_Vv2_is_t2_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t2'_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            
            <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
            
            <span class=keyword1><span class=command>from</span></span> v'_in_E1 Cons<span class=main>(</span>2<span class=main>)</span> r1_in_Nv1star validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> isViewOn_def composeES_def V_valid_def
                VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>4<span class=main>)</span> t1_is_r1_v'_s1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>note</span></span> t2'_in_E2star
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>              
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Cons_eq_appendI append_eq_appendI calculation<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> eq_Nil_appendI 
                list_subset_iff_projection_neutral Cons.prems<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> Cons.prems<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span> 
                projection_concatenation_commute t1_is_r1_v'_s1<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> τr1E2_t2'_in_Tr2 v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>t2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>8<span class=main>)</span> t1_is_r1_v'_s1 r1_Vv_empty v'_in_E1 v'_in_Vv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>9<span class=main>)</span> v'_notin_E2 t2'_Vv2_is_t2_Vv2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>         
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> 
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def                 
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Int_commute  
                    projection_def projection_intersection_neutral t2'_in_E2star<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>    
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def     
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Int_commute 
                    projection_def projection_intersection_neutral Cons<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> Cons<span class=main>(</span>9<span class=main>)</span> v'_notin_E2 t2'_Vv2_is_t2_Vv2
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>note</span></span> s1_Cv1_empty t2'_Cv2_empty
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>note</span></span> Cons.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>s1</span></span> <span class=quoted><span class=skolem>t2'</span></span><span class=main>]</span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
              <span class=keyword2><span class=keyword>where</span></span> τr1v't'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> t'_Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
              <span class=keyword2><span class=keyword>and</span></span> t'_Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

            <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>

            <span class=keyword1><span class=command>note</span></span> τr1v't'_in_Tr
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> r1_Vv_empty t'_Vv_is_lambda' v'_in_Vv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> 
                    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>from</span></span> projection_on_subset<span class=main>[</span><span class=operator>OF</span> <span class=quoted><span class=quoted>‹E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>›</span></span> r1_Cv1_empty<span class=main>]</span> 
                    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r1</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
                    <span class=keyword1><span class=command>with</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> r1_in_E1star<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>with</span></span> v'_in_Vv VIsViewOnE t'_Cv_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>{</span></span>
              <span class=keyword3><span class=command>assume</span></span> v'_in_Vv2_minus_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>-</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>hence</span></span> v'_in_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> v'_in_Vv propSepViews <span class=keyword1><span class=command>have</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> v'_in_Vv2_minus_E1 <span class=keyword1><span class=command>have</span></span> v'_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> v'_notin_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>𝒱'</span> <span class=main>∉</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                  VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> Cons<span class=main>(</span>5<span class=main>)</span> Cons<span class=main>(</span>9<span class=main>)</span> v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>from</span></span> projection_split_first<span class=main>[</span><span class=operator>OF</span> this<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>r2</span></span> <span class=skolem><span class=skolem>s2</span></span> 
                <span class=keyword2><span class=keyword>where</span></span> t2_is_r2_v'_s2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t2</span> <span class=main>=</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>s2</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> r2_Vv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 projection_on_subset<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span>"</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>have</span></span> r2_Vv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> r2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> t2_is_r2_v'_s2 Cons<span class=main>(</span>11<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> s2_Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>s2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>5<span class=main>)</span> t2_is_r2_v'_s2 <span class=keyword1><span class=command>have</span></span> r2_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>have</span></span> r2_in_Nv2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>note</span></span> r2_in_E2star
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r2_Vv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                    disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                    projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> r2_Cv2_empty <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>r2</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Compl_Diff_eq Diff_cancel Un_upper2 
                    disjoint_eq_subset_Compl list_subset_iff_projection_neutral 
                    projection_on_union<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> validV2
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              
              <span class=keyword1><span class=command>have</span></span> r2E1_in_Nv2_inter_C1_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> set <span class=skolem>r2</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> r2_in_Nv2star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>from</span></span> validV1 propSepViews disjoint_Nv2_Vv1 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>with</span></span> Cv1_inter_Nv2_subsetof_Upsilon1 
              <span class=keyword1><span class=command>have</span></span> r2E1_in_Nv2_inter_C1_Upsilon1_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>note</span></span> outerCons_prems <span class=main>=</span> Cons.prems

              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⟹</span> 
                <span class=main>∃</span> <span class=bound>t1'</span><span class=main>.</span> <span class=main>(</span> set <span class=bound>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∧</span> <span class=bound>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>r2</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> rev_induct<span class=main>)</span>
                <span class=keyword3><span class=command>case</span></span> Nil <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> 
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> append_self_conv outerCons_prems<span class=main><span class=main>(</span></span>9<span class=main><span class=main>)</span></span> outerCons_prems<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> 
                    outerCons_prems<span class=main><span class=main>(</span></span>5<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
              <span class=keyword1><span class=command>next</span></span>
                <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>snoc <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> xs_is_xsE1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>r2</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>                      
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute snoc.prems<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> snoc<span class=main>(</span>2<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>xs</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> xs_is_xsE1 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> snoc.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>xs</span></span><span class=main>]</span>
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1''</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> t1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> τ_xs_E1_t1''_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t1''Vv1_is_t1Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> t1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                
                <span class=keyword1><span class=command>have</span></span> x_in_Cv1_inter_Nv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> snoc<span class=main>(</span>2-3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>hence</span></span> x_in_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>x</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> τ_xs_E1_t1''_in_Tr1 t1''Cv1_empty
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>x</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> τ_xs_E1_t1''_in_Tr1 validES1
                  <span class=keyword1><span class=command>have</span></span> τ_xsE1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                      prefixclosed_def prefix_def<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> x_in_Cv1_inter_Nv2 ES1_total_Cv1_inter_Nv2 
                  <span class=keyword1><span class=command>have</span></span> τ_xsE1_x_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Adm_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> BSIA1
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1'</span></span>
                  <span class=keyword2><span class=keyword>where</span></span> res1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword2><span class=keyword>and</span></span> res3<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> BSIA_def<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>

                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> res1 validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>xs</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t1'</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span> 
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> res1 xs_is_xsE1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>x</span><span class=main>]</span><span class=main>)</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword3><span class=command>thus</span></span>  <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> snoc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span> projection_concatenation_commute<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>from</span></span> t1''Vv1_is_t1Vv1 res2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> res3
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> r2E1_in_Nv2_inter_C1_star<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t1'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> t1'_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>t1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
                <span class=keyword2><span class=keyword>and</span></span> τr2E1_t1'_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t1'_Vv1_is_t1_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t1'_Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              
              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>τ</span> <span class=main>@</span> <span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span>"</span></span>
              
              <span class=keyword1><span class=command>from</span></span> v'_in_E2 Cons<span class=main>(</span>2<span class=main>)</span> r2_in_Nv2star validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?tau</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> composeES_def isViewOn_def V_valid_def 
                  VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>lambda'</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>5<span class=main>)</span> t2_is_r2_v'_s2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>s2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> t1'_in_E1star
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>s2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>              
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Cons_eq_appendI append_eq_appendI calculation<span class=main><span class=main>(</span></span>3<span class=main><span class=main>)</span></span> eq_Nil_appendI 
                  list_subset_iff_projection_neutral Cons.prems<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span> Cons.prems<span class=main><span class=main>(</span></span>6<span class=main><span class=main>)</span></span> 
                  projection_concatenation_commute t2_is_r2_v'_s2<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> τr2E1_t1'_in_Tr1 v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>t1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>9<span class=main>)</span> t2_is_r2_v'_s2 r2_Vv_empty v'_in_E2 v'_in_Vv 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>s2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> Cons<span class=main>(</span>10<span class=main>)</span> v'_notin_E1 t1'_Vv1_is_t1_Vv1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>lambda'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>         
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> 
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def  
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Int_commute 
                    projection_def projection_intersection_neutral t1'_in_E1star<span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> 
                  <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def           
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>metis</span> Int_commute  
                    projection_def projection_intersection_neutral Cons<span class=main><span class=main>(</span></span>4<span class=main><span class=main>)</span></span><span class=main>)</span>
                <span class=keyword1><span class=command>moreover</span></span>
                <span class=keyword1><span class=command>note</span></span> Cons<span class=main>(</span>8<span class=main>)</span> v'_notin_E1 t1'_Vv1_is_t1_Vv1
                <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> s2_Cv2_empty t1'_Cv1_empty
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> Cons.hyps<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=var><span class=quoted><span class=var>?tau</span></span></span> <span class=quoted><span class=skolem>t1'</span></span> <span class=quoted><span class=skolem>s2</span></span><span class=main>]</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t'</span></span>
                <span class=keyword2><span class=keyword>where</span></span> τr2v't'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?tau</span> <span class=main>@</span> <span class=skolem>t'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Vv_is_lambda'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> t'_Cv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

              <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?t</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>𝒱'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t'</span>"</span></span>

              <span class=keyword1><span class=command>note</span></span> τr2v't'_in_Tr
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> r2_Vv_empty t'_Vv_is_lambda' v'_in_Vv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>𝒱'</span> <span class=main>#</span> <span class=skolem>lambda'</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> 
                    <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>from</span></span> projection_on_subset<span class=main>[</span><span class=operator>OF</span> <span class=quoted><span class=quoted>‹E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>›</span></span> r2_Cv2_empty<span class=main>]</span> 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>r2</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
                  <span class=keyword1><span class=command>with</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> r2_in_E2star<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>qed</span></span>
                <span class=keyword1><span class=command>with</span></span> v'_in_Vv VIsViewOnE t'_Cv_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>}</span></span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>qed</span></span>
        
      <span class=keyword1><span class=command>qed</span></span> 
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* The generalized zipping lemma (Lemma 6.4.4) *)</span>
<span class=keyword1 id=GeneralizedZippingLemma-generalized_zipping_lemma><span class=command>lemma</span></span> generalized_zipping_lemma<span class=main>:</span> 
 <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>τ</span> <span class=bound>lambda</span> <span class=bound>t1</span> <span class=bound>t2</span><span class=main>.</span> <span class=main>(</span> <span class=main>(</span> set <span class=bound>τ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>
  <span class=main>∧</span> set <span class=bound>lambda</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>t1</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>t2</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
  <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t1</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>t2</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
  <span class=main>∧</span> <span class=main>(</span><span class=bound>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>t1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>lambda</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=bound>t2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>
  <span class=main>∧</span> <span class=main>(</span><span class=bound>t1</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t2</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span> 
  <span class=main>⟶</span> <span class=main>(</span><span class=main>∃</span><span class=bound>t</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=bound>τ</span> <span class=main>@</span> <span class=bound>t</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=bound>lambda</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span><span class=main>)</span> <span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>note</span></span> well_behaved_composition
  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
    <span class=keyword1><span class=command>with</span></span> generalized_zipping_lemma1 <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>ρ1</span><span class=main>.</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> BSIA <span class=bound>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>ρ1</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> BSIA <span class=skolem>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> generalized_zipping_lemma2<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>ρ1</span></span><span class=main>]</span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>ρ2</span><span class=main>.</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> BSIA <span class=bound>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>ρ2</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> BSIA <span class=skolem>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> generalized_zipping_lemma3<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>ρ2</span></span><span class=main>]</span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>ρ1</span> <span class=bound>ρ2</span> <span class=bound>Γ1</span> <span class=bound>Γ2</span><span class=main>.</span> <span class=main>(</span> ∇<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Δ<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Υ<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> ∇<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Δ<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Υ<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> BSIA <span class=bound>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> BSIA <span class=bound>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>
      <span class=main>∧</span> FCIA <span class=bound>ρ1</span> <span class=bound>Γ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> FCIA <span class=bound>ρ2</span> <span class=bound>Γ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> ∇<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=bound>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=bound>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>ρ1</span></span> <span class=skolem><span class=skolem>ρ2</span></span> <span class=skolem><span class=skolem>Γ1</span></span> <span class=skolem><span class=skolem>Γ2</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=skolem>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Δ<span class=hidden>⇘</span><sub><span class=skolem>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Υ<span class=hidden>⇘</span><sub><span class=skolem>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> ∇<span class=hidden>⇘</span><sub><span class=skolem>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Δ<span class=hidden>⇘</span><sub><span class=skolem>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> Υ<span class=hidden>⇘</span><sub><span class=skolem>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> BSIA <span class=skolem>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> BSIA <span class=skolem>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>
      <span class=main>∧</span> FCIA <span class=skolem>ρ1</span> <span class=skolem>Γ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> FCIA <span class=skolem>ρ2</span> <span class=skolem>Γ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=skolem>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> ∇<span class=hidden>⇘</span><sub><span class=skolem>Γ2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=skolem>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=skolem>Γ2</span></sub><span class=hidden>⇙</span>
      <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=skolem>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=skolem>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>with</span></span> generalized_zipping_lemma4<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>Γ1</span></span> <span class=quoted><span class=skolem>Γ2</span></span> <span class=quoted><span class=skolem>ρ1</span></span> <span class=quoted><span class=skolem>ρ2</span></span><span class=main>]</span>  <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> wellBehavedComposition_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword2><span class=keyword>end</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div><div id=CompositionalityResults>
<div class=head>
<h1>Theory CompositionalityResults</h1>
</div>
<pre class=source><span class=keyword1><span class=command>theory</span></span> CompositionalityResults
<span class=keyword2><span class=keyword>imports</span></span> <a href=#GeneralizedZippingLemma>GeneralizedZippingLemma</a> <a href=#CompositionSupport>CompositionSupport</a>
<span class=keyword2><span class=keyword>begin</span></span>

<span class=keyword1><span class=command>context</span></span> Compositionality 
<span class=keyword2><span class=keyword>begin</span></span>


<span class=comment1>(* Theorem 6.4.1 case 1 *)</span>
<span class=keyword1><span class=command>theorem</span></span> compositionality_BSD<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span> BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> <span class=main>⟹</span> BSD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> BSD_Tr1_v1<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword3><span class=command>assume</span></span> BSD_Tr2_v2<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> c_in_Cv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> βcα_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> α_contains_no_c<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>

    <span class=keyword1><span class=command>interpret</span></span> CSES1<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES1</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱1</span>"</span></span>  
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES1 validV1<span class=main>)</span>

    <span class=keyword1><span class=command>interpret</span></span> CSES2<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES2</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱2</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES2 validV2<span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> βcα_in_Tr 
    <span class=keyword1><span class=command>have</span></span>  βcα_E1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βcα_E2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span><span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span><span class=main><span class=keyword3>+</span></span>

    <span class=keyword1><span class=command>from</span></span> composeES_yields_ES validES1 validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"ES_valid <span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>with</span></span> βcα_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>β</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> CSES1.BSD_in_subsystem<span class=main>[</span><span class=operator>OF</span> c_in_Cv βcα_E1_in_Tr1 BSD_Tr1_v1<span class=main>]</span>
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> α1'_1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1'_2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> α1'_1 validES1 <span class=keyword1><span class=command>have</span></span> α1'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> α1'_2 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> α1'_2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> α1'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
            <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
            <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α1'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
            <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_Un_distrib<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span> 
            <span class=keyword1><span class=command>from</span></span> validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> 
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> propSepViews Vv_is_Vv1_union_Vv2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
               <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Un_absorb2<span class=main>)</span>
          <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> α1'_2
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span> 
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> CSES2.BSD_in_subsystem<span class=main>[</span><span class=operator>OF</span> c_in_Cv βcα_E2_in_Tr2 BSD_Tr2_v2<span class=main>]</span>
    <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2'</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> α2'_1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2'_2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> α2'_1 validES2 <span class=keyword1><span class=command>have</span></span> α2'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> α2'_2 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> α2'_2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> α2'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
            <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
            <span class=keyword1><span class=command>with</span></span> Vv_is_Vv1_union_Vv2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α2'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Un_commute<span class=main>)</span>
            <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_Un_distrib<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span> 
            <span class=keyword1><span class=command>from</span></span> validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> 
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> propSepViews Vv_is_Vv1_union_Vv2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Un_commute<span class=main>)</span>
                <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                    VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
               <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Un_absorb2<span class=main>)</span>
          <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> α2'_2
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> generalized_zipping_lemma
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∧</span> <span class=main>(</span><span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>)</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
    <span class=keyword1><span class=command>unfolding</span></span> BSD_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Theorem 6.4.1 case 2 *)</span>
<span class=keyword1><span class=command>theorem</span></span> compositionality_BSI<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span> BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSI <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSI <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span>
    <span class=main>⟹</span> BSI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> BSD1<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> BSD2<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> BSI1<span class=main>:</span> <span class=quoted><span class=quoted>"BSI <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> BSI2<span class=main>:</span> <span class=quoted><span class=quoted>"BSI <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> c_in_Cv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> βα_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> α_no_Cv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    
    <span class=keyword1><span class=command>from</span></span> βα_in_Tr 
    <span class=keyword1><span class=command>have</span></span>  βα_E1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βα_E2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span><span class=main><span class=keyword3>+</span></span>

    <span class=keyword1><span class=command>interpret</span></span> CSES1<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES1</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱1</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES1 validV1<span class=main>)</span>

    <span class=keyword1><span class=command>interpret</span></span> CSES2<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES2</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱2</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES2 validV2<span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> CSES1.BSD_in_subsystem2<span class=main>[</span><span class=operator>OF</span> βα_E1_in_Tr1 BSD1<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> βE1α1'_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1'Vv1_is_αVv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1'Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> CSES2.BSD_in_subsystem2<span class=main>[</span><span class=operator>OF</span> βα_E2_in_Tr2 BSD2<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> βE2α2'_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2'Vv2_is_αVv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2'Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α1''</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>cases</span>
        <span class=keyword3><span class=command>assume</span></span> cE1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        
        <span class=keyword1><span class=command>from</span></span> βE1α1'_in_Tr1 validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> cE1_empty βE1α1'_in_Tr1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α1'Vv1_is_αVv1 α1'Cv1_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>next</span></span>
        <span class=keyword3><span class=command>assume</span></span> cE1_not_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>≠</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>hence</span></span> c_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

        <span class=keyword1><span class=command>from</span></span> c_in_Cv c_in_E1 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> βE1α1'_in_Tr1 α1'Cv1_empty BSI1
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> 
          <span class=keyword2><span class=keyword>where</span></span> βE1cα1''_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>   α1''Vv1_is_α1'Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>   α1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> BSI_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        
        <span class=keyword1><span class=command>from</span></span> validES1 βE1cα1''_in_Tr1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> βE1cα1''_in_Tr1 c_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> α1''Vv1_is_α1'Vv1 α1'Vv1_is_αVv1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α1''Cv1_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span>
      <span class=keyword2><span class=keyword>where</span></span> α1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> βcE1α1''_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> α1''Vv1_is_αVv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α2''</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>cases</span>
        <span class=keyword3><span class=command>assume</span></span> cE2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        
        <span class=keyword1><span class=command>from</span></span> βE2α2'_in_Tr2 validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> cE2_empty βE2α2'_in_Tr2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α2'Vv2_is_αVv2 α2'Cv2_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>next</span></span>
        <span class=keyword3><span class=command>assume</span></span> cE2_not_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>≠</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>hence</span></span> c_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

        <span class=keyword1><span class=command>from</span></span> c_in_Cv c_in_E2 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> βE2α2'_in_Tr2 α2'Cv2_empty BSI2
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> 
          <span class=keyword2><span class=keyword>where</span></span> βE2cα2''_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>   α2''Vv2_is_α2'Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>   α2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> BSI_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        
        <span class=keyword1><span class=command>from</span></span> validES2 βE2cα2''_in_Tr2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> βE2cα2''_in_Tr2 c_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> α2''Vv2_is_α2'Vv2 α2'Vv2_is_αVv2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α2''Cv2_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span>
      <span class=keyword2><span class=keyword>where</span></span> α2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> βcE2α2''_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> α2''Vv2_is_αVv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    
    <span class=comment1>(* apply the generalized zipping lemma *)</span>
    <span class=keyword1><span class=command>from</span></span> VIsViewOnE c_in_Cv βα_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
        VN_disjoint_def NC_disjoint_def composeES_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> α1''_in_E1star α2''_in_E2star βcE1α1''_in_Tr1 βcE2α2''_in_Tr2
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span>  α1''Vv1_is_αVv1 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α1''</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> α1''_in_E1star <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span>  α2''Vv2_is_αVv2 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α2''</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> α2''_in_E2star <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> α1''Cv1_empty α2''Cv2_empty generalized_zipping_lemma
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSI_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Theorem 6.4.1 case 3 *)</span>
<span class=keyword1><span class=command>theorem</span></span> compositionality_BSIA<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span> BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> 
  <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
    <span class=main>⟹</span> BSIA <span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> BSD1<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> BSD2<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> BSIA1<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> BSIA2<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> ρ1v1_subset_ρv_inter_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword2><span class=keyword>and</span></span> ρ2v2_subset_ρv_inter_E2<span class=main>:</span><span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span>
    <span class=keyword3><span class=command>assume</span></span> c_in_Cv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> βα_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> α_no_Cv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
    <span class=keyword3><span class=command>assume</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱</span> <span class=free>ρ</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=skolem>β</span> <span class=skolem>c</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span>
      <span class=keyword2><span class=keyword>where</span></span> γρv_is_βρv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> γc_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> Adm_def
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> βα_in_Tr 
    <span class=keyword1><span class=command>have</span></span>  βα_E1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βα_E2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span><span class=main><span class=keyword3>+</span></span>

    <span class=keyword1><span class=command>interpret</span></span> CSES1<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES1</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱1</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES1 validV1<span class=main>)</span>

    <span class=keyword1><span class=command>interpret</span></span> CSES2<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES2</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱2</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES2 validV2<span class=main>)</span>


    <span class=keyword1><span class=command>from</span></span> CSES1.BSD_in_subsystem2<span class=main>[</span><span class=operator>OF</span> βα_E1_in_Tr1 BSD1<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> βE1α1'_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1'Vv1_is_αVv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1'Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> CSES2.BSD_in_subsystem2<span class=main>[</span><span class=operator>OF</span> βα_E2_in_Tr2 BSD2<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> βE2α2'_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2'Vv2_is_αVv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2'Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α1''</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>cases</span>
        <span class=keyword3><span class=command>assume</span></span> cE1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        
        <span class=keyword1><span class=command>from</span></span> βE1α1'_in_Tr1 validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> cE1_empty βE1α1'_in_Tr1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α1'Vv1_is_αVv1 α1'Cv1_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>next</span></span>
        <span class=keyword3><span class=command>assume</span></span> cE1_not_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>≠</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>hence</span></span> c_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

        <span class=keyword1><span class=command>from</span></span> c_in_Cv c_in_E1 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> βE1α1'_in_Tr1 α1'Cv1_empty
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span><span class=main>)</span>"</span></span> 
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> c_in_E1 γc_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def composeES_def<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> γρv_is_βρv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> ρ1v1_subset_ρv_inter_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_subset_iff γρv_is_βρv projection_subset_elim<span class=main>)</span>
                <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
           <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> Adm_def
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> BSIA1
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> 
          <span class=keyword2><span class=keyword>where</span></span> βE1cα1''_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>   α1''Vv1_is_α1'Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>   α1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        
        <span class=keyword1><span class=command>from</span></span> validES1 βE1cα1''_in_Tr1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> βE1cα1''_in_Tr1 c_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> α1''Vv1_is_α1'Vv1 α1'Vv1_is_αVv1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α1''Cv1_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span>
      <span class=keyword2><span class=keyword>where</span></span> α1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> βcE1α1''_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> α1''Vv1_is_αVv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α2''</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>cases</span>
        <span class=keyword3><span class=command>assume</span></span> cE2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        
        <span class=keyword1><span class=command>from</span></span> βE2α2'_in_Tr2 validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> cE2_empty βE2α2'_in_Tr2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α2'Vv2_is_αVv2 α2'Cv2_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>next</span></span>
        <span class=keyword3><span class=command>assume</span></span> cE2_not_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>≠</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>hence</span></span> c_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

        <span class=keyword1><span class=command>from</span></span> c_in_Cv c_in_E2 propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> βE2α2'_in_Tr2 α2'Cv2_empty
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span><span class=main>)</span>"</span></span> 
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> c_in_E2 γc_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def composeES_def<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                <span class=keyword1><span class=command>from</span></span> γρv_is_βρv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
                <span class=keyword1><span class=command>with</span></span> ρ2v2_subset_ρv_inter_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_subset_iff γρv_is_βρv projection_subset_elim<span class=main>)</span>
                <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
              <span class=keyword1><span class=command>qed</span></span>
           <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> Adm_def
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> BSIA2
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> 
          <span class=keyword2><span class=keyword>where</span></span> βE2cα2''_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>   α2''Vv2_is_α2'Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>   α2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        
        <span class=keyword1><span class=command>from</span></span> validES2 βE2cα2''_in_Tr2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> βE2cα2''_in_Tr2 c_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> α2''Vv2_is_α2'Vv2 α2'Vv2_is_αVv2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α2''Cv2_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span>
      <span class=keyword2><span class=keyword>where</span></span> α2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> βcE2α2''_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> α2''Vv2_is_αVv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=comment1>(* apply the generalized zipping lemma *)</span>
    <span class=keyword1><span class=command>from</span></span> VIsViewOnE c_in_Cv βα_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
        VN_disjoint_def NC_disjoint_def composeES_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> α1''_in_E1star α2''_in_E2star βcE1α1''_in_Tr1 βcE2α2''_in_Tr2
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span>  α1''Vv1_is_αVv1 propSepViews 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α1''</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
         <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> α1''_in_E1star <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span>  α2''Vv2_is_αVv2 propSepViews 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α2''</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> α2''_in_E2star <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> α1''Cv1_empty α2''Cv2_empty generalized_zipping_lemma
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Theorem 6.4.1 case 4 *)</span>
<span class=keyword1><span class=command>theorem</span></span> compositionality_FCD<span class=main>:</span> 
 <span class=quoted><span class=quoted>"<span class=main>⟦</span> BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> 
  ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>;</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>;</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  <span class=main>(</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>)</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span><span class=main>;</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span><span class=main>;</span>
  FCD <span class=free>Γ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> FCD <span class=free>Γ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> FCD <span class=free>Γ</span> <span class=free>𝒱</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> BSD1<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> BSD2<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Nabla_inter_E1_subset_Nabla1<span class=main>:</span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Nabla_inter_E2_subset_Nabla2<span class=main>:</span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Upsilon_inter_E1_subset_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Upsilon_inter_E2_subset_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Delta1_N1_Delta2_N2_subset_Delta<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>)</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> N1_Delta1_E2_disjoint<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> N2_Delta2_E1_disjoint<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> FCD1<span class=main>:</span> <span class=quoted><span class=quoted>"FCD <span class=free>Γ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> FCD2<span class=main>:</span> <span class=quoted><span class=quoted>"FCD <span class=free>Γ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v'</span>
    <span class=keyword3><span class=command>assume</span></span> c_in_Cv_inter_Upsilon<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> v'_in_Vv_inter_Nabla<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βcv'α_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> αCv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>

    <span class=keyword1><span class=command>from</span></span>  βcv'α_in_Tr
    <span class=keyword1><span class=command>have</span></span>  βcv'α_E1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βcv'α_E2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span><span class=main><span class=keyword3>+</span></span>

    <span class=keyword1><span class=command>interpret</span></span> CSES1<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES1</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱1</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES1 validV1<span class=main>)</span>

    <span class=keyword1><span class=command>interpret</span></span> CSES2<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES2</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱2</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES2 validV2<span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> CSES1.BSD_in_subsystem2<span class=main>[</span><span class=operator>OF</span> βcv'α_E1_in_Tr1 BSD1<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> βcv'E1α1'_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1'Vv1_is_αVv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1'Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> CSES2.BSD_in_subsystem2<span class=main>[</span><span class=operator>OF</span> βcv'α_E2_in_Tr2 BSD2<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> βcv'E2α2'_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2'Vv2_is_αVv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2'Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> c_in_Cv_inter_Upsilon v'_in_Vv_inter_Nabla validV1
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
        VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
      <span class=keyword3><span class=command>assume</span></span> c_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
     
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βcv'E1α1'_in_Tr1 c_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α1'Cv1_empty 
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α1''</span> <span class=bound>δ1''</span><span class=main>.</span> set <span class=bound>δ1''</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
        <span class=main>∧</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>δ1''</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
      <span class=keyword3><span class=command>assume</span></span> c_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> v'_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

      <span class=keyword1><span class=command>from</span></span> c_in_E1 c_in_Cv_inter_Upsilon propSepViews
        Upsilon_inter_E1_subset_Upsilon1 
      <span class=keyword1><span class=command>have</span></span> c_in_Cv1_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>hence</span></span> c_in_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βcv'E1α1'_in_Tr1 c_in_E1 v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α1'Cv1_empty BSD1
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span>
        <span class=keyword2><span class=keyword>where</span></span> first<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> second<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> third<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> BSD_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
       
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> first v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> second third
      <span class=keyword1><span class=command>ultimately</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α1''</span> <span class=bound>δ1''</span><span class=main>.</span> set <span class=bound>δ1''</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
        <span class=main>∧</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>δ1''</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
      <span class=keyword3><span class=command>assume</span></span> c_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      
      <span class=keyword1><span class=command>from</span></span> c_in_E1 c_in_Cv_inter_Upsilon propSepViews
        Upsilon_inter_E1_subset_Upsilon1 
      <span class=keyword1><span class=command>have</span></span> c_in_Cv1_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> v'_in_E1 v'_in_Vv_inter_Nabla propSepViews Nabla_inter_E1_subset_Nabla1
      <span class=keyword1><span class=command>have</span></span> v'_in_Vv1_inter_Nabla1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βcv'E1α1'_in_Tr1 c_in_E1 v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α1'Cv1_empty FCD1
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ1''</span></span> 
        <span class=keyword2><span class=keyword>where</span></span> first<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> second<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> third<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> fourth<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> FCD_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>from</span></span> second v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>with</span></span> first third fourth
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α1''</span> <span class=bound>δ1''</span><span class=main>.</span> set <span class=bound>δ1''</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
        <span class=main>∧</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>δ1''</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> FCD_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ1''</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> δ1''_in_Nv1_Delta1_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βE1δ1''vE1α1''_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1''Vv1_is_α1'Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> δ1''_in_E1_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
        VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> c_in_Cv_inter_Upsilon v'_in_Vv_inter_Nabla validV2
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
        VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
      <span class=keyword3><span class=command>assume</span></span> c_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
     
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βcv'E2α2'_in_Tr2 c_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α2'Cv2_empty 
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α2''</span> <span class=bound>δ2''</span><span class=main>.</span> set <span class=bound>δ2''</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
        <span class=main>∧</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>δ2''</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
      <span class=keyword3><span class=command>assume</span></span> c_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> v'_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

      <span class=keyword1><span class=command>from</span></span> c_in_E2 c_in_Cv_inter_Upsilon propSepViews Upsilon_inter_E2_subset_Upsilon2 
      <span class=keyword1><span class=command>have</span></span> c_in_Cv2_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>hence</span></span> c_in_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βcv'E2α2'_in_Tr2 c_in_E2 v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α2'Cv2_empty BSD2
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span>
        <span class=keyword2><span class=keyword>where</span></span> first<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> second<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> third<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> BSD_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
       
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> first v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> second third
      <span class=keyword1><span class=command>ultimately</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α2''</span> <span class=bound>δ2''</span><span class=main>.</span> set <span class=bound>δ2''</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
        <span class=main>∧</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>δ2''</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
      <span class=keyword3><span class=command>assume</span></span> c_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      
      <span class=keyword1><span class=command>from</span></span> c_in_E2 c_in_Cv_inter_Upsilon propSepViews
        Upsilon_inter_E2_subset_Upsilon2 
      <span class=keyword1><span class=command>have</span></span> c_in_Cv2_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> v'_in_E2 v'_in_Vv_inter_Nabla propSepViews Nabla_inter_E2_subset_Nabla2
      <span class=keyword1><span class=command>have</span></span> v'_in_Vv2_inter_Nabla2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βcv'E2α2'_in_Tr2 c_in_E2 v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>,</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α2'Cv2_empty FCD2
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ2''</span></span> 
        <span class=keyword2><span class=keyword>where</span></span> first<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> second<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> third<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> fourth<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> FCD_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>from</span></span> second v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>with</span></span> first third fourth
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α2''</span> <span class=bound>δ2''</span><span class=main>.</span> set <span class=bound>δ2''</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
        <span class=main>∧</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>δ2''</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> FCD_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ2''</span></span> 
      <span class=keyword2><span class=keyword>where</span></span> δ2''_in_Nv2_Delta2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βE2δ2''vE2α2''_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>(</span><span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2''Vv2_is_α2'Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> δ2''_in_E2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  
        VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    
    <span class=keyword1><span class=command>from</span></span> δ1''_in_Nv1_Delta1_star N1_Delta1_E2_disjoint 
    <span class=keyword1><span class=command>have</span></span> δ1''E2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span> δ1''_in_Nv1_Delta1_star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> N1_Delta1_E2_disjoint <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> δ2''_in_Nv2_Delta2_star N2_Delta2_E1_disjoint <span class=keyword1><span class=command>have</span></span> δ2''E1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span> δ2''_in_Nv2_Delta2_star <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> N2_Delta2_E1_disjoint <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> βE1δ1''vE1α1''_in_Tr1 βE2δ2''vE2α2''_in_Tr2 δ1''_in_E1_star δ2''_in_E2_star
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> βδ1''δ2''v'E1α1''_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βδ1''δ2''v'E2α2''_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute list_subset_iff_projection_neutral<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main><span class=keyword3>,</span></span> 
          <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute list_subset_iff_projection_neutral<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span> βcv'α_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>β</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> δ1''_in_E1_star δ2''_in_E2_star
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> v'_in_Vv_inter_Nabla VIsViewOnE
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def  V_valid_def
            VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> βE1δ1''vE1α1''_in_Tr1 validES1 <span class=keyword1><span class=command>have</span></span> α1''_in_E1_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> βE2δ2''vE2α2''_in_Tr2 validES2 <span class=keyword1><span class=command>have</span></span> α2''_in_E2_star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> βδ1''δ2''v'E1α1''_in_Tr1 βδ1''δ2''v'E2α2''_in_Tr2
    <span class=keyword1><span class=command>moreover</span></span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span>  α1''Vv1_is_α1'Vv1 α1'Vv1_is_αVv1 propSepViews 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α1''</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> α1''_in_E1_star <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>from</span></span>  α2''Vv2_is_α2'Vv2 α2'Vv2_is_αVv2 propSepViews 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>α2''</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>with</span></span> α2''_in_E2_star <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>note</span></span> α1''Cv1_empty α2''Cv2_empty generalized_zipping_lemma
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t</span></span>
      <span class=keyword2><span class=keyword>where</span></span> first<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>t</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> second<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> third<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    
    <span class=keyword1><span class=command>from</span></span> δ1''_in_Nv1_Delta1_star δ2''_in_Nv2_Delta2_star 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>δ1''</span> <span class=main>@</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>δ1''</span> <span class=main>@</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> δ1''_in_Nv1_Delta1_star δ2''_in_Nv2_Delta2_star 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>δ1''</span> <span class=main>@</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>with</span></span> Delta1_N1_Delta2_N2_subset_Delta <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>δ1''</span> <span class=main>@</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> δ1''_in_Nv1_Delta1_star δ2''_in_Nv2_Delta2_star 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>δ1''</span> <span class=main>@</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
            <span class=keyword1><span class=command>with</span></span> Nv1_union_Nv2_subsetof_Nv <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>moreover</span></span>
    <span class=keyword1><span class=command>from</span></span> first <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>δ1''</span> <span class=main>@</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>t</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>moreover</span></span> 
    <span class=keyword1><span class=command>note</span></span> second third
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span><span class=main>.</span> <span class=main>∃</span><span class=bound>γ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>γ'</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
      <span class=main>∧</span> <span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=bound>γ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>  
      <span class=main>∧</span> <span class=main>(</span><span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> 
      <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> FCD_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Theorem 6.4.1 case 5 *)</span>
<span class=keyword1><span class=command>theorem</span></span> compositionality_FCI<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span> BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span> total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span>
  ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>;</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>;</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  <span class=main>(</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>)</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>
  <span class=main>∨</span> <span class=main>(</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>  <span class=main>;</span>
  FCI <span class=free>Γ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> FCI <span class=free>Γ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> FCI <span class=free>Γ</span> <span class=free>𝒱</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> BSD1<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword2><span class=keyword>and</span></span> BSD2<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> BSIA1<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> BSIA2<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> total_ES1_C1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> total_ES2_C2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Nabla_inter_E1_subset_Nabla1<span class=main>:</span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Nabla_inter_E2_subset_Nabla2<span class=main>:</span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Upsilon_inter_E1_subset_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Upsilon_inter_E2_subset_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Delta1_N1_Delta2_N2_subset_Delta<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>)</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> very_long_asm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>
    <span class=main>∨</span> <span class=main>(</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> FCI1<span class=main>:</span> <span class=quoted><span class=quoted>"FCI <span class=free>Γ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> FCI2<span class=main>:</span> <span class=quoted><span class=quoted>"FCI <span class=free>Γ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v'</span>
    <span class=keyword3><span class=command>assume</span></span> c_in_Cv_inter_Upsilon<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> v'_in_Vv_inter_Nabla<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βv'α_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> αCv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>

    <span class=keyword1><span class=command>from</span></span>  βv'α_in_Tr
    <span class=keyword1><span class=command>have</span></span>  βv'α_E1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βv'α_E2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span><span class=main><span class=keyword3>+</span></span>

    <span class=keyword1><span class=command>interpret</span></span> CSES1<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES1</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱1</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES1 validV1<span class=main>)</span>

    <span class=keyword1><span class=command>interpret</span></span> CSES2<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES2</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱2</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES2 validV2<span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span> CSES1.BSD_in_subsystem2<span class=main>[</span><span class=operator>OF</span> βv'α_E1_in_Tr1 BSD1<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> βv'E1α1'_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1'Vv1_is_αVv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1'Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> CSES2.BSD_in_subsystem2<span class=main>[</span><span class=operator>OF</span> βv'α_E2_in_Tr2 BSD2<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> βv'E2α2'_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2'Vv2_is_αVv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2'Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>note</span></span> very_long_asm
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
      <span class=keyword3><span class=command>assume</span></span> Nv1_inter_Delta1_inter_E2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span>  Nv2_inter_Delta2_inter_E1_subsetof_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>

      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?ALPHA2''_DELTA2''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α2''</span> <span class=bound>δ2''</span><span class=main>.</span> <span class=main>(</span>
        set <span class=bound>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> 
        <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>

      <span class=keyword1><span class=command>from</span></span> c_in_Cv_inter_Upsilon v'_in_Vv_inter_Nabla  validV2
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
          VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> validES2 βv'E2α2'_in_Tr2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>from</span></span> βv'E2α2'_in_Tr2 c_notin_E2 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> α2'Cv2_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA2''_DELTA2''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>  v'_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> c_in_E2 c_in_Cv_inter_Upsilon propSepViews 
          Upsilon_inter_E2_subset_Upsilon2
        <span class=keyword1><span class=command>have</span></span> c_in_Cv2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> βv'E2α2'_in_Tr2 v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α2'Cv2_empty
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span><span class=main>)</span>"</span></span> 
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> validES2 βv'E2α2'_in_Tr2 v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                prefixclosed_def prefix_def projection_concatenation_commute<span class=main>)</span>
            <span class=keyword1><span class=command>with</span></span> total_ES2_C2_inter_Upsilon2 c_in_Cv2_inter_Upsilon2 
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
            <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>unfolding</span></span> Adm_def
              <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
          <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> BSIA2
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span>  <span class=skolem><span class=skolem>α2''</span></span>
          <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span>   <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

        <span class=keyword1><span class=command>from</span></span> one validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> one c_in_E2 v'_notin_E2 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> two three
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA2''_DELTA2''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>  v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> c_in_E2 c_in_Cv_inter_Upsilon propSepViews
          Upsilon_inter_E2_subset_Upsilon2
        <span class=keyword1><span class=command>have</span></span> c_in_Cv2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> v'_in_E2 propSepViews v'_in_Vv_inter_Nabla Nabla_inter_E2_subset_Nabla2
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Nabla <span class=free>Γ2</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> v'_in_E2  βv'E2α2'_in_Tr2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α2'Cv2_empty FCI2
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ2''</span></span>
          <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> FCI_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

        <span class=keyword1><span class=command>from</span></span> two validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> one
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> two c_in_E2 v'_in_E2 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> three four
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA2''_DELTA2''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ2''</span></span>
        <span class=keyword2><span class=keyword>where</span></span> α2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ2''_in_N2_inter_Delta2star<span class=main>:</span><span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2<span class=main>:</span>
              <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α2''Vv2_is_α2'Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>from</span></span> c_in_Cv_inter_Upsilon Upsilon_inter_E1_subset_Upsilon1 
      propSepViews 
      <span class=keyword1><span class=command>have</span></span> cE1_in_Cv1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
     
      <span class=keyword1><span class=command>from</span></span> δ2''_in_N2_inter_Delta2star Nv2_inter_Delta2_inter_E1_subsetof_Upsilon1 
        propSepViews disjoint_Nv2_Vv1 
      <span class=keyword1><span class=command>have</span></span> δ2''E1_in_Cv1_inter_Upsilon1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> δ2''_in_N2_inter_Delta2star 
          <span class=keyword1><span class=command>have</span></span> eq<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute Int_left_commute Int_lower1 Int_lower2 
              projection_intersection_neutral subset_trans<span class=main>)</span>
          
          <span class=keyword1><span class=command>from</span></span> validV1 Nv2_inter_Delta2_inter_E1_subsetof_Upsilon1 propSepViews
            disjoint_Nv2_Vv1  
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def V_valid_def  VC_disjoint_def
              VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> eq<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>qed</span></span>
      
      <span class=keyword1><span class=command>have</span></span> cδ2''E1_in_Cv1_inter_Upsilon1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> cE1_in_Cv1_inter_Upsilon1 δ2''E1_in_Cv1_inter_Upsilon1star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>


      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α1''</span> <span class=bound>δ1''</span><span class=main>.</span> set <span class=bound>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
        <span class=main>∧</span> set <span class=bound>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span>
</sub><span class=hidden>⇙</span>        <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
        <span class=main>∧</span> <span class=bound>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>cases</span>
          <span class=keyword3><span class=command>assume</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>with</span></span> Nabla_inter_E1_subset_Nabla1 propSepViews v'_in_Vv_inter_Nabla
          <span class=keyword1><span class=command>have</span></span> v'_in_Vv1_inter_Nabla1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Nabla <span class=free>Γ1</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
            <span class=skolem>α1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
            <span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>;</span> set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
            <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α1''</span> <span class=bound>δ1''</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> 
              <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>
            <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>            
            <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
            <span class=main>∧</span> <span class=bound>δ1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α1'</span></span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=skolem>δ2''</span></span><span class=main>)</span>
              <span class=keyword3><span class=command>case</span></span> 0

              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>2<span class=main>)</span> validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>2<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>3<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span> 
              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
            <span class=keyword1><span class=command>next</span></span>
              <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>μ</span></span> <span class=skolem><span class=skolem>c'</span></span> <span class=skolem><span class=skolem>ν</span></span>
                <span class=keyword2><span class=keyword>where</span></span> c'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> cδ2''_is_μc'ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>μ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> νE1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> n_is_length_μνE1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>μ</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

              <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> c'_in_E1 cδ2''_is_μc'ν 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>μ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ2''_is_μc'ν projection_concatenation_commute 
                  projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> c'_in_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> c'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def  VC_disjoint_def 
                  VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=skolem>μ</span></span><span class=main>)</span>
                  <span class=keyword3><span class=command>case</span></span> Nil <span class=comment1>(* we apply FCI in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ2''_is_μc'ν <span class=keyword1><span class=command>have</span></span> c_is_c'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>=</span> <span class=skolem>c'</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ2''_is_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> c'_in_Cv1_inter_Upsilon1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> v'_in_Vv1_inter_Nabla1
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> v'_in_E1 Suc<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>4<span class=main>)</span> FCI1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> FCI_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=comment1>(* we choose δ1'' = ν ↿ E<span class=hidden>⇘</span><sub>ES1</sub><span class=hidden>⇙</span> @ γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA1''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> two validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> one νE1_empty 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>from</span></span> v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>note</span></span> νE1_empty two
                      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> three four
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                              VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>with</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> one<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span>
                          <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>with</span></span> δ2''_is_ν νE1_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                <span class=keyword1><span class=command>next</span></span>
                  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span> <span class=comment1>(* we apply the inductive hypothesis in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ2''_is_μc'ν <span class=keyword1><span class=command>have</span></span> μ_is_c_xs<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>μ</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>xs</span>"</span></span> 
                    <span class=keyword2><span class=keyword>and</span></span> δ2''_is_xs_c'_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> n_is_length_μνE1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>3<span class=main>,</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> res<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span>"</span></span> 
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> cδ2''_is_μc'ν μ_is_c_xs νE1_empty
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> res<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ2''_is_μc'ν projection_concatenation_commute 
                          set_append<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>6<span class=main>)</span> 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> δ2''_is_xs_c'_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α1'</span></span><span class=main>]</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> five<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> six<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=comment1>(* apply FCI to insert c' after γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?BETA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span>

                  <span class=keyword1><span class=command>note</span></span> c'_in_Cv1_inter_Upsilon1 v'_in_Vv1_inter_Nabla1
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> three v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> five FCI1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ'</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> fci_one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fci_two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fci_three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fci_four<span class=main>:</span>  <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> FCI_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA1''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> fci_two validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv1_inter_Upsilon1 δ2''_is_xs_c'_ν 
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                      <span class=keyword1><span class=command>with</span></span> two fci_one <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> fci_two v'_in_E1 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> fci_three four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> fci_four
                  <span class=keyword1><span class=command>moreover</span></span>             
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> fci_one <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>e</span> <span class=main>∈</span> set <span class=skolem>δ'</span><span class=main>.</span> <span class=bound>e</span> <span class=main>∈</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                          <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>e</span> <span class=main>∈</span> set <span class=skolem>δ'</span><span class=main>.</span> <span class=bound>e</span> <span class=main>∉</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                              VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>with</span></span> c'_in_E1 c'_in_Cv1_inter_Upsilon1 δ2''_is_xs_c'_ν νE1_empty six 
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>     
                <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> βv'E1α1'_in_Tr1 α1'Cv1_empty cδ2''E1_in_Cv1_inter_Upsilon1star 
            c_in_Cv_inter_Upsilon δ2''_in_N2_inter_Delta2star<span class=main>]</span>
          <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ1''</span></span>
            <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>            
            <span class=main>∧</span> <span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

          <span class=keyword1><span class=command>note</span></span> one two three
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
            <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
              <span class=keyword1><span class=command>from</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> two<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> 
                Nv1_inter_Delta1_inter_E2_empty validV2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_Un_distrib2<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> validV2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                  VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
              <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
              <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_commute<span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> δ2''_in_N2_inter_Delta2star <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
            <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>next</span></span>
          <span class=keyword3><span class=command>assume</span></span> v'_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

           <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
            <span class=skolem>α1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
             <span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>;</span> set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
            <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α1''</span> <span class=bound>δ1''</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> 
                <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span>
</sub><span class=hidden>⇙</span>            <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>            
             <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
            <span class=main>∧</span> <span class=bound>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α1'</span></span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=skolem>δ2''</span></span><span class=main>)</span>
               <span class=keyword3><span class=command>case</span></span> 0

              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>2<span class=main>)</span> validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>2<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>3<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span> 
              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
            <span class=keyword1><span class=command>next</span></span>
              <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>μ</span></span> <span class=skolem><span class=skolem>c'</span></span> <span class=skolem><span class=skolem>ν</span></span>
                <span class=keyword2><span class=keyword>where</span></span> c'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> cδ2''_is_μc'ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>μ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> νE1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> n_is_length_μνE1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>μ</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

              <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> c'_in_E1 cδ2''_is_μc'ν 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>μ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ2''_is_μc'ν projection_concatenation_commute 
                  projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> c'_in_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> c'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                  VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=skolem>μ</span></span><span class=main>)</span>
                  <span class=keyword3><span class=command>case</span></span> Nil <span class=comment1>(* we just apply BSIA in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ2''_is_μc'ν <span class=keyword1><span class=command>have</span></span> c_is_c'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>=</span> <span class=skolem>c'</span>"</span></span> 
                    <span class=keyword2><span class=keyword>and</span></span> δ2''_is_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> c'_in_Cv1_inter_Upsilon1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> v'_notin_E1 Suc<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_Cv1_inter_Upsilon1 
                          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>from</span></span> validES1 Suc<span class=main>(</span>3<span class=main>)</span> 
                          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                              projection_concatenation_commute 
                              prefixclosed_def prefix_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>note</span></span> total_ES1_C1_inter_Upsilon1
                          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>unfolding</span></span> total_def
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>                        
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> BSIA1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA1''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> one validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> νE1_empty
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E1 one v'_notin_E1 νE1_empty
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> two three
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> νE1_empty δ2''_is_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                <span class=keyword1><span class=command>next</span></span>
                  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span> <span class=comment1>(* apply inductive hypothesis, then BSIA *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ2''_is_μc'ν
                  <span class=keyword1><span class=command>have</span></span> μ_is_c_xs<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>μ</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>xs</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ2''_is_xs_c'_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> n_is_length_μνE1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>3<span class=main>,</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> res<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span>"</span></span> 
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> cδ2''_is_μc'ν μ_is_c_xs νE1_empty
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> res<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ2''_is_μc'ν projection_concatenation_commute 
                          set_append<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>6<span class=main>)</span> 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> δ2''_is_xs_c'_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α1'</span></span><span class=main>]</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> five<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> six<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                  
                   <span class=comment1>(* apply BSIA to insert c' after γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?BETA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> c'_in_Cv1_inter_Upsilon1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> three v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> five 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=var>?BETA</span> <span class=skolem>c'</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> validES1 three 
                          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                              projection_concatenation_commute 
                              prefixclosed_def prefix_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>note</span></span> c'_in_Cv1_inter_Upsilon1 total_ES1_C1_inter_Upsilon1
                          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>unfolding</span></span> total_def
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>                        
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> BSIA1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> bsia_one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> bsia_two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> bsia_three<span class=main>:</span>  <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA1''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> bsia_one validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv1_inter_Upsilon1 δ2''_is_xs_c'_ν 
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                      <span class=keyword1><span class=command>with</span></span> two <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> bsia_one v'_notin_E1 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> bsia_two four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> bsia_three
                  <span class=keyword1><span class=command>moreover</span></span>             
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> validV2 Suc<span class=main>(</span>7<span class=main>)</span> δ2''_is_xs_c'_ν 
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                          VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                      <span class=keyword1><span class=command>with</span></span> c'_in_E1 c'_in_Cv1_inter_Upsilon1 δ2''_is_xs_c'_ν νE1_empty six 
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>     
                <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> βv'E1α1'_in_Tr1 α1'Cv1_empty cδ2''E1_in_Cv1_inter_Upsilon1star 
            c_in_Cv_inter_Upsilon δ2''_in_N2_inter_Delta2star<span class=main>]</span>
          <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ1''</span></span>
        <span class=keyword2><span class=keyword>where</span></span> α1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ1''_in_N1_inter_Delta1star<span class=main>:</span><span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1<span class=main>:</span> 
        <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α1''Vv1_is_α1'Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ1''E2_is_δ2''E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>from</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1 βE2_cE2_δ2''_v'E2_α2''_in_Tr2 
        validES1 validES2
      <span class=keyword1><span class=command>have</span></span> δ1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp_all</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>with</span></span> δ1''E2_is_δ2''E1 merge_property<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>δ1''</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=skolem>δ2''</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ'</span></span>
        <span class=keyword2><span class=keyword>where</span></span> δ'E1_is_δ1''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ'E2_is_δ2''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ'_contains_only_δ1''_δ2''_events<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> set <span class=skolem>δ1''</span> <span class=main>∪</span> set <span class=skolem>δ2''</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> Let_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?TAU</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span>"</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?LAMBDA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?T1</span></span></span> <span class=main>=</span> <span class=quoted><span class=skolem>α1''</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?T2</span></span></span> <span class=main>=</span> <span class=quoted><span class=skolem>α2''</span></span>

     <span class=comment1>(* apply the generalized zipping lemma *)</span>
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1 δ'E1_is_δ1'' validES1 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
              prefixclosed_def prefix_def<span class=main>)</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>          
          <span class=keyword1><span class=command>from</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2 δ'E2_is_δ2'' validES2 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
              prefixclosed_def prefix_def<span class=main>)</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> βv'α_in_Tr c_in_Cv_inter_Upsilon VIsViewOnE
            δ'_contains_only_δ1''_δ2''_events δ1''_in_E1star δ2''_in_E2star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> composeES_def isViewOn_def V_valid_def 
              VC_disjoint_def VN_disjoint_def NC_disjoint_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>unfolding</span></span> composeES_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span> 
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=var>?TAU</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> composeES_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?LAMBDA</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α1''_in_E1star α2''_in_E2star
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1 δ'E1_is_δ1'' 
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?T1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2 δ'E2_is_δ2'' 
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?T2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> α1''_in_E1star propSepViews 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute projection_intersection_neutral<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>note</span></span> α1'Vv1_is_αVv1 α1''Vv1_is_α1'Vv1
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> propSepViews 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> α2''_in_E2star propSepViews 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute projection_intersection_neutral<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>note</span></span> α2'Vv2_is_αVv2 α2''Vv2_is_α2'Vv2
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α1''Cv1_empty α2''Cv2_empty generalized_zipping_lemma
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t</span></span> <span class=comment1>(* show that the conclusion of FCI holds *)</span>
        <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>@</span> <span class=skolem>t</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?LAMBDA</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> δ'_contains_only_δ1''_δ2''_events 
            δ1''_in_N1_inter_Delta1star δ2''_in_N2_inter_Delta2star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>with</span></span> Delta1_N1_Delta2_N2_subset_Delta Nv1_union_Nv2_subsetof_Nv 
          <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>ultimately</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span> <span class=bound>γ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>γ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>γ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> 
                    <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> append_assoc<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
      <span class=keyword3><span class=command>assume</span></span> Nv2_inter_Delta2_inter_E1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span>  Nv1_inter_Delta1_inter_E2_subsetof_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>

      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?ALPHA1''_DELTA1''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α1''</span> <span class=bound>δ1''</span><span class=main>.</span> <span class=main>(</span>
        set <span class=bound>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> 
        <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>

      <span class=keyword1><span class=command>from</span></span> c_in_Cv_inter_Upsilon v'_in_Vv_inter_Nabla validV1
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
          VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> validES1 βv'E1α1'_in_Tr1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>from</span></span> βv'E1α1'_in_Tr1 c_notin_E1 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> α1'Cv1_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA1''_DELTA1''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>  v'_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> c_in_E1 c_in_Cv_inter_Upsilon propSepViews
          Upsilon_inter_E1_subset_Upsilon1
        <span class=keyword1><span class=command>have</span></span> c_in_Cv1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> βv'E1α1'_in_Tr1 v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α1'Cv1_empty
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span>Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span><span class=main>)</span>"</span></span> 
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> validES1 βv'E1α1'_in_Tr1 v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                prefixclosed_def prefix_def projection_concatenation_commute<span class=main>)</span>
            <span class=keyword1><span class=command>with</span></span> total_ES1_C1_inter_Upsilon1 c_in_Cv1_inter_Upsilon1
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> total_def<span class=main>)</span>
            <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>unfolding</span></span> Adm_def
              <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
          <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> BSIA1
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span>  <span class=skolem><span class=skolem>α1''</span></span>
          <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span>   <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

        <span class=keyword1><span class=command>from</span></span> one validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> one c_in_E1 v'_notin_E1 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> two three
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA1''_DELTA1''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>  v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> c_in_E1 c_in_Cv_inter_Upsilon propSepViews
          Upsilon_inter_E1_subset_Upsilon1
        <span class=keyword1><span class=command>have</span></span> c_in_Cv1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> v'_in_E1 propSepViews v'_in_Vv_inter_Nabla Nabla_inter_E1_subset_Nabla1
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Nabla <span class=free>Γ1</span>"</span></span>
         <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> v'_in_E1  βv'E1α1'_in_Tr1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α1'Cv1_empty FCI1
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ1''</span></span>
          <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> FCI_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

        <span class=keyword1><span class=command>from</span></span> two validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> one
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> two c_in_E1 v'_in_E1 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> three four
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA1''_DELTA1''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ1''</span></span>
        <span class=keyword2><span class=keyword>where</span></span> α1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ1''_in_N1_inter_Delta1star<span class=main>:</span><span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1<span class=main>:</span> 
        <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α1''Vv1_is_α1'Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>from</span></span> c_in_Cv_inter_Upsilon Upsilon_inter_E2_subset_Upsilon2 propSepViews 
      <span class=keyword1><span class=command>have</span></span> cE2_in_Cv2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
     
      <span class=keyword1><span class=command>from</span></span> δ1''_in_N1_inter_Delta1star Nv1_inter_Delta1_inter_E2_subsetof_Upsilon2 
        propSepViews disjoint_Nv1_Vv2 
      <span class=keyword1><span class=command>have</span></span> δ1''E2_in_Cv2_inter_Upsilon2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> δ1''_in_N1_inter_Delta1star <span class=keyword1><span class=command>have</span></span> eq<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute Int_left_commute Int_lower2 Int_lower1 
              projection_intersection_neutral subset_trans<span class=main>)</span>
          
          <span class=keyword1><span class=command>from</span></span> validV2 Nv1_inter_Delta1_inter_E2_subsetof_Upsilon2 
           propSepViews disjoint_Nv1_Vv2  
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
              VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> eq<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>qed</span></span>
      
      <span class=keyword1><span class=command>have</span></span> cδ1''E2_in_Cv2_inter_Upsilon2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> cE2_in_Cv2_inter_Upsilon2 δ1''E2_in_Cv2_inter_Upsilon2star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>


      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α2''</span> <span class=bound>δ2''</span><span class=main>.</span> set <span class=bound>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> set <span class=bound>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
        <span class=main>∧</span> <span class=bound>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>cases</span>
          <span class=keyword3><span class=command>assume</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>with</span></span> Nabla_inter_E2_subset_Nabla2 
            propSepViews v'_in_Vv_inter_Nabla
          <span class=keyword1><span class=command>have</span></span> v'_in_Vv2_inter_Nabla2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Nabla <span class=free>Γ2</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
            <span class=skolem>α2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
            <span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>;</span> set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
            <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α2''</span> <span class=bound>δ2''</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> 
              <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>            
            <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>            
            <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
            <span class=main>∧</span> <span class=bound>δ2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α2'</span></span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=skolem>δ1''</span></span><span class=main>)</span>
              <span class=keyword3><span class=command>case</span></span> 0

              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>2<span class=main>)</span> validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>2<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>3<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span> 
              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
            <span class=keyword1><span class=command>next</span></span>
              <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>μ</span></span> <span class=skolem><span class=skolem>c'</span></span> <span class=skolem><span class=skolem>ν</span></span>
                <span class=keyword2><span class=keyword>where</span></span> c'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> cδ1''_is_μc'ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>μ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> νE2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> n_is_length_μνE2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>μ</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

              <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> c'_in_E2 cδ1''_is_μc'ν 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>μ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ1''_is_μc'ν projection_concatenation_commute 
                  projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> c'_in_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> c'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
                  VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=skolem>μ</span></span><span class=main>)</span>
                  <span class=keyword3><span class=command>case</span></span> Nil <span class=comment1>(* we apply FCI in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ1''_is_μc'ν <span class=keyword1><span class=command>have</span></span> c_is_c'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>=</span> <span class=skolem>c'</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ1''_is_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> c'_in_Cv2_inter_Upsilon2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> v'_in_Vv2_inter_Nabla2
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> v'_in_E2 Suc<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>4<span class=main>)</span> FCI2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> FCI_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=comment1>(* we choose δ2'' = ν ↿ E<span class=hidden>⇘</span><sub>ES2</sub><span class=hidden>⇙</span> @ γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA2''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> two validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> one νE2_empty
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>from</span></span> v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>note</span></span> νE2_empty two
                      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> three four
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                              VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>with</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> one<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span>
                          <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>with</span></span> δ1''_is_ν νE2_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                <span class=keyword1><span class=command>next</span></span>
                  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span> <span class=comment1>(* we apply the inductive hypothesis in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ1''_is_μc'ν <span class=keyword1><span class=command>have</span></span> μ_is_c_xs<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>μ</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>xs</span>"</span></span> 
                    <span class=keyword2><span class=keyword>and</span></span> δ1''_is_xs_c'_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> n_is_length_μνE2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>3<span class=main>,</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> res<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span>"</span></span> 
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> cδ1''_is_μc'ν μ_is_c_xs νE2_empty
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> res<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ1''_is_μc'ν 
                          projection_concatenation_commute set_append<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>6<span class=main>)</span> 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> δ1''_is_xs_c'_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α2'</span></span><span class=main>]</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> five<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> six<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=comment1>(* apply FCI to insert c' after γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?BETA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span>

                  <span class=keyword1><span class=command>note</span></span> c'_in_Cv2_inter_Upsilon2 v'_in_Vv2_inter_Nabla2
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> three v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> five FCI2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ'</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> fci_one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fci_two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fci_three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fci_four<span class=main>:</span>  <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> FCI_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA2''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> fci_two validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv2_inter_Upsilon2 δ1''_is_xs_c'_ν 
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                      <span class=keyword1><span class=command>with</span></span> two fci_one <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> fci_two v'_in_E2 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> fci_three four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> fci_four
                  <span class=keyword1><span class=command>moreover</span></span>             
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> fci_one <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>e</span> <span class=main>∈</span> set <span class=skolem>δ'</span><span class=main>.</span> <span class=bound>e</span> <span class=main>∈</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                          <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>e</span> <span class=main>∈</span> set <span class=skolem>δ'</span><span class=main>.</span> <span class=bound>e</span> <span class=main>∉</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                              VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>with</span></span> c'_in_E2 c'_in_Cv2_inter_Upsilon2 δ1''_is_xs_c'_ν νE2_empty six 
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>     
                <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> βv'E2α2'_in_Tr2 α2'Cv2_empty cδ1''E2_in_Cv2_inter_Upsilon2star 
            c_in_Cv_inter_Upsilon δ1''_in_N1_inter_Delta1star<span class=main>]</span>
          <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ2''</span></span>
            <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>            
            <span class=main>∧</span> <span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

          <span class=keyword1><span class=command>note</span></span> one two three
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
            <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
              <span class=keyword1><span class=command>from</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> two<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> 
                Nv2_inter_Delta2_inter_E1_empty validV1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_Un_distrib2<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> validV1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
                  VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
              <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
              <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_commute<span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> δ1''_in_N1_inter_Delta1star <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
            <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>next</span></span>
          <span class=keyword3><span class=command>assume</span></span> v'_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

          <span class=keyword1><span class=command>have</span></span> 
            <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>;</span> <span class=skolem>α2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> 
                set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>;</span> <span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>;</span>
                set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
            <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α2''</span> <span class=bound>δ2''</span><span class=main>.</span>
             <span class=main>(</span>set <span class=bound>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>            
             <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span> </sub><span class=hidden>⇙</span>            
             <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
            <span class=main>∧</span> <span class=bound>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α2'</span></span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=skolem>δ1''</span></span><span class=main>)</span>
               <span class=keyword3><span class=command>case</span></span> 0

              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>2<span class=main>)</span> validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>2<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>3<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span> 
              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
            <span class=keyword1><span class=command>next</span></span>
              <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>μ</span></span> <span class=skolem><span class=skolem>c'</span></span> <span class=skolem><span class=skolem>ν</span></span>
                <span class=keyword2><span class=keyword>where</span></span> c'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> cδ1''_is_μc'ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>μ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> νE2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> n_is_length_μνE2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>μ</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

              <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> c'_in_E2 cδ1''_is_μc'ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>μ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ1''_is_μc'ν projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> c'_in_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> c'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def
                  VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=skolem>μ</span></span><span class=main>)</span>
                  <span class=keyword3><span class=command>case</span></span> Nil <span class=comment1>(* we just apply BSIA in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ1''_is_μc'ν <span class=keyword1><span class=command>have</span></span> c_is_c'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>=</span> <span class=skolem>c'</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ1''_is_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> c'_in_Cv2_inter_Upsilon2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> v'_notin_E2 Suc<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_Cv2_inter_Upsilon2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>from</span></span> validES2 Suc<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                              projection_concatenation_commute 
                              prefixclosed_def prefix_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>note</span></span> total_ES2_C2_inter_Upsilon2
                          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>unfolding</span></span> total_def
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>                        
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> BSIA2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA2''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> one validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> νE2_empty
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E2 one v'_notin_E2 νE2_empty
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> two three
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> νE2_empty δ1''_is_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                <span class=keyword1><span class=command>next</span></span>
                  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span> <span class=comment1>(* apply inductive hypothesis, then BSIA *)</span>
                   <span class=keyword1><span class=command>with</span></span> cδ1''_is_μc'ν <span class=keyword1><span class=command>have</span></span> μ_is_c_xs<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>μ</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>xs</span>"</span></span> 
                     <span class=keyword2><span class=keyword>and</span></span> δ1''_is_xs_c'_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> n_is_length_μνE2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>3<span class=main>,</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> res<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span>"</span></span> 
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> cδ1''_is_μc'ν μ_is_c_xs νE2_empty
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> res<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ1''_is_μc'ν projection_concatenation_commute 
                          set_append<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>6<span class=main>)</span> 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> δ1''_is_xs_c'_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α2'</span></span><span class=main>]</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> five<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> six<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                  
                   <span class=comment1>(* apply BSIA to insert c' after γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?BETA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> c'_in_Cv2_inter_Upsilon2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> three v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> five 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=var>?BETA</span> <span class=skolem>c'</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> validES2 three <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
                              projection_concatenation_commute prefixclosed_def prefix_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>note</span></span> c'_in_Cv2_inter_Upsilon2 total_ES2_C2_inter_Upsilon2
                          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>unfolding</span></span> total_def
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>                        
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> BSIA2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> bsia_one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> bsia_two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> bsia_three<span class=main>:</span>  <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA2''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> bsia_one validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv2_inter_Upsilon2 δ1''_is_xs_c'_ν 
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                      <span class=keyword1><span class=command>with</span></span> two <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> bsia_one v'_notin_E2 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> bsia_two four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> bsia_three
                  <span class=keyword1><span class=command>moreover</span></span>             
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> validV1 Suc<span class=main>(</span>7<span class=main>)</span> δ1''_is_xs_c'_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                          VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                      <span class=keyword1><span class=command>with</span></span> c'_in_E2 c'_in_Cv2_inter_Upsilon2 δ1''_is_xs_c'_ν νE2_empty six 
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute 
                          projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>     
                <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> βv'E2α2'_in_Tr2 α2'Cv2_empty cδ1''E2_in_Cv2_inter_Upsilon2star 
            c_in_Cv_inter_Upsilon δ1''_in_N1_inter_Delta1star<span class=main>]</span>
          <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ2''</span></span>
        <span class=keyword2><span class=keyword>where</span></span> α2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ2''_in_N2_inter_Delta2star<span class=main>:</span><span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2<span class=main>:</span> 
        <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α2''Vv2_is_α2'Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ2''E1_is_δ1''E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>from</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2 βE1_cE1_δ1''_v'E1_α1''_in_Tr1 
        validES2 validES1
      <span class=keyword1><span class=command>have</span></span> δ2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp_all</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>with</span></span> δ2''E1_is_δ1''E2 merge_property<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>δ2''</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=skolem>δ1''</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ'</span></span>
        <span class=keyword2><span class=keyword>where</span></span> δ'E2_is_δ2''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ'E1_is_δ1''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ'_contains_only_δ2''_δ1''_events<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> set <span class=skolem>δ2''</span> <span class=main>∪</span> set <span class=skolem>δ1''</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> Let_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?TAU</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span>"</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?LAMBDA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?T2</span></span></span> <span class=main>=</span> <span class=quoted><span class=skolem>α2''</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?T1</span></span></span> <span class=main>=</span> <span class=quoted><span class=skolem>α1''</span></span>

     <span class=comment1>(* apply the generalized zipping lemma *)</span>
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2 δ'E2_is_δ2'' validES2 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
              prefixclosed_def prefix_def<span class=main>)</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>          
          <span class=keyword1><span class=command>from</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1 δ'E1_is_δ1'' validES1 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
              prefixclosed_def prefix_def<span class=main>)</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> βv'α_in_Tr c_in_Cv_inter_Upsilon VIsViewOnE δ'_contains_only_δ2''_δ1''_events 
            δ2''_in_E2star δ1''_in_E1star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> composeES_def isViewOn_def V_valid_def VC_disjoint_def 
              VN_disjoint_def NC_disjoint_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>unfolding</span></span> composeES_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span> 
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=var>?TAU</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> composeES_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?LAMBDA</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α2''_in_E2star α1''_in_E1star
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2 δ'E2_is_δ2'' 
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?T2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1 δ'E1_is_δ1'' 
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?T1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> propSepViews 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> α2''_in_E2star propSepViews
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute projection_intersection_neutral<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>note</span></span> α2'Vv2_is_αVv2 α2''Vv2_is_α2'Vv2
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> propSepViews
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def  <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> α1''_in_E1star propSepViews
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute projection_intersection_neutral<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>note</span></span> α1'Vv1_is_αVv1 α1''Vv1_is_α1'Vv1
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α2''Cv2_empty α1''Cv1_empty generalized_zipping_lemma
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t</span></span> <span class=comment1>(* show that the conclusion of FCI holds *)</span>
        <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>@</span> <span class=skolem>t</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?LAMBDA</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> δ'_contains_only_δ2''_δ1''_events δ2''_in_N2_inter_Delta2star
               δ1''_in_N1_inter_Delta1star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>with</span></span> Delta1_N1_Delta2_N2_subset_Delta Nv1_union_Nv2_subsetof_Nv <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span> <span class=bound>γ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>γ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>γ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> 
        <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> append_assoc<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span> <span class=bound>γ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>γ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>γ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> FCI_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(* Theorem 6.4.1 case 6 *)</span>
<span class=keyword1><span class=command>theorem</span></span> compositionality_FCIA<span class=main>:</span> 
  <span class=quoted><span class=quoted>"<span class=main>⟦</span> BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> BSIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span> total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span><span class=main>;</span>
  ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>;</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>;</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  <span class=main>(</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>)</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>;</span>
  <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>
  <span class=main>∨</span> <span class=main>(</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>  <span class=main>;</span>
  FCIA <span class=free>ρ1</span> <span class=free>Γ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> FCIA <span class=free>ρ2</span> <span class=free>Γ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
  <span class=main>⟹</span> FCIA <span class=free>ρ</span> <span class=free>Γ</span> <span class=free>𝒱</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
 <span class=keyword3><span class=command>assume</span></span> BSD1<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
    <span class=keyword2><span class=keyword>and</span></span> BSD2<span class=main>:</span> <span class=quoted><span class=quoted>"BSD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> BSIA1<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> BSIA2<span class=main>:</span> <span class=quoted><span class=quoted>"BSIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> ρ1v1_subset_ρv_inter_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> ρ2v2_subset_ρv_inter_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> total_ES1_C1_inter_Upsilon1_inter_N2_inter_Delta2<span class=main>:</span> 
     <span class=quoted><span class=quoted>"total <span class=free>ES1</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> total_ES2_C2_inter_Upsilon2_inter_N1_inter_Delta1<span class=main>:</span> 
     <span class=quoted><span class=quoted>"total <span class=free>ES2</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Nabla_inter_E1_subset_Nabla1<span class=main>:</span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Nabla_inter_E2_subset_Nabla2<span class=main>:</span> <span class=quoted><span class=quoted>"∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Upsilon_inter_E1_subset_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Upsilon_inter_E2_subset_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> Delta1_N1_Delta2_N2_subset_Delta<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>)</span> <span class=main>⊆</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> very_long_asm<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>
    <span class=main>∨</span> <span class=main>(</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> FCIA1<span class=main>:</span> <span class=quoted><span class=quoted>"FCIA <span class=free>ρ1</span> <span class=free>Γ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> FCIA2<span class=main>:</span> <span class=quoted><span class=quoted>"FCIA <span class=free>ρ2</span> <span class=free>Γ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

  <span class=keyword1><span class=command>{</span></span>
    <span class=keyword3><span class=command>fix</span></span> <span class=skolem>α</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=skolem>v'</span>
    <span class=keyword3><span class=command>assume</span></span> c_in_Cv_inter_Upsilon<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> v'_in_Vv_inter_Nabla<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> <span class=main>(</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> ∇<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βv'α_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword2><span class=keyword>and</span></span> αCv_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> Adm<span class=main>:</span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱</span> <span class=free>ρ</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>β</span> <span class=skolem>c</span>"</span></span>

    <span class=keyword1><span class=command>interpret</span></span> CSES1<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES1</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱1</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES1 validV1<span class=main>)</span>

    <span class=keyword1><span class=command>interpret</span></span> CSES2<span class=main>:</span> CompositionSupport <span class=quoted><span class=quoted>"<span class=free>ES2</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>𝒱2</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> propSepViews <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> CompositionSupport_def validES2 validV2<span class=main>)</span>

    <span class=keyword1><span class=command>from</span></span>  βv'α_in_Tr
    <span class=keyword1><span class=command>have</span></span>  βv'α_E1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> βv'α_E2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=main>(</span><span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> composeES_def<span class=main>)</span><span class=main><span class=keyword3>+</span></span>    

    <span class=keyword1><span class=command>from</span></span> CSES1.BSD_in_subsystem2<span class=main>[</span><span class=operator>OF</span> βv'α_E1_in_Tr1 BSD1<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> βv'E1α1'_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1'Vv1_is_αVv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α1'Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>from</span></span> CSES2.BSD_in_subsystem2<span class=main>[</span><span class=operator>OF</span> βv'α_E2_in_Tr2 BSD2<span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2'</span></span>
      <span class=keyword2><span class=keyword>where</span></span> βv'E2α2'_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2'Vv2_is_αVv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword2><span class=keyword>and</span></span> α2'Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

    <span class=keyword1><span class=command>note</span></span> very_long_asm
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
      <span class=keyword3><span class=command>assume</span></span> Nv1_inter_Delta1_inter_E2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span>  Nv2_inter_Delta2_inter_E1_subsetof_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>

      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?ALPHA2''_DELTA2''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α2''</span> <span class=bound>δ2''</span><span class=main>.</span> <span class=main>(</span>
        set <span class=bound>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> 
        <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>

      <span class=keyword1><span class=command>from</span></span> c_in_Cv_inter_Upsilon v'_in_Vv_inter_Nabla validV2
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> V_valid_def isViewOn_def 
          VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> validES2 βv'E2α2'_in_Tr2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>from</span></span> βv'E2α2'_in_Tr2 c_notin_E2 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> α2'Cv2_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA2''_DELTA2''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>  v'_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> c_in_E2 c_in_Cv_inter_Upsilon propSepViews
          Upsilon_inter_E2_subset_Upsilon2
        <span class=keyword1><span class=command>have</span></span> c_in_Cv2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> βv'E2α2'_in_Tr2 v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α2'Cv2_empty
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> Adm <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span>
            <span class=keyword2><span class=keyword>where</span></span> γρv_is_βρv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> γc_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> Adm_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

          <span class=keyword1><span class=command>from</span></span> c_in_E2 γc_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def composeES_def<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> γρv_is_βρv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
            <span class=keyword1><span class=command>with</span></span> ρ2v2_subset_ρv_inter_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_subset_iff γρv_is_βρv projection_subset_elim<span class=main>)</span>
            <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
          <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> Adm_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>  
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> BSIA2
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span>  <span class=skolem><span class=skolem>α2''</span></span>
          <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span>   <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

        <span class=keyword1><span class=command>from</span></span> one validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> one c_in_E2 v'_notin_E2 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> two three
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA2''_DELTA2''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>  v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> c_in_E2 c_in_Cv_inter_Upsilon propSepViews
          Upsilon_inter_E2_subset_Upsilon2
        <span class=keyword1><span class=command>have</span></span> c_in_Cv2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> v'_in_E2 propSepViews v'_in_Vv_inter_Nabla Nabla_inter_E2_subset_Nabla2
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Nabla <span class=free>Γ2</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> v'_in_E2  βv'E2α2'_in_Tr2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α2'Cv2_empty 
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> Adm <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span>
            <span class=keyword2><span class=keyword>where</span></span> γρv_is_βρv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> γc_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> Adm_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

          <span class=keyword1><span class=command>from</span></span> c_in_E2 γc_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def composeES_def<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> γρv_is_βρv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
            <span class=keyword1><span class=command>with</span></span> ρ2v2_subset_ρv_inter_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_subset_iff γρv_is_βρv projection_subset_elim<span class=main>)</span>
            <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
          <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> Adm_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>  
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> FCIA2
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ2''</span></span>
          <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> FCIA_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

        <span class=keyword1><span class=command>from</span></span> two validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> one
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> two c_in_E2 v'_in_E2 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> three four
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA2''_DELTA2''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ2''</span></span>
        <span class=keyword2><span class=keyword>where</span></span> α2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ2''_in_N2_inter_Delta2star<span class=main>:</span><span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2<span class=main>:</span>
              <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α2''Vv2_is_α2'Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>from</span></span> c_in_Cv_inter_Upsilon Upsilon_inter_E1_subset_Upsilon1 propSepViews
      <span class=keyword1><span class=command>have</span></span> cE1_in_Cv1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
     
      <span class=keyword1><span class=command>from</span></span> δ2''_in_N2_inter_Delta2star Nv2_inter_Delta2_inter_E1_subsetof_Upsilon1 
       propSepViews disjoint_Nv2_Vv1 
      <span class=keyword1><span class=command>have</span></span> δ2''E1_in_Cv1_inter_Upsilon1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> δ2''_in_N2_inter_Delta2star
          <span class=keyword1><span class=command>have</span></span> eq<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute Int_left_commute Int_lower1 Int_lower2 
              projection_intersection_neutral subset_trans<span class=main>)</span>
          
          <span class=keyword1><span class=command>from</span></span> validV1 Nv2_inter_Delta2_inter_E1_subsetof_Upsilon1 
            propSepViews disjoint_Nv2_Vv1  
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
              VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> eq<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>qed</span></span>
      
      <span class=keyword1><span class=command>have</span></span> cδ2''E1_in_Cv1_inter_Upsilon1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> cE1_in_Cv1_inter_Upsilon1 δ2''E1_in_Cv1_inter_Upsilon1star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>


        <span class=keyword1><span class=command>have</span></span> 
        <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α1''</span> <span class=bound>δ1''</span><span class=main>.</span> set <span class=bound>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
        <span class=main>∧</span> <span class=bound>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>cases</span>
          <span class=keyword3><span class=command>assume</span></span> v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>with</span></span> Nabla_inter_E1_subset_Nabla1 propSepViews v'_in_Vv_inter_Nabla
          <span class=keyword1><span class=command>have</span></span> v'_in_Vv1_inter_Nabla1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Nabla <span class=free>Γ1</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
            <span class=skolem>α1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
            <span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>;</span> set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
            Adm <span class=free>𝒱</span> <span class=free>ρ</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=main>⟧</span> 
            <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α1''</span> <span class=bound>δ1''</span><span class=main>.</span>
            <span class=main>(</span>set <span class=bound>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>            
            <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>            
            <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
            <span class=main>∧</span> <span class=bound>δ1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α1'</span></span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=skolem>δ2''</span></span><span class=main>)</span>
              <span class=keyword3><span class=command>case</span></span> 0

              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>2<span class=main>)</span> validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>2<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>3<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span> 
              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
            <span class=keyword1><span class=command>next</span></span>
              <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>μ</span></span> <span class=skolem><span class=skolem>c'</span></span> <span class=skolem><span class=skolem>ν</span></span>
                <span class=keyword2><span class=keyword>where</span></span> c'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> cδ2''_is_μc'ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>μ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> νE1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> n_is_length_μνE1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>μ</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

              <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> c'_in_E1 cδ2''_is_μc'ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>μ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ2''_is_μc'ν projection_concatenation_commute 
                  projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> c'_in_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> c'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
                  VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=skolem>μ</span></span><span class=main>)</span>
                  <span class=keyword3><span class=command>case</span></span> Nil <span class=comment1>(* we apply FCIA in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ2''_is_μc'ν <span class=keyword1><span class=command>have</span></span> c_is_c'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>=</span> <span class=skolem>c'</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ2''_is_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> c'_in_Cv1_inter_Upsilon1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> v'_in_Vv1_inter_Nabla1
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> v'_in_E1 Suc<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>8<span class=main>)</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span>
                        <span class=keyword2><span class=keyword>where</span></span> γρv_is_βρv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
                        <span class=keyword2><span class=keyword>and</span></span> γc_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E1 γc_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def composeES_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                        <span class=keyword1><span class=command>from</span></span> γρv_is_βρv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
                        <span class=keyword1><span class=command>with</span></span> ρ1v1_subset_ρv_inter_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_subset_iff γρv_is_βρv projection_subset_elim<span class=main>)</span>
                        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
                      <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>  
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> FCIA1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> FCIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=comment1>(* we choose δ1'' = ν ↿ E<span class=hidden>⇘</span><sub>ES1</sub><span class=hidden>⇙</span> @ γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA1''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span> 
                    
                  <span class=keyword1><span class=command>from</span></span> two validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> one νE1_empty
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>from</span></span> v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>note</span></span> νE1_empty two
                      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> three four
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                              VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>with</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> one<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span>
                          <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>with</span></span> δ2''_is_ν νE1_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                <span class=keyword1><span class=command>next</span></span>
                  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span> <span class=comment1>(* we apply the inductive hypothesis in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ2''_is_μc'ν
                  <span class=keyword1><span class=command>have</span></span> μ_is_c_xs<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>μ</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>xs</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ2''_is_xs_c'_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> n_is_length_μνE1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>3<span class=main>,</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> res<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span>"</span></span> 
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> cδ2''_is_μc'ν μ_is_c_xs νE1_empty
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> res<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ2''_is_μc'ν 
                          projection_concatenation_commute set_append<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>6<span class=main>)</span> 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> δ2''_is_xs_c'_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>8<span class=main>)</span> Suc<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α1'</span></span><span class=main>]</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> five<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> six<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=comment1>(* apply FCIA to insert c' after γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?BETA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span>

                  <span class=keyword1><span class=command>note</span></span> c'_in_Cv1_inter_Upsilon1 v'_in_Vv1_inter_Nabla1
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> three v'_in_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> five 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=var>?BETA</span> <span class=skolem>c'</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv1_inter_Upsilon1 δ2''_is_xs_c'_ν
                          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>from</span></span> validES1 three <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold</span> ES_valid_def traces_prefixclosed_def
                              prefixclosed_def prefix_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>note</span></span> total_ES1_C1_inter_Upsilon1_inter_N2_inter_Delta2
                          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>unfolding</span></span> total_def
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>                        
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> FCIA1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ'</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> fcia_one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fcia_two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fcia_three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fcia_four<span class=main>:</span>  <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> FCIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA1''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> fcia_two validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv1_inter_Upsilon1 δ2''_is_xs_c'_ν 
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                      <span class=keyword1><span class=command>with</span></span> two fcia_one <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> fcia_two v'_in_E1 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> fcia_three four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> fcia_four
                  <span class=keyword1><span class=command>moreover</span></span>             
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> fcia_one <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>e</span> <span class=main>∈</span> set <span class=skolem>δ'</span><span class=main>.</span> <span class=bound>e</span> <span class=main>∈</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                          <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>e</span> <span class=main>∈</span> set <span class=skolem>δ'</span><span class=main>.</span> <span class=bound>e</span> <span class=main>∉</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                              VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>with</span></span> c'_in_E1 c'_in_Cv1_inter_Upsilon1 δ2''_is_xs_c'_ν νE1_empty six 
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>     
                <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> βv'E1α1'_in_Tr1 α1'Cv1_empty cδ2''E1_in_Cv1_inter_Upsilon1star 
            c_in_Cv_inter_Upsilon δ2''_in_N2_inter_Delta2star Adm<span class=main>]</span>
          <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ1''</span></span>
            <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>            
            <span class=main>∧</span> <span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

          <span class=keyword1><span class=command>note</span></span> one two three
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> 
            <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
              <span class=keyword1><span class=command>from</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> two<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> 
                Nv1_inter_Delta1_inter_E2_empty validV2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_Un_distrib2<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> validV2 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def  V_valid_def  VC_disjoint_def 
                  VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
              <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
              <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_commute<span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> δ2''_in_N2_inter_Delta2star <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
            <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>next</span></span>
          <span class=keyword3><span class=command>assume</span></span> v'_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

           <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
            <span class=skolem>α1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
             <span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>;</span> set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>;</span>
            Adm <span class=free>𝒱</span> <span class=free>ρ</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=main>⟧</span> 
            <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α1''</span> <span class=bound>δ1''</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> 
             <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>            
             <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>            
             <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
            <span class=main>∧</span> <span class=bound>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α1'</span></span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=skolem>δ2''</span></span><span class=main>)</span>
               <span class=keyword3><span class=command>case</span></span> 0

              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>2<span class=main>)</span> validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>2<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>3<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span> 
              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
            <span class=keyword1><span class=command>next</span></span>
              <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>μ</span></span> <span class=skolem><span class=skolem>c'</span></span> <span class=skolem><span class=skolem>ν</span></span>
                <span class=keyword2><span class=keyword>where</span></span> c'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> cδ2''_is_μc'ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>μ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> νE1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> n_is_length_μνE1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>μ</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

              <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> c'_in_E1 cδ2''_is_μc'ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>μ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ2''_is_μc'ν projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> c'_in_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> validV1 <span class=keyword1><span class=command>have</span></span> c'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def V_valid_def VC_disjoint_def 
                  VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=skolem>μ</span></span><span class=main>)</span>
                  <span class=keyword3><span class=command>case</span></span> Nil <span class=comment1>(* we just apply BSIA in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ2''_is_μc'ν <span class=keyword1><span class=command>have</span></span> c_is_c'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>=</span> <span class=skolem>c'</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ2''_is_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> c'_in_Cv1_inter_Upsilon1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> v'_notin_E1 Suc<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span>"</span></span>
                     <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>8<span class=main>)</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span>
                        <span class=keyword2><span class=keyword>where</span></span> γρv_is_βρv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
                        <span class=keyword2><span class=keyword>and</span></span> γc_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E1 γc_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def composeES_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                        <span class=keyword1><span class=command>from</span></span> γρv_is_βρv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
                        <span class=keyword1><span class=command>with</span></span> ρ1v1_subset_ρv_inter_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_subset_iff γρv_is_βρv projection_subset_elim<span class=main>)</span>
                        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
                      <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>  
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> BSIA1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA1''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> one validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> νE1_empty
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E1 one v'_notin_E1 νE1_empty
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> two three
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> νE1_empty δ2''_is_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                <span class=keyword1><span class=command>next</span></span>
                  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span> <span class=comment1>(* apply inductive hypothesis, then BSIA *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ2''_is_μc'ν
                  <span class=keyword1><span class=command>have</span></span> μ_is_c_xs<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>μ</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>xs</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ2''_is_xs_c'_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> n_is_length_μνE1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>3<span class=main>,</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> res<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span>"</span></span> 
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> cδ2''_is_μc'ν μ_is_c_xs νE1_empty
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> res<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ2''_is_μc'ν projection_concatenation_commute 
                          set_append<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>6<span class=main>)</span> 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> δ2''_is_xs_c'_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>8<span class=main>)</span> Suc<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α1'</span></span><span class=main>]</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> five<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> six<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                  
                   <span class=comment1>(* apply BSIA to insert c' after γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?BETA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> c'_in_Cv1_inter_Upsilon1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> three v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> five 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=var>?BETA</span> <span class=skolem>c'</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv1_inter_Upsilon1 δ2''_is_xs_c'_ν
                          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>from</span></span> validES1 three <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold</span> ES_valid_def traces_prefixclosed_def
                              prefixclosed_def prefix_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>note</span></span> total_ES1_C1_inter_Upsilon1_inter_N2_inter_Delta2
                          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>unfolding</span></span> total_def
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>                      
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> BSIA1
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> bsia_one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> bsia_two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> bsia_three<span class=main>:</span>  <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA1''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> bsia_one validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv1_inter_Upsilon1 δ2''_is_xs_c'_ν 
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                      <span class=keyword1><span class=command>with</span></span> two <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> bsia_one v'_notin_E1 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> bsia_two four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> bsia_three
                  <span class=keyword1><span class=command>moreover</span></span>             
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> validV2 Suc<span class=main>(</span>7<span class=main>)</span> δ2''_is_xs_c'_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                          VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                      <span class=keyword1><span class=command>with</span></span> c'_in_E1 c'_in_Cv1_inter_Upsilon1 δ2''_is_xs_c'_ν νE1_empty six 
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>     
                <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> βv'E1α1'_in_Tr1 α1'Cv1_empty cδ2''E1_in_Cv1_inter_Upsilon1star 
            c_in_Cv_inter_Upsilon δ2''_in_N2_inter_Delta2star Adm<span class=main>]</span>
          <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ1''</span></span>
        <span class=keyword2><span class=keyword>where</span></span> α1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ1''_in_N1_inter_Delta1star<span class=main>:</span><span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1<span class=main>:</span> 
          <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α1''Vv1_is_α1'Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ1''E2_is_δ2''E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>from</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1 βE2_cE2_δ2''_v'E2_α2''_in_Tr2 validES1 
        validES2
      <span class=keyword1><span class=command>have</span></span> δ1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp_all</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>with</span></span> δ1''E2_is_δ2''E1 merge_property<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>δ1''</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=skolem>δ2''</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ'</span></span>
        <span class=keyword2><span class=keyword>where</span></span> δ'E1_is_δ1''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ'E2_is_δ2''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ'_contains_only_δ1''_δ2''_events<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> set <span class=skolem>δ1''</span> <span class=main>∪</span> set <span class=skolem>δ2''</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> Let_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?TAU</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span>"</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?LAMBDA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?T1</span></span></span> <span class=main>=</span> <span class=quoted><span class=skolem>α1''</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?T2</span></span></span> <span class=main>=</span> <span class=quoted><span class=skolem>α2''</span></span>

     <span class=comment1>(* apply the generalized zipping lemma *)</span>
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1 δ'E1_is_δ1'' validES1
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
              prefixclosed_def prefix_def<span class=main>)</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>          
          <span class=keyword1><span class=command>from</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2 δ'E2_is_δ2'' validES2 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
              prefixclosed_def prefix_def<span class=main>)</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> βv'α_in_Tr c_in_Cv_inter_Upsilon VIsViewOnE δ'_contains_only_δ1''_δ2''_events 
            δ1''_in_E1star δ2''_in_E2star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> composeES_def isViewOn_def V_valid_def 
              VC_disjoint_def VN_disjoint_def NC_disjoint_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>unfolding</span></span> composeES_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span> 
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=var>?TAU</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> composeES_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?LAMBDA</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α1''_in_E1star α2''_in_E2star
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1 δ'E1_is_δ1'' 
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?T1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2 δ'E2_is_δ2'' 
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?T2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> α1''_in_E1star propSepViews 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute projection_intersection_neutral<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>note</span></span> α1'Vv1_is_αVv1 α1''Vv1_is_α1'Vv1
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> α2''_in_E2star propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute projection_intersection_neutral<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>note</span></span> α2'Vv2_is_αVv2 α2''Vv2_is_α2'Vv2
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α1''Cv1_empty α2''Cv2_empty generalized_zipping_lemma
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t</span></span> <span class=comment1>(* show that the conclusion of FCIA holds *)</span>
        <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>@</span> <span class=skolem>t</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?LAMBDA</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> δ'_contains_only_δ1''_δ2''_events δ1''_in_N1_inter_Delta1star 
            δ2''_in_N2_inter_Delta2star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>with</span></span> Delta1_N1_Delta2_N2_subset_Delta Nv1_union_Nv2_subsetof_Nv 
          <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span> <span class=bound>γ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>γ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>γ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> 
        <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> append_assoc<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
      <span class=keyword3><span class=command>assume</span></span> Nv2_inter_Delta2_inter_E1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>{}</span>"</span></span> 
        <span class=keyword2><span class=keyword>and</span></span>  Nv1_inter_Delta1_inter_E2_subsetof_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>

      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?ALPHA1''_DELTA1''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α1''</span> <span class=bound>δ1''</span><span class=main>.</span> <span class=main>(</span>
        set <span class=bound>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> 
        <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> 
        <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>

      <span class=keyword1><span class=command>from</span></span> c_in_Cv_inter_Upsilon v'_in_Vv_inter_Nabla validV1
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>∨</span> <span class=main>(</span><span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
          VN_disjoint_def NC_disjoint_def<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> validES1 βv'E1α1'_in_Tr1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>from</span></span> βv'E1α1'_in_Tr1 c_notin_E1 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> α1'Cv1_empty
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA1''_DELTA1''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>  v'_notin_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> c_in_E1 c_in_Cv_inter_Upsilon propSepViews
          Upsilon_inter_E1_subset_Upsilon1
        <span class=keyword1><span class=command>have</span></span> c_in_Cv1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> βv'E1α1'_in_Tr1 v'_notin_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α1'Cv1_empty
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> Adm <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span>
            <span class=keyword2><span class=keyword>where</span></span> γρv_is_βρv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> γc_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> Adm_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

          <span class=keyword1><span class=command>from</span></span> c_in_E1 γc_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def composeES_def<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> γρv_is_βρv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
            <span class=keyword1><span class=command>with</span></span> ρ1v1_subset_ρv_inter_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_subset_iff γρv_is_βρv projection_subset_elim<span class=main>)</span>
            <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
          <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> Adm_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>  
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> BSIA1
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span>  <span class=skolem><span class=skolem>α1''</span></span>
          <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span>   <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

        <span class=keyword1><span class=command>from</span></span> one validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> one c_in_E1 v'_notin_E1 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span> 
        <span class=keyword1><span class=command>note</span></span> two three
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA1''_DELTA1''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
        <span class=keyword3><span class=command>assume</span></span> c_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span>  v'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>

        <span class=keyword1><span class=command>from</span></span> c_in_E1 c_in_Cv_inter_Upsilon propSepViews
          Upsilon_inter_E1_subset_Upsilon1
        <span class=keyword1><span class=command>have</span></span> c_in_Cv1_inter_Upsilon1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> v'_in_E1 propSepViews v'_in_Vv_inter_Nabla 
          Nabla_inter_E1_subset_Nabla1
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Nabla <span class=free>Γ1</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> v'_in_E1  βv'E1α1'_in_Tr1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> α1'Cv1_empty 
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱1</span> <span class=free>ρ1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> Adm <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span>
            <span class=keyword2><span class=keyword>where</span></span> γρv_is_βρv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> γc_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> Adm_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

          <span class=keyword1><span class=command>from</span></span> c_in_E1 γc_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def composeES_def<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span>
          <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
            <span class=keyword1><span class=command>from</span></span> γρv_is_βρv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
            <span class=keyword1><span class=command>with</span></span> ρ1v1_subset_ρv_inter_E1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_subset_iff γρv_is_βρv projection_subset_elim<span class=main>)</span>
            <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
          <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> Adm_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>  
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> FCIA1
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ1''</span></span>
          <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
          <span class=keyword1><span class=command>unfolding</span></span> FCIA_def
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

        <span class=keyword1><span class=command>from</span></span> two validES1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> one
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>from</span></span> two c_in_E1 v'_in_E1 
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>note</span></span> three four
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=var><span class=quoted><span class=var>?ALPHA1''_DELTA1''</span></span></span>
          <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>}</span></span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α1''</span></span> <span class=skolem><span class=skolem>δ1''</span></span>
        <span class=keyword2><span class=keyword>where</span></span> α1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ1''_in_N1_inter_Delta1star<span class=main>:</span><span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1<span class=main>:</span> 
          <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ1''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α1''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α1''Vv1_is_α1'Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α1''Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α1''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>from</span></span> c_in_Cv_inter_Upsilon Upsilon_inter_E2_subset_Upsilon2 propSepViews
      <span class=keyword1><span class=command>have</span></span> cE2_in_Cv2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
     
      <span class=keyword1><span class=command>from</span></span> δ1''_in_N1_inter_Delta1star Nv1_inter_Delta1_inter_E2_subsetof_Upsilon2 
       propSepViews disjoint_Nv1_Vv2 
      <span class=keyword1><span class=command>have</span></span> δ1''E2_in_Cv2_inter_Upsilon2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> δ1''_in_N1_inter_Delta1star 
          <span class=keyword1><span class=command>have</span></span> eq<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute Int_left_commute Int_lower2 Int_lower1 
              projection_intersection_neutral subset_trans<span class=main>)</span>
          
          <span class=keyword1><span class=command>from</span></span> validV2 Nv1_inter_Delta1_inter_E2_subsetof_Upsilon2 
            propSepViews disjoint_Nv1_Vv2  
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def 
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
              VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> eq<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
        <span class=keyword1><span class=command>qed</span></span>
      
      <span class=keyword1><span class=command>have</span></span> cδ1''E2_in_Cv2_inter_Upsilon2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> cE2_in_Cv2_inter_Upsilon2 δ1''E2_in_Cv2_inter_Upsilon2star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>


      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span> <span class=bound>α2''</span> <span class=bound>δ2''</span><span class=main>.</span> set <span class=bound>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> set <span class=bound>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>        
        <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
        <span class=main>∧</span> <span class=bound>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>cases</span>
          <span class=keyword3><span class=command>assume</span></span> v'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
          <span class=keyword1><span class=command>with</span></span> Nabla_inter_E2_subset_Nabla2 propSepViews v'_in_Vv_inter_Nabla
          <span class=keyword1><span class=command>have</span></span> v'_in_Vv2_inter_Nabla2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∈</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Nabla <span class=free>Γ2</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
            <span class=skolem>α2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
            <span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>;</span> set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>;</span>
            Adm <span class=free>𝒱</span> <span class=free>ρ</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=main>⟧</span> 
            <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α2''</span> <span class=bound>δ2''</span><span class=main>.</span>
           <span class=main>(</span>set <span class=bound>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>            
            <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>            
            <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
            <span class=main>∧</span> <span class=bound>δ2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α2'</span></span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=skolem>δ1''</span></span><span class=main>)</span>
              <span class=keyword3><span class=command>case</span></span> 0

              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>2<span class=main>)</span> validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>2<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>3<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span> 
              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
            <span class=keyword1><span class=command>next</span></span>
              <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>μ</span></span> <span class=skolem><span class=skolem>c'</span></span> <span class=skolem><span class=skolem>ν</span></span>
                <span class=keyword2><span class=keyword>where</span></span> c'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> cδ1''_is_μc'ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>μ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> νE2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> n_is_length_μνE2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>μ</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

              <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> c'_in_E2 cδ1''_is_μc'ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>μ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ1''_is_μc'ν projection_concatenation_commute 
                  projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> c'_in_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> c'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                  VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=skolem>μ</span></span><span class=main>)</span>
                  <span class=keyword3><span class=command>case</span></span> Nil <span class=comment1>(* we apply FCIA in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ1''_is_μc'ν <span class=keyword1><span class=command>have</span></span> c_is_c'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>=</span> <span class=skolem>c'</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ1''_is_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> c'_in_Cv2_inter_Upsilon2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> v'_in_Vv2_inter_Nabla2
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> v'_in_E2 Suc<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>8<span class=main>)</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span>
                        <span class=keyword2><span class=keyword>where</span></span> γρv_is_βρv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
                        <span class=keyword2><span class=keyword>and</span></span> γc_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E2 γc_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def composeES_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                        <span class=keyword1><span class=command>from</span></span> γρv_is_βρv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
                        <span class=keyword1><span class=command>with</span></span> ρ2v2_subset_ρv_inter_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_subset_iff γρv_is_βρv projection_subset_elim<span class=main>)</span>
                        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
                      <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>  
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> FCIA2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> FCIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=comment1>(* we choose δ2'' = ν ↿ E<span class=hidden>⇘</span><sub>ES2</sub><span class=hidden>⇙</span> @ γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA2''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span> 
                    
                  <span class=keyword1><span class=command>from</span></span> two validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> one νE2_empty
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>from</span></span> v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>note</span></span> νE2_empty two
                      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> three four
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>{}</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def
                              VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>with</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> one<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span>
                          <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>with</span></span> δ1''_is_ν νE2_empty <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                <span class=keyword1><span class=command>next</span></span>
                  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span> <span class=comment1>(* we apply the inductive hypothesis in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ1''_is_μc'ν
                  <span class=keyword1><span class=command>have</span></span> μ_is_c_xs<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>μ</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>xs</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ1''_is_xs_c'_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> n_is_length_μνE2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>3<span class=main>,</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> res<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span>"</span></span> 
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> cδ1''_is_μc'ν μ_is_c_xs νE2_empty
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> res<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ1''_is_μc'ν 
                          projection_concatenation_commute set_append<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>6<span class=main>)</span> 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> δ1''_is_xs_c'_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>8<span class=main>)</span> Suc<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α2'</span></span><span class=main>]</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> five<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> six<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=comment1>(* apply FCIA to insert c' after γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?BETA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span>

                  <span class=keyword1><span class=command>note</span></span> c'_in_Cv2_inter_Upsilon2 v'_in_Vv2_inter_Nabla2
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> three v'_in_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> five 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=var>?BETA</span> <span class=skolem>c'</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv2_inter_Upsilon2 δ1''_is_xs_c'_ν
                          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>from</span></span> validES2 three <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold</span> ES_valid_def traces_prefixclosed_def
                              prefixclosed_def prefix_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>note</span></span> total_ES2_C2_inter_Upsilon2_inter_N1_inter_Delta1
                          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>unfolding</span></span> total_def
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>                        
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> FCIA2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ'</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> fcia_one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fcia_two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fcia_three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> fcia_four<span class=main>:</span>  <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> FCIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA2''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> fcia_two validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv2_inter_Upsilon2 δ1''_is_xs_c'_ν 
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                      <span class=keyword1><span class=command>with</span></span> two fcia_one <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> fcia_two v'_in_E2 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> fcia_three four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> fcia_four
                  <span class=keyword1><span class=command>moreover</span></span>             
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> fcia_one <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>e</span> <span class=main>∈</span> set <span class=skolem>δ'</span><span class=main>.</span> <span class=bound>e</span> <span class=main>∈</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                          <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∀</span> <span class=bound>e</span> <span class=main>∈</span> set <span class=skolem>δ'</span><span class=main>.</span> <span class=bound>e</span> <span class=main>∉</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def V_valid_def 
                              VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>with</span></span> c'_in_E2 c'_in_Cv2_inter_Upsilon2 δ1''_is_xs_c'_ν νE2_empty six 
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>     
                <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> βv'E2α2'_in_Tr2 α2'Cv2_empty 
            cδ1''E2_in_Cv2_inter_Upsilon2star c_in_Cv_inter_Upsilon δ1''_in_N1_inter_Delta1star Adm<span class=main>]</span>
          <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ2''</span></span>
            <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>            
            <span class=main>∧</span> <span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
            <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

          <span class=keyword1><span class=command>note</span></span> one two three
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> 
            <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
              <span class=keyword1><span class=command>from</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> two<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> 
                Nv2_inter_Delta2_inter_E1_empty validV1 
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> Int_Un_distrib2<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>from</span></span> validV1
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def VC_disjoint_def 
                  VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
              <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span> <span class=main>↿</span> <span class=main>(</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
              <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> <span class=main>(</span>N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_commute<span class=main>)</span>
              <span class=keyword1><span class=command>with</span></span> δ1''_in_N1_inter_Delta1star <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> list_subset_iff_projection_neutral<span class=main>)</span>
            <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>next</span></span>
          <span class=keyword3><span class=command>assume</span></span> v'_notin_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>v'</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

           <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>⟦</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
            <span class=skolem>α2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>;</span> set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>;</span> 
             <span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>;</span> set <span class=skolem>δ1''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span><span class=main>;</span>
            Adm <span class=free>𝒱</span> <span class=free>ρ</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>β</span> <span class=skolem>c</span> <span class=main>⟧</span> 
            <span class=main>⟹</span> <span class=main>∃</span> <span class=bound>α2''</span> <span class=bound>δ2''</span><span class=main>.</span>
             <span class=main>(</span>set <span class=bound>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> set <span class=bound>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>            
             <span class=main>∧</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=bound>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>            
             <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>
            <span class=main>∧</span> <span class=bound>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
            <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=quoted>"length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α2'</span></span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=skolem>δ1''</span></span><span class=main>)</span>
               <span class=keyword3><span class=command>case</span></span> 0

              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>2<span class=main>)</span> validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[]</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                  <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>2<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∉</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                <span class=keyword1><span class=command>qed</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
              <span class=keyword1><span class=command>moreover</span></span>
              <span class=keyword1><span class=command>note</span></span> 0<span class=main>(</span>3<span class=main>)</span>
              <span class=keyword1><span class=command>moreover</span></span> 
              <span class=keyword1><span class=command>from</span></span> 0<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>split</span> if_split_asm<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
            <span class=keyword1><span class=command>next</span></span>
              <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>

              <span class=keyword1><span class=command>from</span></span> projection_split_last<span class=main>[</span><span class=operator>OF</span> Suc<span class=main><span class=main>(</span></span>2<span class=main><span class=main>)</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>μ</span></span> <span class=skolem><span class=skolem>c'</span></span> <span class=skolem><span class=skolem>ν</span></span>
                <span class=keyword2><span class=keyword>where</span></span> c'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> cδ1''_is_μc'ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>μ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> νE2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                <span class=keyword2><span class=keyword>and</span></span> n_is_length_μνE2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>μ</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

              <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> c'_in_E2 cδ1''_is_μc'ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>μ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ1''_is_μc'ν projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv2_inter_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>hence</span></span> c'_in_Cv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> c'_in_Upsilon2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
              <span class=keyword1><span class=command>with</span></span> validV2 <span class=keyword1><span class=command>have</span></span> c'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def V_valid_def 
                  VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>

              <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
                <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=skolem>μ</span></span><span class=main>)</span>
                  <span class=keyword3><span class=command>case</span></span> Nil <span class=comment1>(* we just apply BSIA in this case *)</span>
                  <span class=keyword1><span class=command>with</span></span> cδ1''_is_μc'ν <span class=keyword1><span class=command>have</span></span> c_is_c'<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>=</span> <span class=skolem>c'</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ1''_is_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> c'_in_Cv2_inter_Upsilon2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> v'_notin_E2 Suc<span class=main>(</span>3<span class=main>)</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=skolem>α2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=skolem>c</span>"</span></span>
                     <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>8<span class=main>)</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>γ</span></span>
                        <span class=keyword2><span class=keyword>where</span></span> γρv_is_βρv<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
                        <span class=keyword2><span class=keyword>and</span></span> γc_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span><span class=main>)</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E2 γc_in_Tr <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def composeES_def<span class=main>)</span>
                      <span class=keyword1><span class=command>moreover</span></span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span>
                      <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                        <span class=keyword1><span class=command>from</span></span> γρv_is_βρv <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
                        <span class=keyword1><span class=command>with</span></span> ρ2v2_subset_ρv_inter_E2 
                        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>β</span> <span class=main>↿</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_subset_iff γρv_is_βρv projection_subset_elim<span class=main>)</span>
                        <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                          <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> projection_commute<span class=main>)</span>
                      <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>  
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> BSIA2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA2''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>ν</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> one validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> νE2_empty
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> c_is_c' c'_in_E2 one v'_notin_E2 νE2_empty
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> two three
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> νE2_empty δ1''_is_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                <span class=keyword1><span class=command>next</span></span>
                  <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Cons <span class=skolem>x</span> <span class=skolem>xs</span><span class=main>)</span> <span class=comment1>(* apply inductive hypothesis, then BSIA *)</span>
                   <span class=keyword1><span class=command>with</span></span> cδ1''_is_μc'ν <span class=keyword1><span class=command>have</span></span> μ_is_c_xs<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>μ</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>xs</span>"</span></span> 
                     <span class=keyword2><span class=keyword>and</span></span> δ1''_is_xs_c'_ν<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ1''</span> <span class=main>=</span> <span class=skolem>xs</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>with</span></span> n_is_length_μνE2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>=</span> length <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>3<span class=main>,</span>4<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=main>(</span><span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> res<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>c</span> <span class=main>#</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>=</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span>"</span></span> 
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>5<span class=main>)</span> cδ1''_is_μc'ν μ_is_c_xs νE2_empty
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>subst</span> res<span class=main><span class=keyword3>,</span></span> <span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> cδ1''_is_μc'ν 
                          projection_concatenation_commute set_append<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>6<span class=main>)</span> 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> δ1''_is_xs_c'_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>note</span></span> Suc<span class=main>(</span>8<span class=main>)</span> Suc<span class=main>(</span>1<span class=main>)</span><span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>c</span></span> <span class=quoted><span class=quoted>"<span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span>"</span></span> <span class=quoted><span class=skolem>β</span></span> <span class=quoted><span class=skolem>α2'</span></span><span class=main>]</span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ</span></span> <span class=skolem><span class=skolem>γ</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> one<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> two<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>γ</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> three<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> four<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> five<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> six<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>(</span><span class=skolem>xs</span> <span class=main>@</span> <span class=skolem>ν</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                  
                   <span class=comment1>(* apply BSIA to insert c' after γ *)</span>
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?BETA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>γ</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> c'_in_Cv2_inter_Upsilon2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> three v'_notin_E2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=skolem>δ</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> five 
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Adm <span class=free>𝒱2</span> <span class=free>ρ2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=var>?BETA</span> <span class=skolem>c'</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                          <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv2_inter_Upsilon2 δ1''_is_xs_c'_ν
                          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>from</span></span> validES2 three <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold</span> ES_valid_def traces_prefixclosed_def
                              prefixclosed_def prefix_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                          <span class=keyword1><span class=command>moreover</span></span>
                          <span class=keyword1><span class=command>note</span></span> total_ES2_C2_inter_Upsilon2_inter_N1_inter_Delta1
                          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                            <span class=keyword1><span class=command>unfolding</span></span> total_def
                            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
                        <span class=keyword1><span class=command>qed</span></span>
                      <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>unfolding</span></span> Adm_def
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>                      
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> BSIA2
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span>
                    <span class=keyword2><span class=keyword>where</span></span> bsia_one<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=var>?BETA</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> bsia_two<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword2><span class=keyword>and</span></span> bsia_three<span class=main>:</span>  <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
                    <span class=keyword1><span class=command>unfolding</span></span> BSIA_def
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  
                  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?DELTA2''</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>γ</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c'</span><span class=main>]</span>"</span></span>

                  <span class=keyword1><span class=command>from</span></span> bsia_one validES2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?DELTA2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> Suc<span class=main>(</span>7<span class=main>)</span> c'_in_Cv2_inter_Upsilon2 δ1''_is_xs_c'_ν 
                      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span>  C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                      <span class=keyword1><span class=command>with</span></span> two <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> bsia_one v'_notin_E2 
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?DELTA2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>from</span></span> bsia_two four <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
                  <span class=keyword1><span class=command>moreover</span></span>
                  <span class=keyword1><span class=command>note</span></span> bsia_three
                  <span class=keyword1><span class=command>moreover</span></span>             
                  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?DELTA2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
                    <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
                      <span class=keyword1><span class=command>from</span></span> validV1 Suc<span class=main>(</span>7<span class=main>)</span> δ1''_is_xs_c'_ν <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>c'</span> <span class=main>∈</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                          VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                      <span class=keyword1><span class=command>with</span></span> c'_in_E2 c'_in_Cv2_inter_Upsilon2 δ1''_is_xs_c'_ν νE2_empty six 
                      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
                        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
                    <span class=keyword1><span class=command>qed</span></span>
                  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
                    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>     
                <span class=keyword1><span class=command>qed</span></span>
            <span class=keyword1><span class=command>qed</span></span>
          <span class=keyword1><span class=command>from</span></span> this<span class=main>[</span><span class=operator>OF</span> βv'E2α2'_in_Tr2 α2'Cv2_empty cδ1''E2_in_Cv2_inter_Upsilon2star 
            c_in_Cv_inter_Upsilon δ1''_in_N1_inter_Delta1star Adm<span class=main>]</span>
          <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> 
            <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>α2''</span></span> <span class=skolem><span class=skolem>δ2''</span></span>
        <span class=keyword2><span class=keyword>where</span></span> α2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>α2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ2''_in_N2_inter_Delta2star<span class=main>:</span><span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Υ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2<span class=main>:</span> 
        <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ2''</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>α2''</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α2''Vv2_is_α2'Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> α2''Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>α2''</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ2''E1_is_δ1''E2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ2''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>from</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2 βE1_cE1_δ1''_v'E1_α1''_in_Tr1 
        validES2 validES1
      <span class=keyword1><span class=command>have</span></span> δ2''_in_E2star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ2''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> δ1''_in_E1star<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ1''</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp_all</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>with</span></span> δ2''E1_is_δ1''E2 merge_property<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=skolem>δ2''</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span> <span class=quoted><span class=skolem>δ1''</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>δ'</span></span>
        <span class=keyword2><span class=keyword>where</span></span> δ'E2_is_δ2''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ2''</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ'E1_is_δ1''<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>δ1''</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> δ'_contains_only_δ2''_δ1''_events<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> set <span class=skolem>δ2''</span> <span class=main>∪</span> set <span class=skolem>δ1''</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> Let_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>

      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?TAU</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span>"</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?LAMBDA</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?T2</span></span></span> <span class=main>=</span> <span class=quoted><span class=skolem>α2''</span></span>
      <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?T1</span></span></span> <span class=main>=</span> <span class=quoted><span class=skolem>α1''</span></span>

     <span class=comment1>(* apply the generalized zipping lemma *)</span>
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2 δ'E2_is_δ2'' validES2
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
              prefixclosed_def prefix_def<span class=main>)</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>          
          <span class=keyword1><span class=command>from</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1 δ'E1_is_δ1'' validES1 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>β</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_prefixclosed_def
              prefixclosed_def prefix_def<span class=main>)</span>
          <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> βv'α_in_Tr c_in_Cv_inter_Upsilon VIsViewOnE
            δ'_contains_only_δ2''_δ1''_events δ2''_in_E2star δ1''_in_E1star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=skolem>δ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span><span class=main>)</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> composeES_def isViewOn_def V_valid_def 
              VC_disjoint_def VN_disjoint_def NC_disjoint_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>unfolding</span></span> composeES_def
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span> 
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"set <span class=var>?TAU</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> composeES_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=var>?LAMBDA</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α2''_in_E2star α1''_in_E1star
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βE2_cE2_δ2''_v'E2_α2''_in_Tr2 δ'E2_is_δ2'' 
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?T2</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> βE1_cE1_δ1''_v'E1_α1''_in_Tr1 δ'E1_is_δ1'' 
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=var>?T1</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_concatenation_commute<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> α2''_in_E2star propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T2</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute projection_intersection_neutral<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>note</span></span> α2'Vv2_is_αVv2 α2''Vv2_is_α2'Vv2
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?LAMBDA</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span> α1''_in_E1star propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?T1</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> Int_commute projection_intersection_neutral<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>note</span></span> α1'Vv1_is_αVv1 α1''Vv1_is_α1'Vv1
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> α2''Cv2_empty α1''Cv1_empty generalized_zipping_lemma
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>t</span></span> <span class=comment1>(* show that the conclusion of FCIA holds *)</span>
        <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=var>?TAU</span> <span class=main>@</span> <span class=skolem>t</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span>  <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=var>?LAMBDA</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> δ'_contains_only_δ2''_δ1''_events 
            δ2''_in_N2_inter_Delta2star δ1''_in_N1_inter_Delta1star
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=skolem>δ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
          <span class=keyword1><span class=command>with</span></span> Delta1_N1_Delta2_N2_subset_Delta Nv1_union_Nv2_subsetof_Nv <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span> <span class=bound>γ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>γ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>γ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> 
        <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span> append_assoc<span class=main><span class=keyword3>,</span></span> <span class=operator>blast</span><span class=main>)</span>
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>α'</span> <span class=bound>γ'</span><span class=main>.</span> <span class=main>(</span>set <span class=bound>γ'</span> <span class=main>⊆</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> Δ<span class=hidden>⇘</span><sub><span class=free>Γ</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=skolem>β</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>c</span><span class=main>]</span> <span class=main>@</span> <span class=bound>γ'</span> <span class=main>@</span> <span class=main>[</span><span class=skolem>v'</span><span class=main>]</span> <span class=main>@</span> <span class=bound>α'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> 
      <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>α</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>α'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>unfolding</span></span> FCIA_def
    <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(* Theorem 6.4.2 *)</span>
<span class=keyword1><span class=command>theorem</span></span> compositionality_R<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span> R <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> R <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> <span class=main>⟹</span> R <span class=free>𝒱</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword3><span class=command>assume</span></span> R1<span class=main>:</span> <span class=quoted><span class=quoted>"R <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> R2<span class=main>:</span> <span class=quoted><span class=quoted>"R <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>

    <span class=keyword1><span class=command>{</span></span>
      <span class=keyword3><span class=command>fix</span></span> <span class=skolem>τ'</span>
      <span class=keyword3><span class=command>assume</span></span> τ'_in_Tr<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>hence</span></span> τ'E1_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> τ'E2_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> composeES_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>with</span></span> R1 R2 <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>τ1'</span></span> <span class=skolem><span class=skolem>τ2'</span></span>
        <span class=keyword2><span class=keyword>where</span></span> τ1'_in_Tr1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> τ1'Cv1_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ1'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> τ1'Vv1_is_τ'_E1_Vv1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> τ2'_in_Tr2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> τ2'Cv2_empty<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ2'</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword2><span class=keyword>and</span></span> τ2'Vv2_is_τ'_E2_Vv2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>τ2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>unfolding</span></span> R_def
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>

      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>[]</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"set <span class=main>(</span><span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>)</span> <span class=main>⊆</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> validES1 τ1'_in_Tr1 <span class=keyword1><span class=command>have</span></span> τ1'_in_E1<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>τ1'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> validES2 τ2'_in_Tr2 <span class=keyword1><span class=command>have</span></span> τ2'_in_E2<span class=main>:</span> <span class=quoted><span class=quoted>"set <span class=skolem>τ2'</span> <span class=main>⊆</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ES_valid_def traces_contain_events_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> τ1'_in_Tr1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>τ1'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>from</span></span> τ2'_in_Tr2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>[]</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>@</span> <span class=skolem>τ2'</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> τ1'_in_E1<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> propSepViews 
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ1'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span>  propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>" <span class=skolem>τ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> validV1 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> isViewOn_def V_valid_def 
                VC_disjoint_def VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
            <span class=keyword1><span class=command>}</span></span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>note</span></span> τ1'Vv1_is_τ'_E1_Vv1
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>from</span></span> projection_intersection_neutral<span class=main>[</span><span class=operator>OF</span> τ2'_in_E2<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span>"</span></span><span class=main>]</span> propSepViews
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ2'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> Int_commute<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>from</span></span>  propSepViews <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
            <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def
            <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_sequence<span class=main>)</span>
          <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>{</span></span>
            <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>" <span class=skolem>τ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> <span class=main>(</span>E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> projection_def<span class=main>)</span>
            <span class=keyword1><span class=command>moreover</span></span>
            <span class=keyword1><span class=command>from</span></span> validV2 <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>isViewOn_def V_valid_def VC_disjoint_def 
                VN_disjoint_def NC_disjoint_def<span class=main><span class=keyword3>,</span></span> <span class=operator>auto</span><span class=main>)</span>
            <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>τ'</span> <span class=main>↿</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>
              <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
            <span class=keyword1><span class=command>}</span></span>
          <span class=keyword1><span class=command>moreover</span></span>
          <span class=keyword1><span class=command>note</span></span> τ2'Vv2_is_τ'_E2_Vv2
          <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
            <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
        <span class=keyword1><span class=command>qed</span></span>
      <span class=keyword1><span class=command>moreover</span></span>
      <span class=keyword1><span class=command>note</span></span> τ1'Cv1_empty τ2'Cv2_empty generalized_zipping_lemma
      <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>t</span><span class=main>.</span> <span class=main>[]</span> <span class=main>@</span> <span class=bound>t</span> <span class=main>∈</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>t</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=skolem>τ'</span> <span class=main>↿</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∧</span> <span class=bound>t</span> <span class=main>↿</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>=</span> <span class=main>[]</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
    <span class=keyword1><span class=command>}</span></span>
    <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
      <span class=keyword1><span class=command>unfolding</span></span> R_def
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
  <span class=keyword1><span class=command>qed</span></span>

<span class=keyword2><span class=keyword>end</span></span>

<span class=keyword1><span class=command>locale</span></span> CompositionalityStrictBSPs <span class=main>=</span> Compositionality <span class=main>+</span>
<span class=comment1>(*adds the additional assumptions of theorem 6.4.3 in Heiko Mantel's phd thesis*)</span>
<span class=keyword2><span class=keyword>assumes</span></span> N𝒱_inter_E1_is_N𝒱1<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span>"</span></span>
    <span class=keyword2><span class=keyword>and</span></span> N𝒱_inter_E2_is_N𝒱2<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span>"</span></span>

<span class=comment1>(* sublocale relationship to other compositionality assumptions*)</span>
<span class=keyword1><span class=command>sublocale</span></span> CompositionalityStrictBSPs <span class=main>⊆</span> Compositionality
<span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>unfold_locales</span><span class=main>)</span>

<span class=keyword1><span class=command>context</span></span> CompositionalityStrictBSPs
<span class=keyword2><span class=keyword>begin</span></span>
<span class=comment1>(*Theorem 6.4.3 Case 1 in Heiko Mantel's pdh thesis*)</span>
<span class=keyword1><span class=command>theorem</span></span> compositionality_SR<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span> SR <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> SR <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> <span class=main>⟹</span> SR <span class=free>𝒱</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"SR <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"SR <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>⦈</span>"</span></span>
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span>
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱'</span></span></span> <span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V<span class=main>=</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>,</span> N<span class=main>=</span><span class=main>{}</span><span class=main>,</span> C<span class=main>=</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span> 
    <span class=comment1>(*Show ?𝒱<span class=hidden>⇩</span><sub>1</sub>' ?𝒱<span class=hidden>⇩</span><sub>2</sub>' ?𝒱' are views on the respective set of events*)</span>
    <span class=keyword1><span class=command>from</span></span> validV1 <span class=keyword1><span class=command>have</span></span> 𝒱<span class=hidden>⇩</span><sub>1</sub>'IsViewOnE<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> "</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> validV2 <span class=keyword1><span class=command>have</span></span> 𝒱<span class=hidden>⇩</span><sub>2</sub>'IsViewOnE<span class=hidden>⇩</span><sub>2</sub><span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> "</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> VIsViewOnE <span class=keyword1><span class=command>have</span></span> 𝒱'IsViewOnE<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn  <span class=var>?𝒱'</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=comment1>(*Show ?𝒱<span class=hidden>⇩</span><sub>1</sub>' and ?𝒱<span class=hidden>⇩</span><sub>2</sub>' are proper separation of ⦇ V=<span class=hidden>⇘</span><sub>𝒱</sub><span class=hidden>⇙</span>, N={}, C=<span class=hidden>⇘</span><sub>𝒱</sub><span class=hidden>⇙</span> ⦈ *)</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews  N𝒱_inter_E1_is_N𝒱1
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews   N𝒱_inter_E2_is_N𝒱2
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews 
     <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>      
     <span class=keyword1><span class=command>from</span></span> propSepViews
     <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>{}</span>"</span></span>
       <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     
     <span class=keyword1><span class=command>note</span></span> properSeparation_𝒱<span class=hidden>⇩</span><sub>1</sub>𝒱<span class=hidden>⇩</span><sub>2</sub><span class=main>=</span><span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> 
              <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>{}</span>›</span></span>
    
    <span class=comment1>(*Show ES1∥ES2 is a well behaved composition w.r.t.  ?𝒱<span class=hidden>⇩</span><sub>1</sub>' and ?𝒱<span class=hidden>⇩</span><sub>2</sub>' *)</span>
     <span class=keyword1><span class=command>have</span></span> wbc1<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
       <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     
     
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SR <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"R <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>      
      <span class=keyword1><span class=command>using</span></span> validES1 validV1 BSPTaxonomyDifferentCorrections.SR_implies_R_for_modified_view  
      <span class=keyword1><span class=command>unfolding</span></span>  BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SR <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"R <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>     
      <span class=keyword1><span class=command>using</span></span> validES2 validV2  BSPTaxonomyDifferentCorrections.SR_implies_R_for_modified_view 
      <span class=keyword1><span class=command>unfolding</span></span> BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>   
 
    <span class=keyword1><span class=command>from</span></span> validES1 validES2 composableES1ES2  𝒱'IsViewOnE 𝒱<span class=hidden>⇩</span><sub>1</sub>'IsViewOnE<span class=hidden>⇩</span><sub>1</sub> 𝒱<span class=hidden>⇩</span><sub>2</sub>'IsViewOnE<span class=hidden>⇩</span><sub>2</sub>
         properSeparation_𝒱<span class=hidden>⇩</span><sub>1</sub>𝒱<span class=hidden>⇩</span><sub>2</sub>  wbc1
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Compositionality <span class=free>ES1</span> <span class=free>ES2</span> <span class=var>?𝒱'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span>"</span></span> <span class=keyword1><span class=command>unfolding</span></span> Compositionality_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> properSeparationOfViews_def wellBehavedComposition_def<span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹R <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹R <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"R <span class=var>?𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
     <span class=keyword1><span class=command>using</span></span> Compositionality.compositionality_R <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
     
   <span class=keyword1><span class=command>from</span></span>  validES1 validES2 composeES_yields_ES validVC
   <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSPTaxonomyDifferentCorrections <span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span> <span class=free>𝒱</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹R <span class=var>?𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"SR <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> BSPTaxonomyDifferentCorrections.R_implies_SR_for_modified_view  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(*Theorem 6.4.3 Case 2 in Heiko Mantel's pdh thesis*)</span>
<span class=keyword1><span class=command>theorem</span></span> compositionality_SD<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span> SD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> SD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> <span class=main>⟹</span> SD <span class=free>𝒱</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"SD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"SD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>⦈</span>"</span></span>
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span>
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱'</span></span></span> <span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V<span class=main>=</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>,</span> N<span class=main>=</span><span class=main>{}</span><span class=main>,</span> C<span class=main>=</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span> 
    <span class=comment1>(*Show ?𝒱<span class=hidden>⇩</span><sub>1</sub>' ?𝒱<span class=hidden>⇩</span><sub>2</sub>' ?𝒱' are views on the respective set of events*)</span>
    <span class=keyword1><span class=command>from</span></span> validV1 <span class=keyword1><span class=command>have</span></span> 𝒱<span class=hidden>⇩</span><sub>1</sub>'IsViewOnE<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> "</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> validV2 <span class=keyword1><span class=command>have</span></span> 𝒱<span class=hidden>⇩</span><sub>2</sub>'IsViewOnE<span class=hidden>⇩</span><sub>2</sub><span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> "</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> VIsViewOnE <span class=keyword1><span class=command>have</span></span> 𝒱'IsViewOnE<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn  <span class=var>?𝒱'</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=comment1>(*Show ?𝒱<span class=hidden>⇩</span><sub>1</sub>' and ?𝒱<span class=hidden>⇩</span><sub>2</sub>' are proper separation of ⦇ V=<span class=hidden>⇘</span><sub>𝒱</sub><span class=hidden>⇙</span>, N={}, C=<span class=hidden>⇘</span><sub>𝒱</sub><span class=hidden>⇙</span> ⦈ *)</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews  N𝒱_inter_E1_is_N𝒱1
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>"</span></span> 
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews   N𝒱_inter_E2_is_N𝒱2
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews 
     <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>      
     <span class=keyword1><span class=command>from</span></span> propSepViews
     <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>{}</span>"</span></span>
       <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     
     <span class=keyword1><span class=command>note</span></span> properSeparation_𝒱<span class=hidden>⇩</span><sub>1</sub>𝒱<span class=hidden>⇩</span><sub>2</sub><span class=main>=</span><span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> 
              <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>{}</span>›</span></span>
    
    <span class=comment1>(*Show ES1∥ES2 is a well behaved composition w.r.t.  ?𝒱<span class=hidden>⇩</span><sub>1</sub>' and ?𝒱<span class=hidden>⇩</span><sub>2</sub>' *)</span>
     <span class=keyword1><span class=command>have</span></span> wbc1<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
       <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     
     
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>      
      <span class=keyword1><span class=command>using</span></span> validES1 validV1 BSPTaxonomyDifferentCorrections.SD_implies_BSD_for_modified_view
      <span class=keyword1><span class=command>unfolding</span></span>  BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>     
      <span class=keyword1><span class=command>using</span></span> validES2 validV2 BSPTaxonomyDifferentCorrections.SD_implies_BSD_for_modified_view
      <span class=keyword1><span class=command>unfolding</span></span> BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>   
 
    <span class=keyword1><span class=command>from</span></span> validES1 validES2 composableES1ES2   𝒱'IsViewOnE 𝒱<span class=hidden>⇩</span><sub>1</sub>'IsViewOnE<span class=hidden>⇩</span><sub>1</sub> 𝒱<span class=hidden>⇩</span><sub>2</sub>'IsViewOnE<span class=hidden>⇩</span><sub>2</sub>
         properSeparation_𝒱<span class=hidden>⇩</span><sub>1</sub>𝒱<span class=hidden>⇩</span><sub>2</sub>  wbc1
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Compositionality <span class=free>ES1</span> <span class=free>ES2</span> <span class=var>?𝒱'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> Compositionality_def
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> properSeparationOfViews_def wellBehavedComposition_def<span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSD <span class=var>?𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
     <span class=keyword1><span class=command>using</span></span> Compositionality.compositionality_BSD <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
     
   <span class=keyword1><span class=command>from</span></span>  validES1 validES2 composeES_yields_ES validVC
   <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSPTaxonomyDifferentCorrections <span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span> <span class=free>𝒱</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹BSD <span class=var>?𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"SD <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> BSPTaxonomyDifferentCorrections.BSD_implies_SD_for_modified_view  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>

<span class=comment1>(*Theorem 6.4.3 Case 3 in Heiko Mantel's pdh thesis*)</span>
<span class=keyword1><span class=command>theorem</span></span> compositionality_SI<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>SD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> SD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> SI <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> SI <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span> 
   <span class=main>⟹</span> SI <span class=free>𝒱</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span> 
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"SD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"SD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"SI <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"SI <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>⦈</span>"</span></span>
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span>
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱'</span></span></span> <span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V<span class=main>=</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>,</span> N<span class=main>=</span><span class=main>{}</span><span class=main>,</span> C<span class=main>=</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span> 
    <span class=comment1>(*Show ?𝒱<span class=hidden>⇩</span><sub>1</sub>' ?𝒱<span class=hidden>⇩</span><sub>2</sub>' ?𝒱' are views on the respective set of events*)</span>
    <span class=keyword1><span class=command>from</span></span> validV1 <span class=keyword1><span class=command>have</span></span> 𝒱<span class=hidden>⇩</span><sub>1</sub>'IsViewOnE<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> "</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> validV2 <span class=keyword1><span class=command>have</span></span> 𝒱<span class=hidden>⇩</span><sub>2</sub>'IsViewOnE<span class=hidden>⇩</span><sub>2</sub><span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> "</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> VIsViewOnE <span class=keyword1><span class=command>have</span></span> 𝒱'IsViewOnE<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn  <span class=var>?𝒱'</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=comment1>(*Show ?𝒱<span class=hidden>⇩</span><sub>1</sub>' and ?𝒱<span class=hidden>⇩</span><sub>2</sub>' are proper separation of ⦇ V=<span class=hidden>⇘</span><sub>𝒱</sub><span class=hidden>⇙</span>, N={}, C=<span class=hidden>⇘</span><sub>𝒱</sub><span class=hidden>⇙</span> ⦈ *)</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews  N𝒱_inter_E1_is_N𝒱1
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>"</span></span> 
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews   N𝒱_inter_E2_is_N𝒱2
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>"</span></span> 
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews 
     <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>"</span></span> 
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>      
     <span class=keyword1><span class=command>from</span></span> propSepViews
     <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>"</span></span> 
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>{}</span>"</span></span>
       <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     
     <span class=keyword1><span class=command>note</span></span> properSeparation_𝒱<span class=hidden>⇩</span><sub>1</sub>𝒱<span class=hidden>⇩</span><sub>2</sub><span class=main>=</span><span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> 
              <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>{}</span>›</span></span>
    
    <span class=comment1>(*Show ES1∥ES2 is a well behaved composition w.r.t.  ?𝒱<span class=hidden>⇩</span><sub>1</sub>' and ?𝒱<span class=hidden>⇩</span><sub>2</sub>' *)</span>
     <span class=keyword1><span class=command>have</span></span> wbc1<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span>
       <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>      
      <span class=keyword1><span class=command>using</span></span> validES1 validV1 BSPTaxonomyDifferentCorrections.SD_implies_BSD_for_modified_view 
      <span class=keyword1><span class=command>unfolding</span></span>  BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>     
      <span class=keyword1><span class=command>using</span></span> validES2 validV2 BSPTaxonomyDifferentCorrections.SD_implies_BSD_for_modified_view 
      <span class=keyword1><span class=command>unfolding</span></span> BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SI <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSI <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>      
      <span class=keyword1><span class=command>using</span></span> validES1 validV1 BSPTaxonomyDifferentCorrections.SI_implies_BSI_for_modified_view 
      <span class=keyword1><span class=command>unfolding</span></span>  BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SI <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSI <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>     
      <span class=keyword1><span class=command>using</span></span> validES2 validV2 BSPTaxonomyDifferentCorrections.SI_implies_BSI_for_modified_view 
      <span class=keyword1><span class=command>unfolding</span></span> BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>   

    <span class=keyword1><span class=command>from</span></span> validES1 validES2 composableES1ES2  𝒱'IsViewOnE 𝒱<span class=hidden>⇩</span><sub>1</sub>'IsViewOnE<span class=hidden>⇩</span><sub>1</sub> 𝒱<span class=hidden>⇩</span><sub>2</sub>'IsViewOnE<span class=hidden>⇩</span><sub>2</sub>
         properSeparation_𝒱<span class=hidden>⇩</span><sub>1</sub>𝒱<span class=hidden>⇩</span><sub>2</sub>  wbc1
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Compositionality <span class=free>ES1</span> <span class=free>ES2</span> <span class=var>?𝒱'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span>"</span></span> <span class=keyword1><span class=command>unfolding</span></span> Compositionality_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> properSeparationOfViews_def wellBehavedComposition_def<span class=main>)</span>
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹BSI  <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹BSI <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSI <span class=var>?𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
     <span class=keyword1><span class=command>using</span></span> Compositionality.compositionality_BSI <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
     
   <span class=keyword1><span class=command>from</span></span>  validES1 validES2 composeES_yields_ES validVC
   <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSPTaxonomyDifferentCorrections <span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span> <span class=free>𝒱</span>"</span></span>
      <span class=keyword1><span class=command>unfolding</span></span> BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹BSI <span class=var>?𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"SI <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> BSPTaxonomyDifferentCorrections.BSI_implies_SI_for_modified_view  <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>


<span class=comment1>(*Theorem 6.4.3 Case 4 in Heiko Mantel's pdh thesis*)</span>
<span class=keyword1><span class=command>theorem</span></span> compositionality_SIA<span class=main>:</span> 
<span class=quoted><span class=quoted>"<span class=main>⟦</span>SD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> SD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> SIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> SIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>;</span> 
  <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>;</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⟧</span>
   <span class=main>⟹</span> SIA <span class=free>ρ</span> <span class=free>𝒱</span> <span class=main>(</span>Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span> <span class=main>∥</span> <span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span><span class=main>)</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"SD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"SD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"SIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"SIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
     <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span> 
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></span></span> <span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱1</span></sub><span class=hidden>⇙</span><span class=main>⦈</span>"</span></span>
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></span></span><span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span><span class=main>,</span> N <span class=main>=</span> <span class=main>{}</span><span class=main>,</span> C <span class=main>=</span> C<span class=hidden>⇘</span><sub><span class=free>𝒱2</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span>
    <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?𝒱'</span></span></span> <span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>⦇</span>V<span class=main>=</span>V<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>∪</span> N<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span><span class=main>,</span> N<span class=main>=</span><span class=main>{}</span><span class=main>,</span> C<span class=main>=</span>C<span class=hidden>⇘</span><sub><span class=free>𝒱</span></sub><span class=hidden>⇙</span> <span class=main>⦈</span>"</span></span> 
    
    <span class=comment1>(*Fix some intermediate rho's such that (ρ1' ?𝒱<span class=hidden>⇩</span><sub>1</sub>') = (ρ1 𝒱1), (ρ2' ?𝒱<span class=hidden>⇩</span><sub>2</sub>') = (ρ2 𝒱2)  and
      (ρ' ?𝒱') = (ρ 𝒱) hold.*)</span>
    <span class=keyword1><span class=command>let</span></span> <span class=quoted><span class=quoted>"<span class=var>?ρ1'</span><span class=main>::</span><span class=tfree>'a</span> Rho"</span></span> <span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>λ</span><span class=bound>𝒱</span><span class=main>.</span> <span class=keyword1>if</span> <span class=bound>𝒱</span><span class=main>=</span><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=keyword1>then</span> <span class=free>ρ1</span> <span class=free>𝒱1</span>  <span class=keyword1>else</span> <span class=main>{}</span>"</span></span>
    <span class=keyword1><span class=command>let</span></span> <span class=quoted><span class=quoted>"<span class=var>?ρ2'</span><span class=main>::</span><span class=tfree>'a</span> Rho"</span></span> <span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>λ</span><span class=bound>𝒱</span><span class=main>.</span> <span class=keyword1>if</span> <span class=bound>𝒱</span><span class=main>=</span><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> <span class=keyword1>then</span> <span class=free>ρ2</span> <span class=free>𝒱2</span>  <span class=keyword1>else</span> <span class=main>{}</span>"</span></span>
    <span class=keyword1><span class=command>let</span></span> <span class=quoted><span class=quoted>"<span class=var>?ρ'</span><span class=main>::</span><span class=tfree>'a</span> Rho"</span></span> <span class=main>=</span><span class=quoted><span class=quoted>"<span class=main>λ</span><span class=bound>𝒱'</span><span class=main>.</span> <span class=keyword1>if</span> <span class=bound>𝒱'</span><span class=main>=</span><span class=var>?𝒱'</span> <span class=keyword1>then</span> <span class=free>ρ</span> <span class=free>𝒱</span>  <span class=keyword1>else</span> <span class=main>{}</span>"</span></span>
    
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?ρ1'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span> 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?ρ2'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>(</span><span class=var>?ρ'</span> <span class=var>?𝒱'</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>

    <span class=comment1>(*Show ?𝒱<span class=hidden>⇩</span><sub>1</sub>' ?𝒱<span class=hidden>⇩</span><sub>2</sub>' ?𝒱' are views on the respective set of events*)</span>
    <span class=keyword1><span class=command>from</span></span> validV1 <span class=keyword1><span class=command>have</span></span> 𝒱<span class=hidden>⇩</span><sub>1</sub>'IsViewOnE<span class=hidden>⇩</span><sub>1</sub><span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> "</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> validV2 <span class=keyword1><span class=command>have</span></span> 𝒱<span class=hidden>⇩</span><sub>2</sub>'IsViewOnE<span class=hidden>⇩</span><sub>2</sub><span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> "</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> VIsViewOnE <span class=keyword1><span class=command>have</span></span> 𝒱'IsViewOnE<span class=main>:</span> <span class=quoted><span class=quoted>"isViewOn  <span class=var>?𝒱'</span> E<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> isViewOn_def V_valid_def  VN_disjoint_def NC_disjoint_def VC_disjoint_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
    <span class=comment1>(*Show ?𝒱<span class=hidden>⇩</span><sub>1</sub>' and ?𝒱<span class=hidden>⇩</span><sub>2</sub>' are proper separation of ⦇ V=<span class=hidden>⇘</span><sub>𝒱</sub><span class=hidden>⇙</span>, N={}, C=<span class=hidden>⇘</span><sub>𝒱</sub><span class=hidden>⇙</span> ⦈ *)</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews  N𝒱_inter_E1_is_N𝒱1
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews   N𝒱_inter_E2_is_N𝒱2
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>from</span></span> propSepViews 
     <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>      
     <span class=keyword1><span class=command>from</span></span> propSepViews
     <span class=keyword1><span class=command>have</span></span>  <span class=quoted><span class=quoted>"C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>"</span></span>
       <span class=keyword1><span class=command>unfolding</span></span> properSeparationOfViews_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>{}</span>"</span></span>
       <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
     
     <span class=keyword1><span class=command>note</span></span> properSeparation_𝒱<span class=hidden>⇩</span><sub>1</sub>𝒱<span class=hidden>⇩</span><sub>2</sub><span class=main>=</span><span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹V<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>=</span> V<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> 
              <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹C<span class=hidden>⇘</span><sub><span class=var>?𝒱'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span> <span class=main>⊆</span> C<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>=</span><span class=main>{}</span>›</span></span>
    
    <span class=comment1>(*Show ES1∥ES2 is a well behaved composition w.r.t.  ?𝒱<span class=hidden>⇩</span><sub>1</sub>' and ?𝒱<span class=hidden>⇩</span><sub>2</sub>' *)</span>
     <span class=keyword1><span class=command>have</span></span> wbc1<span class=main>:</span> <span class=quoted><span class=quoted>"N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span> <span class=main>∧</span> N<span class=hidden>⇘</span><sub><span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span></sub><span class=hidden>⇙</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span><span class=main>=</span><span class=main>{}</span>"</span></span> 
       <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    
      
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SD <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>      
      <span class=keyword1><span class=command>using</span></span> validES1 validV1 BSPTaxonomyDifferentCorrections.SD_implies_BSD_for_modified_view 
      <span class=keyword1><span class=command>unfolding</span></span>  BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SD <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>     
      <span class=keyword1><span class=command>using</span></span> validES2 validV2 BSPTaxonomyDifferentCorrections.SD_implies_BSD_for_modified_view 
      <span class=keyword1><span class=command>unfolding</span></span> BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SIA <span class=free>ρ1</span> <span class=free>𝒱1</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span><span class=var>?ρ1'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSIA <span class=var>?ρ1'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>      
      <span class=keyword1><span class=command>using</span></span> validES1 validV1 BSPTaxonomyDifferentCorrections.SIA_implies_BSIA_for_modified_view 
      <span class=keyword1><span class=command>unfolding</span></span>  BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>fastforce</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹SIA <span class=free>ρ2</span> <span class=free>𝒱2</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span><span class=var>?ρ2'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>›</span></span>  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSIA <span class=var>?ρ2'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>     
      <span class=keyword1><span class=command>using</span></span> validES2 validV2 BSPTaxonomyDifferentCorrections.SIA_implies_BSIA_for_modified_view 
      <span class=keyword1><span class=command>unfolding</span></span> BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>fastforce</span>   

    <span class=keyword1><span class=command>from</span></span> validES1 validES2 composableES1ES2  𝒱'IsViewOnE 𝒱<span class=hidden>⇩</span><sub>1</sub>'IsViewOnE<span class=hidden>⇩</span><sub>1</sub> 𝒱<span class=hidden>⇩</span><sub>2</sub>'IsViewOnE<span class=hidden>⇩</span><sub>2</sub>
         properSeparation_𝒱<span class=hidden>⇩</span><sub>1</sub>𝒱<span class=hidden>⇩</span><sub>2</sub>  wbc1
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"Compositionality <span class=free>ES1</span> <span class=free>ES2</span> <span class=var>?𝒱'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> Compositionality_def 
      <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> properSeparationOfViews_def wellBehavedComposition_def<span class=main>)</span>
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span><span class=var>?ρ1'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ρ1</span> <span class=free>𝒱1</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span><span class=var>?ρ'</span> <span class=var>?𝒱'</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?ρ1'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span>  <span class=main>⊆</span>  <span class=var>?ρ'</span>  <span class=var>?𝒱'</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span> <span class=main>⊆</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span><span class=var>?ρ2'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ρ2</span> <span class=free>𝒱2</span><span class=main>)</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span><span class=var>?ρ'</span> <span class=var>?𝒱'</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=var>?ρ2'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span>  <span class=main>⊆</span>  <span class=var>?ρ'</span>  <span class=var>?𝒱'</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>   

    <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹Compositionality <span class=free>ES1</span> <span class=free>ES2</span> <span class=var>?𝒱'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span>›</span></span> <span class=quoted><span class=quoted>‹BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹BSD <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span> 
          <span class=quoted><span class=quoted>‹BSIA <span class=var>?ρ1'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹BSIA <span class=var>?ρ2'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span> Tr<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span> 
          <span class=quoted><span class=quoted>‹<span class=var>?ρ1'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>1</sub>'</span>  <span class=main>⊆</span>  <span class=var>?ρ'</span>  <span class=var>?𝒱'</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES1</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=var>?ρ2'</span> <span class=var>?𝒱<span class=hidden>⇩</span><sub>2</sub>'</span>  <span class=main>⊆</span>  <span class=var>?ρ'</span>  <span class=var>?𝒱'</span> <span class=main>∩</span> E<span class=hidden>⇘</span><sub><span class=free>ES2</span></sub><span class=hidden>⇙</span>›</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSIA <span class=var>?ρ'</span> <span class=var>?𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> Compositionality.compositionality_BSIA <span class=keyword1><span class=command>by</span></span> <span class=operator>fastforce</span>
      
    <span class=keyword1><span class=command>from</span></span>  validES1 validES2 composeES_yields_ES validVC 
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"BSPTaxonomyDifferentCorrections <span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span> <span class=free>𝒱</span>"</span></span> 
      <span class=keyword1><span class=command>unfolding</span></span> BSPTaxonomyDifferentCorrections_def <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span> 
    <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹BSIA <span class=var>?ρ'</span> <span class=var>?𝒱'</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=main>(</span><span class=var>?ρ'</span> <span class=var>?𝒱'</span><span class=main>)</span> <span class=main>=</span> <span class=main>(</span><span class=free>ρ</span> <span class=free>𝒱</span><span class=main>)</span>›</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"SIA <span class=free>ρ</span> <span class=free>𝒱</span> Tr<span class=hidden>⇘</span><sub><span class=main>(</span><span class=free>ES1</span><span class=main>∥</span><span class=free>ES2</span><span class=main>)</span></sub><span class=hidden>⇙</span>"</span></span> 
      <span class=keyword1><span class=command>using</span></span> BSPTaxonomyDifferentCorrections.BSIA_implies_SIA_for_modified_view  <span class=keyword1><span class=command>by</span></span> <span class=operator>fastforce</span>
  <span class=keyword1><span class=command>}</span></span>
  <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>  
<span class=keyword1><span class=command>qed</span></span>
<span class=keyword2><span class=keyword>end</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre>
</div>
</main>
</div>
</div>
</body>
</html>
<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Session FunWithFunctions - Archive of Formal Proofs</title><meta name=description content="A collection of proof libraries, examples, and larger scientific developments, mechanically checked in the theorem prover Isabelle."><meta property="og:title" content="Session FunWithFunctions"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="/entries/funwithfunctions/theories/"><meta property="og:image" content="/images/afp.png"><meta property="article:section" content="theories"><meta property="og:site_name" content="Archive of Formal Proofs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/images/afp.png"><meta name=twitter:title content="Session FunWithFunctions"><meta name=twitter:description content><link rel=stylesheet type=text/css href=/css/front.min.css><link rel=stylesheet type=text/css href=/css/isabelle.css><link rel=icon href=/images/favicon.ico type=image/icon><script src=/js/flexsearch.min.js></script><script src=/js/banner.js></script><script src=/js/header-search.js></script></head><body class=mathjax_ignore><aside><div><div><a href=/><img src=/images/afp.png alt="Logo of the Archive of Formal Proofs" class=logo></a><ul><li><a href=/entries/funwithfunctions>Return to entry</a></li></ul><hr><ul><li><a href=#FunWithFunctions>FunWithFunctions</a><ul><li><a href=#FunWithFunctions-identity2>identity2</a></li></ul></li></ul></div><ul><li><a href=https://www.isa-afp.org/browser_info/current/AFP/FunWithFunctions/outline.pdf>Proof
outline</a></li><li><a href=https://www.isa-afp.org/browser_info/current/AFP/FunWithFunctions/document.pdf>Proof
document</a></li><li><a href=https://www.isa-afp.org/browser_info/current/AFP/FunWithFunctions/session_graph.pdf>Theory dependencies</a></li></ul></div></aside><div class="content theories"><header><form action=/%20search><div class=form-container><input id=searchInput type=search size=31 maxlength=255 aria-label="Search the AFP" list=autocomplete><button id=searchButton type=button><img src=/images/search.svg alt=Search></button>
<datalist id=autocomplete></datalist></div></form><h1><span class=first>S</span>ession <span class=first>F</span>un<span class=first>W</span>ith<span class=first>F</span>unctions</h1><div></div></header><div id=banner data-id=0><p>This is an unofficial reimagining of the <a href=https://isa-afp.org target=_blank rel="noreferrer noopener">Archive of Formal Proofs</a></p><button style=display:none id=close title=close><svg viewBox="0 0 6.718 6.718" aria-hidden="true" focusable="false"><rect transform="rotate(45)" x="4" y="-4" width="1.5" height="8"/><rect transform="rotate(45)" x=".75" y="-.75" width="8" height="1.5"/></svg></button></div><div><main><div id=FunWithFunctions><div class=head><h1>Theory FunWithFunctions</h1></div><pre class=source><span class=comment1>(*  Title:      Fun With Functions
    Author:     Tobias Nipkow
*)</span>

<span class=keyword1><span class=command>theory</span></span> FunWithFunctions <span class=keyword2><span class=keyword>imports</span></span> <a href=https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/HOL/HOL/Complex_Main.html>Complex_Main</a> <span class=keyword2><span class=keyword>begin</span></span>

<span class=keyword1><span class=command>text</span></span><span class=quoted><span class=plain_text>‹See \cite{Tao2006}. Was first brought to our attention by Herbert
Ehler who provided a similar proof.›</span></span>

<span class=keyword1><span class=command>theorem</span></span> identity1<span class=main>:</span> <span class=keyword2><span class=keyword>fixes</span></span> <span class=free>f</span> <span class=main>::</span> <span class=quoted><span class=quoted>"nat <span class=main>⇒</span> nat"</span></span>
<span class=keyword2><span class=keyword>assumes</span></span> fff<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>n</span><span class=main>.</span> <span class=free>f</span><span class=main>(</span><span class=free>f</span><span class=main>(</span><span class=bound>n</span><span class=main>)</span><span class=main>)</span> <span class=main>&lt;</span> <span class=free>f</span><span class=main>(</span>Suc<span class=main>(</span><span class=bound>n</span><span class=main>)</span><span class=main>)</span>"</span></span>
<span class=keyword2><span class=keyword>shows</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=free>n</span><span class=main>)</span> <span class=main>=</span> <span class=free>n</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span> <span class=keyword3><span class=command>fix</span></span> <span class=skolem>m</span> <span class=skolem>n</span> <span class=keyword1><span class=command>have</span></span> key<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>≤</span> <span class=skolem>m</span> <span class=main>⟹</span> <span class=skolem>n</span> <span class=main>≤</span> <span class=free>f</span><span class=main>(</span><span class=skolem>m</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span><span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>n</span></span> <span class=quasi_keyword>arbitrary</span><span class=main><span class=main>:</span></span> <span class=quoted><span class=skolem>m</span></span><span class=main>)</span>
      <span class=keyword3><span class=command>case</span></span> 0 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>m</span> <span class=main>≠</span> <span class=main>0</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>k</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=main>[</span><span class=operator>simp</span><span class=main>]</span><span class=main>:</span> <span class=quoted><span class=quoted>"<span class=skolem>m</span> <span class=main>=</span> Suc <span class=skolem>k</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> not0_implies_Suc<span class=main>)</span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>≤</span> <span class=free>f</span><span class=main>(</span><span class=skolem>k</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>using</span></span> Suc <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span> <span class=main>≤</span> <span class=free>f</span><span class=main>(</span><span class=free>f</span><span class=main>(</span><span class=skolem>k</span><span class=main>)</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>using</span></span> Suc <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>&lt;</span> <span class=free>f</span><span class=main>(</span><span class=skolem>m</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>using</span></span> fff <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>finally</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>qed</span></span> <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>n</span><span class=main>.</span> <span class=bound>n</span> <span class=main>≤</span> <span class=free>f</span><span class=main>(</span><span class=bound>n</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>n</span><span class=main>.</span> <span class=free>f</span><span class=main>(</span><span class=bound>n</span><span class=main>)</span> <span class=main>&lt;</span> <span class=free>f</span><span class=main>(</span>Suc <span class=bound>n</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>metis</span> fff order_le_less_trans<span class=main>)</span>
  <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=free>n</span><span class=main>)</span> <span class=main>&lt;</span> <span class=free>n</span><span class=main>+</span><span class=main>1</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> fff lift_Suc_mono_less_iff<span class=main><span class=main>[</span></span><span class=operator>of</span> <span class=quoted><span class=free><span class=quoted><span class=free><span class=quoted><span class=free>f</span></span></span></span></span></span><span class=main><span class=main>]</span></span> Suc_eq_plus1<span class=main>)</span>
  <span class=keyword1><span class=command>with</span></span> <span class=quoted><span class=quoted>‹<span class=free>n</span> <span class=main>≤</span> <span class=free>f</span><span class=main>(</span><span class=free>n</span><span class=main>)</span>›</span></span> <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span> <span class=free>n</span> <span class=main>=</span> <span class=free>n</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>arith</span>
<span class=keyword1><span class=command>qed</span></span>


<span class=keyword1><span class=command>text</span></span><span class=quoted><span class=plain_text>‹See \cite{Tao2006}. Possible extension:
Should also hold if the range of <span class=antiquoted><span class=raw_text><span class=antiquoted><span class=raw_text><span class=operator><span class=operator>‹</span></span>f›</span></span></span></span> is the reals!
›</span></span>

<span class=keyword1 id=FunWithFunctions-identity2><span class=command>lemma</span></span> identity2<span class=main>:</span> <span class=keyword2><span class=keyword>fixes</span></span> <span class=free>f</span> <span class=main>::</span> <span class=quoted><span class=quoted>"nat <span class=main>⇒</span> nat"</span></span>
<span class=keyword2><span class=keyword>assumes</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=free>k</span><span class=main>)</span> <span class=main>=</span> <span class=free>k</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=free>k</span> <span class=main>≥</span> <span class=numeral>2</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> f_times<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>m</span> <span class=bound>n</span><span class=main>.</span> <span class=free>f</span><span class=main>(</span><span class=bound>m</span><span class=main>*</span><span class=bound>n</span><span class=main>)</span> <span class=main>=</span> <span class=free>f</span><span class=main>(</span><span class=bound>m</span><span class=main>)</span><span class=main>*</span><span class=free>f</span><span class=main>(</span><span class=bound>n</span><span class=main>)</span>"</span></span>
<span class=keyword2><span class=keyword>and</span></span> f_mono<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>m</span> <span class=bound>n</span><span class=main>.</span> <span class=bound>m</span><span class=main>&lt;</span><span class=bound>n</span> <span class=main>⟹</span> <span class=free>f</span> <span class=bound>m</span> <span class=main>&lt;</span> <span class=free>f</span> <span class=bound>n</span>"</span></span>
<span class=keyword2><span class=keyword>shows</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=free>n</span><span class=main>)</span> <span class=main>=</span> <span class=free>n</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>have</span></span> 0<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=main>0</span><span class=main>)</span> <span class=main>=</span> <span class=main>0</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> f_mono f_times mult_1_right mult_is_0 nat_less_le nat_mult_eq_cancel_disj not_less_eq<span class=main>)</span>
  <span class=keyword1><span class=command>have</span></span> 1<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=main>1</span><span class=main>)</span> <span class=main>=</span> <span class=main>1</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> f_mono f_times gr_implies_not0 mult_eq_self_implies_10 nat_mult_1_right zero_less_one<span class=main>)</span>
  <span class=keyword1><span class=command>have</span></span> 2<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>f</span> <span class=numeral>2</span> <span class=main>=</span> <span class=numeral>2</span>"</span></span>
  <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=numeral>2</span> <span class=main>+</span> <span class=main>(</span><span class=free>k</span> <span class=main>-</span> <span class=numeral>2</span><span class=main>)</span> <span class=main>=</span> <span class=free>k</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=free>k</span> <span class=main>≥</span> <span class=numeral>2</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>arith</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=numeral>2</span><span class=main>)</span> <span class=main>≤</span> <span class=numeral>2</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> mono_nat_linear_lb<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=free>f</span></span> <span class=quoted><span class=numeral>2</span></span> <span class=quoted><span class=quoted>"<span class=free>k</span> <span class=main>-</span> <span class=numeral>2</span>"</span></span><span class=main>,</span><span class=operator>OF</span> f_mono<span class=main>]</span> <span class=quoted><span class=quoted>‹<span class=free>f</span> <span class=free>k</span> <span class=main>=</span> <span class=free>k</span>›</span></span>
      <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span> <span class=numeral>2</span> <span class=main>=</span> <span class=numeral>2</span>"</span></span> <span class=keyword1><span class=command>using</span></span> 1 f_mono<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=main>1</span></span> <span class=quoted><span class=numeral>2</span></span><span class=main>]</span> <span class=keyword1><span class=command>by</span></span> <span class=operator>arith</span>
  <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span>
  <span class=keyword1><span class=command>proof</span></span><span class=main>(</span><span class=operator>induct</span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span>less_induct<span class=main>)</span>
    <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>less <span class=skolem>i</span><span class=main>)</span>
    <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=operator>cases</span>
      <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>i</span><span class=main>≤</span><span class=main>1</span>"</span></span> <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>using</span></span> 0 1 <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>auto</span> <span class=quasi_keyword>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>le_Suc_eq<span class=main>)</span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=main>~</span><span class=skolem>i</span><span class=main>≤</span><span class=main>1</span>"</span></span>
      <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span>
      <span class=keyword1><span class=command>proof</span></span> <span class=operator>cases</span>
        <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>i</span> <span class=keyword1>mod</span> <span class=numeral>2</span> <span class=main>=</span> <span class=main>0</span>"</span></span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>k</span><span class=main>.</span> <span class=skolem>i</span><span class=main>=</span><span class=numeral>2</span><span class=main>*</span><span class=bound>k</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>arith</span>
        <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>k</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>i</span> <span class=main>=</span> <span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>0</span> <span class=main>&lt;</span> <span class=skolem>k</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>k</span><span class=main>&lt;</span><span class=skolem>i</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=main>~</span><span class=skolem>i</span><span class=main>≤</span><span class=main>1</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>arith</span><span class=main><span class=keyword3>+</span></span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=skolem>k</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>k</span>"</span></span> <span class=keyword1><span class=command>using</span></span> less<span class=main>(</span>1<span class=main>)</span> <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
        <span class=keyword3><span class=command>thus</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=skolem>i</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>i</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>i</span> <span class=main>=</span> <span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span>›</span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>f_times 2<span class=main>)</span>
      <span class=keyword1><span class=command>next</span></span>
        <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>i</span> <span class=keyword1>mod</span> <span class=numeral>2</span> <span class=main>≠</span> <span class=main>0</span>"</span></span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>∃</span><span class=bound>k</span><span class=main>.</span> <span class=skolem>i</span><span class=main>=</span><span class=numeral>2</span><span class=main>*</span><span class=bound>k</span><span class=main>+</span><span class=main>1</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>arith</span>
        <span class=keyword1><span class=command>then</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>k</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=skolem>i</span> <span class=main>=</span> <span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span>"</span></span> <span class=keyword1><span class=command>..</span></span>
        <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=main>0</span><span class=main>&lt;</span><span class=skolem>k</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>k</span><span class=main>+</span><span class=main>1</span><span class=main>&lt;</span><span class=skolem>i</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=main>~</span><span class=skolem>i</span><span class=main>≤</span><span class=main>1</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>arith</span><span class=main><span class=keyword3>+</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span> <span class=main>&lt;</span> <span class=free>f</span><span class=main>(</span><span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span> <span class=main>=</span> <span class=numeral>2</span><span class=main>*</span><span class=free>f</span><span class=main>(</span><span class=skolem>k</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>using</span></span> less<span class=main>(</span>1<span class=main>)</span> <span class=quoted><span class=quoted>‹<span class=skolem>i</span><span class=main>=</span><span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
          <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> <span class=free>f</span><span class=main>(</span><span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>f_times 2<span class=main>)</span>
          <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>&lt;</span> <span class=free>f</span><span class=main>(</span><span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>using</span></span> f_mono<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"<span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span>"</span></span> <span class=quoted><span class=quoted>"<span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span>"</span></span><span class=main>]</span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
          <span class=keyword1><span class=command>finally</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>.</span></span>
        <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>moreover</span></span>
        <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span><span class=main>)</span> <span class=main>&lt;</span> <span class=numeral>2</span><span class=main>*</span><span class=main>(</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span><span class=main>)</span>"</span></span>
        <span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
          <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span><span class=main>)</span> <span class=main>&lt;</span> <span class=free>f</span><span class=main>(</span><span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=numeral>2</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>using</span></span> f_mono<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"<span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span>"</span></span> <span class=quoted><span class=quoted>"<span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=numeral>2</span>"</span></span><span class=main>]</span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
          <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> <span class=free>f</span><span class=main>(</span><span class=numeral>2</span><span class=main>*</span><span class=main>(</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span><span class=main>)</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
          <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> <span class=numeral>2</span><span class=main>*</span><span class=free>f</span><span class=main>(</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span>f_times 2<span class=main>)</span>
          <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>k</span><span class=main>+</span><span class=main>1</span>"</span></span> <span class=keyword1><span class=command>using</span></span> less<span class=main>(</span>1<span class=main>)</span> <span class=quoted><span class=quoted>‹<span class=skolem>i</span><span class=main>=</span><span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=main>~</span><span class=skolem>i</span><span class=main>≤</span><span class=main>1</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
          <span class=keyword1><span class=command>finally</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>.</span></span>
        <span class=keyword1><span class=command>qed</span></span>
        <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=skolem>i</span><span class=main>)</span> <span class=main>=</span> <span class=skolem>i</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>i</span> <span class=main>=</span> <span class=numeral>2</span><span class=main>*</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>arith</span>
      <span class=keyword1><span class=command>qed</span></span>
    <span class=keyword1><span class=command>qed</span></span>
  <span class=keyword1><span class=command>qed</span></span>
<span class=keyword1><span class=command>qed</span></span>


<span class=keyword1><span class=command>text</span></span><span class=quoted><span class=plain_text>‹One more from Tao's booklet. If <span class=antiquoted><span class=raw_text><span class=antiquoted><span class=raw_text><span class=operator><span class=operator>‹</span></span>f›</span></span></span></span> is also assumed to be
continuous, <span class=antiquoted><span class=antiquoted><span class=antiquote><span class=antiquote>@{</span></span><span class=operator><span class=operator>term</span></span><span class=quoted><span class=quoted>"<span class=free><span class=free>f</span></span><span class=main><span class=main>(</span></span><span class=free><span class=free>x</span></span><span class=main><span class=main>::</span></span>real<span class=main><span class=main>)</span></span> <span class=main><span class=main>=</span></span> <span class=free><span class=free>x</span></span><span class=main><span class=main>+</span></span><span class=main><span class=main>1</span></span>"</span></span><span class=antiquote><span class=antiquote>}</span></span></span></span> holds for all reals, not only
rationals. Extend the proof!›</span></span>

<span class=keyword1><span class=command>theorem</span></span> plus1<span class=main>:</span>
<span class=keyword2><span class=keyword>fixes</span></span> <span class=free>f</span> <span class=main>::</span> <span class=quoted><span class=quoted>"real <span class=main>⇒</span> real"</span></span>
<span class=keyword2><span class=keyword>assumes</span></span> 0<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>f</span> <span class=main>0</span> <span class=main>=</span> <span class=main>1</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> f_add<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>x</span> <span class=bound>y</span><span class=main>.</span> <span class=free>f</span><span class=main>(</span><span class=bound>x</span><span class=main>+</span><span class=bound>y</span><span class=main>+</span><span class=main>1</span><span class=main>)</span> <span class=main>=</span> <span class=free>f</span> <span class=bound>x</span> <span class=main>+</span> <span class=free>f</span> <span class=bound>y</span>"</span></span>

<span class=keyword2><span class=keyword>assumes</span></span> <span class=quoted><span class=quoted>"<span class=free>r</span> <span class=main>:</span> <span class=main>ℚ</span>"</span></span> <span class=keyword2><span class=keyword>shows</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span><span class=free>r</span><span class=main>)</span> <span class=main>=</span> <span class=free>r</span> <span class=main>+</span> <span class=main>1</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span> <span class=operator>-</span>
  <span class=keyword1><span class=command>{</span></span> <span class=keyword3><span class=command>fix</span></span> <span class=skolem>i</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span>of_int <span class=skolem>i</span><span class=main>)</span> <span class=main>=</span> of_int <span class=skolem>i</span> <span class=main>+</span> <span class=main>1</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span> <span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>i</span></span> <span class=quasi_keyword>rule</span><span class=main><span class=main>:</span></span> int_induct <span class=main><span class=main>[</span></span><span class=keyword2><span class=keyword><span class=operator>where</span></span></span> k<span class=main><span class=main><span class=main>=</span></span></span><span class=quoted><span class=main><span class=quoted><span class=main>0</span></span></span></span><span class=main><span class=main>]</span></span><span class=main>)</span>
      <span class=keyword3><span class=command>case</span></span> base <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>using</span></span> 0 <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>step1 <span class=skolem>i</span><span class=main>)</span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span>of_int <span class=main>(</span><span class=skolem>i</span><span class=main>+</span><span class=main>1</span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> <span class=free>f</span><span class=main>(</span>of_int <span class=skolem>i</span> <span class=main>+</span> <span class=main>0</span> <span class=main>+</span> <span class=main>1</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> <span class=free>f</span><span class=main>(</span>of_int <span class=skolem>i</span><span class=main>)</span> <span class=main>+</span> <span class=free>f</span> <span class=main>0</span>"</span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>rule</span> f_add<span class=main>)</span>
      <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> of_int <span class=main>(</span><span class=skolem>i</span><span class=main>+</span><span class=main>1</span><span class=main>)</span> <span class=main>+</span> <span class=main>1</span>"</span></span> <span class=keyword1><span class=command>using</span></span> step1 0 <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>finally</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>.</span></span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>step2 <span class=skolem>i</span><span class=main>)</span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span>of_int <span class=skolem>i</span><span class=main>)</span> <span class=main>=</span> <span class=free>f</span><span class=main>(</span>of_int <span class=main>(</span><span class=skolem>i</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span> <span class=main>+</span> <span class=main>0</span> <span class=main>+</span> <span class=main>1</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> <span class=free>f</span><span class=main>(</span>of_int <span class=main>(</span><span class=skolem>i</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span><span class=main>)</span> <span class=main>+</span> <span class=free>f</span> <span class=main>0</span>"</span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>rule</span> f_add<span class=main>)</span>
      <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> <span class=free>f</span><span class=main>(</span>of_int <span class=main>(</span><span class=skolem>i</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span><span class=main>)</span> <span class=main>+</span> <span class=main>1</span> "</span></span> <span class=keyword1><span class=command>using</span></span> 0 <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
      <span class=keyword1><span class=command>finally</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>using</span></span> step2 <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>qed</span></span> <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>note</span></span> f_int <span class=main>=</span> this
  <span class=keyword1><span class=command>{</span></span> <span class=keyword3><span class=command>fix</span></span> <span class=skolem>n</span> <span class=skolem>r</span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span>of_int <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span><span class=main>*</span><span class=skolem>r</span> <span class=main>+</span> of_int <span class=skolem>n</span><span class=main>)</span> <span class=main>=</span> of_int <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span> <span class=main>*</span> <span class=free>f</span> <span class=skolem>r</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span><span class=main>(</span><span class=operator>induct</span> <span class=quoted><span class=skolem>n</span></span><span class=main>)</span>
      <span class=keyword3><span class=command>case</span></span> 0 <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span>
      <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"of_int <span class=main>(</span>Suc<span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span><span class=main>)</span><span class=main>*</span><span class=skolem>r</span> <span class=main>+</span> of_int <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span> <span class=main>=</span>
            <span class=skolem>r</span> <span class=main>+</span> <span class=main>(</span>of_int <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span><span class=main>*</span><span class=skolem>r</span> <span class=main>+</span> of_int <span class=skolem>n</span><span class=main>)</span> <span class=main>+</span> <span class=main>1</span>"</span></span> <span class=main>(</span><span class=keyword2><span class=keyword>is</span></span> <span class=quoted><span class=quoted>"<span class=var>?a</span> <span class=main>=</span> <span class=var>?b</span>"</span></span><span class=main>)</span>
        <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> <span class=dynamic><span class=dynamic>field_simps</span></span><span class=main>)</span>
      <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span> <span class=var>?a</span> <span class=main>=</span> <span class=free>f</span> <span class=var>?b</span>"</span></span>
        <span class=keyword1><span class=command>by</span></span> <span class=operator>presburger</span>
      <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> <span class=free>f</span> <span class=skolem>r</span> <span class=main>+</span> <span class=free>f</span><span class=main>(</span>of_int <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span><span class=main>*</span><span class=skolem>r</span> <span class=main>+</span> of_int <span class=skolem>n</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>rule</span> f_add<span class=main>)</span>
      <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> <span class=free>f</span> <span class=skolem>r</span> <span class=main>+</span> of_int <span class=main>(</span>Suc <span class=skolem>n</span><span class=main>)</span> <span class=main>*</span> <span class=free>f</span> <span class=skolem>r</span>"</span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span>Suc<span class=main>)</span>
      <span class=keyword1><span class=command>finally</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?case</span></span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> <span class=dynamic><span class=dynamic>field_simps</span></span><span class=main>)</span>
    <span class=keyword1><span class=command>qed</span></span> <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>note</span></span> 1 <span class=main>=</span> this
  <span class=keyword1><span class=command>{</span></span> <span class=keyword3><span class=command>fix</span></span> <span class=skolem>n</span><span class=main>::</span><span class=quoted>nat</span> <span class=keyword2><span class=keyword>and</span></span> <span class=skolem>r</span> <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span><span class=main>≠</span><span class=main>0</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>f</span><span class=main>(</span>of_int <span class=main>(</span><span class=skolem>n</span><span class=main>)</span><span class=main>*</span><span class=skolem>r</span> <span class=main>+</span> of_int <span class=main>(</span><span class=skolem>n</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span><span class=main>)</span> <span class=main>=</span> of_int <span class=main>(</span><span class=skolem>n</span><span class=main>)</span> <span class=main>*</span> <span class=free>f</span> <span class=skolem>r</span>"</span></span>
    <span class=keyword1><span class=command>proof</span></span><span class=main>(</span><span class=operator>cases</span> <span class=quoted><span class=skolem>n</span></span><span class=main>)</span>
      <span class=keyword3><span class=command>case</span></span> 0 <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>n</span><span class=main>≠</span><span class=main>0</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>simp</span>
    <span class=keyword1><span class=command>next</span></span>
      <span class=keyword3><span class=command>case</span></span> Suc <span class=keyword3><span class=command>thus</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>n</span><span class=main>≠</span><span class=main>0</span>›</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted>"1"</span> <span class=keyword1><span class=command>by</span></span> <span class=operator>auto</span>
    <span class=keyword1><span class=command>qed</span></span> <span class=keyword1><span class=command>}</span></span>
  <span class=keyword1><span class=command>note</span></span> f_mult <span class=main>=</span> this
  <span class=keyword1><span class=command>from</span></span> <span class=quoted><span class=quoted>‹<span class=free>r</span><span class=main>:</span><span class=main>ℚ</span>›</span></span> <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>i</span></span><span class=main>::</span><span class=quoted>int</span> <span class=keyword2><span class=keyword>and</span></span> <span class=skolem><span class=skolem>n</span></span><span class=main>::</span><span class=quoted>nat</span> <span class=keyword2><span class=keyword>where</span></span> r<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>r</span> <span class=main>=</span> of_int <span class=skolem>i</span><span class=main>/</span>of_int <span class=skolem>n</span>"</span></span> <span class=keyword2><span class=keyword>and</span></span> <span class=quoted><span class=quoted>"<span class=skolem>n</span><span class=main>≠</span><span class=main>0</span>"</span></span>
    <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>fastforce</span> <span class=quasi_keyword>simp</span><span class=main><span class=main>:</span></span>Rats_eq_int_div_nat<span class=main>)</span>
  <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"of_int <span class=main>(</span><span class=skolem>n</span><span class=main>)</span> <span class=main>*</span> <span class=free>f</span><span class=main>(</span>of_int <span class=skolem>i</span> <span class=main>/</span> of_int <span class=skolem>n</span><span class=main>)</span> <span class=main>=</span> <span class=free>f</span><span class=main>(</span>of_int <span class=skolem>i</span> <span class=main>+</span> of_int <span class=main>(</span><span class=skolem>n</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span><span class=main>)</span>"</span></span>
    <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>n</span><span class=main>≠</span><span class=main>0</span>›</span></span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> <span class=main><span class=main>(</span></span>no_types<span class=main><span class=main>,</span></span> hide_lams<span class=main><span class=main>)</span></span> f_mult mult.commute nonzero_divide_eq_eq of_int_of_nat_eq of_nat_0_eq_iff<span class=main>)</span> 
  <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> <span class=free>f</span><span class=main>(</span>of_int <span class=main>(</span><span class=skolem>i</span> <span class=main>+</span> int <span class=skolem>n</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>n</span><span class=main>≠</span><span class=main>0</span>›</span></span><span class=main>[</span><span class=operator>simplified</span><span class=main>]</span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>metis</span> One_nat_def Suc_leI of_nat_1 add_diff_eq of_int_add of_nat_diff<span class=main>)</span>
  <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> of_int <span class=main>(</span><span class=skolem>i</span> <span class=main>+</span> int <span class=skolem>n</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span> <span class=main>+</span> <span class=main>1</span>"</span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>rule</span> f_int<span class=main>)</span>
  <span class=keyword1><span class=command>also</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>…</span> <span class=main>=</span> of_int <span class=skolem>i</span> <span class=main>+</span> of_int <span class=skolem>n</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>arith</span>
  <span class=keyword1><span class=command>finally</span></span> <span class=keyword3><span class=command>show</span></span> <span class=var><span class=quoted><span class=var>?thesis</span></span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>n</span><span class=main>≠</span><span class=main>0</span>›</span></span> <span class=keyword1><span class=command>unfolding</span></span> r <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span><span class=dynamic><span class=dynamic>field_simps</span></span><span class=main>)</span>
<span class=keyword1><span class=command>qed</span></span>


<span class=keyword1><span class=command>text</span></span><span class=quoted><span class=plain_text>‹The only total model of a naive recursion equation of factorial on
integers is 0 for all negative arguments. Probably folklore.›</span></span>

<span class=keyword1><span class=command>theorem</span></span> ifac_neg0<span class=main>:</span> <span class=keyword2><span class=keyword>fixes</span></span> <span class=free>ifac</span> <span class=main>::</span> <span class=quoted><span class=quoted>"int <span class=main>⇒</span> int"</span></span>
<span class=keyword2><span class=keyword>assumes</span></span> ifac_rec<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=main>⋀</span><span class=bound>i</span><span class=main>.</span> <span class=free>ifac</span> <span class=bound>i</span> <span class=main>=</span> <span class=main>(</span><span class=keyword1>if</span> <span class=bound>i</span><span class=main>=</span><span class=main>0</span> <span class=keyword1>then</span> <span class=main>1</span> <span class=keyword1>else</span> <span class=bound>i</span><span class=main>*</span><span class=free>ifac</span><span class=main>(</span><span class=bound>i</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span><span class=main>)</span>"</span></span>
<span class=keyword2><span class=keyword>shows</span></span> <span class=quoted><span class=quoted>"<span class=free>i</span><span class=main>&lt;</span><span class=main>0</span> <span class=main>⟹</span> <span class=free>ifac</span> <span class=free>i</span> <span class=main>=</span> <span class=main>0</span>"</span></span>
<span class=keyword1><span class=command>proof</span></span><span class=main>(</span><span class=operator>rule</span> ccontr<span class=main>)</span>
  <span class=keyword3><span class=command>assume</span></span> 0<span class=main>:</span> <span class=quoted><span class=quoted>"<span class=free>i</span><span class=main>&lt;</span><span class=main>0</span>"</span></span> <span class=quoted><span class=quoted>"<span class=free>ifac</span> <span class=free>i</span> <span class=main>≠</span> <span class=main>0</span>"</span></span>
  <span class=keyword1><span class=command>{</span></span> <span class=keyword3><span class=command>fix</span></span> <span class=skolem>j</span> <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>j</span> <span class=main>≤</span> <span class=free>i</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>ifac</span> <span class=skolem>j</span> <span class=main>≠</span> <span class=main>0</span>"</span></span>
      <span class=keyword1><span class=command><span class=improper><span class=command>apply</span></span></span></span><span class=main>(</span><span class=operator>rule</span> int_le_induct<span class=main><span class=main>[</span></span><span class=operator>OF</span> <span class=quoted><span class=quoted>‹<span class=skolem>j</span><span class=main>≤</span><span class=free>i</span>›</span></span><span class=main><span class=main>]</span></span><span class=main>)</span>
       <span class=keyword1><span class=command><span class=improper><span class=command>apply</span></span></span></span><span class=main>(</span><span class=operator>rule</span> <span class=quoted><span class=quoted>‹<span class=free>ifac</span> <span class=free>i</span> <span class=main>≠</span> <span class=main>0</span>›</span></span><span class=main>)</span>
      <span class=keyword1><span class=command><span class=improper><span class=command>apply</span></span></span></span> <span class=main>(</span><span class=operator>metis</span> <span class=quoted><span class=quoted>‹<span class=free>i</span><span class=main>&lt;</span><span class=main>0</span>›</span></span> ifac_rec linorder_not_le mult_eq_0_iff<span class=main>)</span>
      <span class=keyword1><span class=command><span class=improper><span class=command>done</span></span></span></span>
  <span class=keyword1><span class=command>}</span></span> <span class=keyword1><span class=command>note</span></span> below0 <span class=main>=</span> this
  <span class=keyword1><span class=command>{</span></span> <span class=keyword3><span class=command>fix</span></span> <span class=skolem>j</span> <span class=keyword3><span class=command>assume</span></span> <span class=quoted><span class=quoted>"<span class=skolem>j</span><span class=main>&lt;</span><span class=free>i</span>"</span></span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>1</span> <span class=main>&lt;</span> <span class=main>-</span><span class=skolem>j</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>j</span><span class=main>&lt;</span><span class=free>i</span>›</span></span> <span class=quoted><span class=quoted>‹<span class=free>i</span><span class=main>&lt;</span><span class=main>0</span>›</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>arith</span>
    <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>ifac</span><span class=main>(</span><span class=skolem>j</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span> <span class=main>≠</span> <span class=main>0</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>j</span><span class=main>&lt;</span><span class=free>i</span>›</span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> below0<span class=main>)</span>
    <span class=keyword1><span class=command>then</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=main>¦</span><span class=free>ifac</span> <span class=main>(</span><span class=skolem>j</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span><span class=main>¦</span> <span class=main>&lt;</span> <span class=main>(</span><span class=main>-</span><span class=skolem>j</span><span class=main>)</span> <span class=main>*</span> <span class=main>¦</span><span class=free>ifac</span> <span class=main>(</span><span class=skolem>j</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span><span class=main>¦</span>"</span></span> <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=skolem>j</span><span class=main>&lt;</span><span class=free>i</span>›</span></span>
      mult_le_less_imp_less<span class=main>[</span><span class=operator>OF</span> order_refl<span class=main><span class=main>[</span></span><span class=operator>of</span> <span class=quoted><span class=quoted>"abs<span class=main>(</span><span class=free>ifac</span><span class=main>(</span><span class=skolem>j</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span><span class=main>)</span>"</span></span><span class=main><span class=main>]</span></span> <span class=quoted><span class=quoted>‹<span class=main>1</span> <span class=main>&lt;</span> <span class=main>-</span><span class=skolem>j</span>›</span></span><span class=main>]</span>
      <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span>mult.commute<span class=main>)</span>
    <span class=keyword1><span class=command>hence</span></span> <span class=quoted><span class=quoted>"abs<span class=main>(</span><span class=free>ifac</span><span class=main>(</span><span class=skolem>j</span> <span class=main>-</span> <span class=main>1</span><span class=main>)</span><span class=main>)</span> <span class=main>&lt;</span> abs<span class=main>(</span><span class=free>ifac</span> <span class=skolem>j</span><span class=main>)</span>"</span></span>
      <span class=keyword1><span class=command>using</span></span> <span class=quoted><span class=quoted>‹<span class=main>1</span> <span class=main>&lt;</span> <span class=main>-</span><span class=skolem>j</span>›</span></span> <span class=keyword1><span class=command>by</span></span><span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>add</span><span class=main><span class=main>:</span></span> ifac_rec<span class=main><span class=main>[</span></span><span class=operator>of</span> <span class=quoted><span class=quoted>"<span class=skolem>j</span>"</span></span><span class=main><span class=main>]</span></span> abs_mult<span class=main>)</span>
  <span class=keyword1><span class=command>}</span></span> <span class=keyword1><span class=command>note</span></span> not_wf <span class=main>=</span> this
  <span class=keyword1><span class=command>let</span></span> <span class=var><span class=quoted><span class=var>?f</span></span></span> <span class=main>=</span> <span class=quoted><span class=quoted>"<span class=main>%</span><span class=bound>j</span><span class=main>.</span> nat<span class=main>(</span>abs<span class=main>(</span><span class=free>ifac</span><span class=main>(</span><span class=free>i</span> <span class=main>-</span> int<span class=main>(</span><span class=bound>j</span><span class=main>+</span><span class=main>1</span><span class=main>)</span><span class=main>)</span><span class=main>)</span><span class=main>)</span>"</span></span>
  <span class=keyword3><span class=command>obtain</span></span> <span class=skolem><span class=skolem>k</span></span> <span class=keyword2><span class=keyword>where</span></span> <span class=quoted><span class=quoted>"<span class=main>¬</span> <span class=var>?f</span> <span class=main>(</span>Suc <span class=skolem>k</span><span class=main>)</span> <span class=main>&lt;</span> <span class=var>?f</span> <span class=skolem>k</span>"</span></span>
    <span class=keyword1><span class=command>using</span></span> wf_no_infinite_down_chainE<span class=main>[</span><span class=operator>OF</span> wf_less<span class=main>,</span> <span class=operator>of</span> <span class=quoted><span class=quoted>"<span class=var>?f</span>"</span></span><span class=main>]</span> <span class=keyword1><span class=command>by</span></span> <span class=operator>blast</span>
  <span class=keyword1><span class=command>moreover</span></span> <span class=keyword1><span class=command>have</span></span> <span class=quoted><span class=quoted>"<span class=free>i</span> <span class=main>-</span> int <span class=main>(</span><span class=skolem>k</span> <span class=main>+</span> <span class=main>1</span><span class=main>)</span> <span class=main>-</span> <span class=main>1</span> <span class=main>=</span> <span class=free>i</span> <span class=main>-</span> int <span class=main>(</span>Suc <span class=skolem>k</span> <span class=main>+</span> <span class=main>1</span><span class=main>)</span>"</span></span> <span class=keyword1><span class=command>by</span></span> <span class=operator>arith</span>
  <span class=keyword1><span class=command>ultimately</span></span> <span class=keyword3><span class=command>show</span></span> <span class=quoted>False</span> <span class=keyword1><span class=command>using</span></span> not_wf<span class=main>[</span><span class=operator>of</span> <span class=quoted><span class=quoted>"<span class=free>i</span> <span class=main>-</span> int<span class=main>(</span><span class=skolem>k</span><span class=main>+</span><span class=main>1</span><span class=main>)</span>"</span></span><span class=main>]</span>
    <span class=keyword1><span class=command>by</span></span> <span class=main>(</span><span class=operator>simp</span> <span class=quasi_keyword>only</span><span class=main><span class=main>:</span></span><span class=main>)</span> <span class=operator>arith</span>
<span class=keyword1><span class=command>qed</span></span>

<span class=keyword2><span class=keyword>end</span></span>
</pre></div></main></div></div></body></html>
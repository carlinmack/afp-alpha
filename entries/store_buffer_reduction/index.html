<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>A Reduction Theorem for Store Buffers - Archive of Formal Proofs</title><meta property="og:title" content="A Reduction Theorem for Store Buffers"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="/entries/store_buffer_reduction/"><meta property="og:image" content="/images/afp.png"><meta property="article:published_time" content="2019-01-07T00:00:00+00:00"><meta property="article:modified_time" content="2019-01-07T00:00:00+00:00"><meta property="og:site_name" content="Archive of Formal Proofs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/images/afp.png"><meta name=twitter:title content="A Reduction Theorem for Store Buffers"><meta name=twitter:description content><link rel=stylesheet type=text/css href=/css/front.min.css integrity="sha256-TwhRoTiYz1eowjdml31SkNeSPT6zWRaVW1wnyZLqDR0="><link rel=icon href=/images/favicon.ico type=image/icon><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},processEscapes:true,svg:{fontCache:'global'}};</script><script id=MathJax-script async src=/js/mathjax/es5/tex-mml-chtml.js></script><script src=/js/entries.js></script><script src=/js/flexsearch.min.js></script><script src=/js/header-search.js></script></head><body class=mathjax_ignore><aside><div><div><a href=/><img src=/images/afp.png alt="Logo of the Archive of Formal Proofs" class=logo></a><ul><a href=/><li>Home</li></a><a href=/topics/><li>Topics</li></a><a href=/download/><li>Download</li></a><a href=/help/><li>Help</li></a><a href=/statistics/><li>Statistics</li></a><a href=/about/><li>About</li></a></ul></div><ul><a href=/contribution/><li>Contribution</li></a></ul></div></aside><div class="content entries"><header><form action=/%20search><div class=form-container><input id=searchInput type=search size=31 maxlength=255><button id=searchButton type=button><img src=/images/search.svg alt=Search></button><div id=searchInputautocomplete-list style=display:none><div></div></div></div></form><h1><span class=first>A</span> <span class=first>R</span>eduction <span class=first>T</span>heorem for <span class=first>S</span>tore <span class=first>B</span>uffers</h1><div><p><a href=/authors/ernie-cohen>Ernie Cohen</a> and <a href=/authors/norbert-schirmer>Norbert Schirmer</a></p><p class=date>7 January 2019</p></div></header><div><main><h3>Abstract</h3><p class="abstract mathjax_process">When verifying a concurrent program, it is usual to assume that memory
is sequentially consistent. However, most modern multiprocessors
depend on store buffering for efficiency, and provide native
sequential consistency only at a substantial performance penalty. To
regain sequential consistency, a programmer has to follow an
appropriate programming discipline. However, na&iuml;ve disciplines,
such as protecting all shared accesses with locks, are not flexible
enough for building high-performance multiprocessor software. We
present a new discipline for concurrent programming under TSO (total
store order, with store buffer forwarding). It does not depend on
concurrency primitives, such as locks. Instead, threads use ghost
operations to acquire and release ownership of memory addresses. A
thread can write to an address only if no other thread owns it, and
can read from an address only if it owns it or it is shared and the
thread has flushed its store buffer since it last wrote to an address
it did not own. This discipline covers both coarse-grained concurrency
(where data is protected by locks) as well as fine-grained concurrency
(where atomic operations race to memory). We formalize this
discipline in Isabelle/HOL, and prove that if every execution of a
program in a system without store buffers follows the discipline, then
every execution of the program with store buffers is sequentially
consistent. Thus, we can show sequential consistency under TSO by
ordinary assertional reasoning about the program, without having to
consider store buffers at all.</p><a href=http://isa-afp.org/LICENSE>BSD License</a><h3>Theories</h3><ul><li><a href=theories/#PIMP>PIMP</a></li><li><a href=theories/#SyntaxTweaks>SyntaxTweaks</a></li><li><a href=theories/#ReduceStoreBufferSimulation>ReduceStoreBufferSimulation</a></li><li><a href=theories/#Preliminaries>Preliminaries</a></li><li><a href=theories/#ReduceStoreBuffer>ReduceStoreBuffer</a></li><li><a href=theories/#Abbrevs>Abbrevs</a></li><li><a href=theories/#Text>Text</a></li><li><a href=theories/#Variants>Variants</a></li></ul><h3>Topics</h3><ul><li><a href=/topics/computer-science/concurrency>Computer science/Concurrency</a></li></ul></main><nav class=links><a class=popUpButton href=#citePopUp>Cite</a>
<a class=popUpButton href=#downloadPopUp>Download</a><h4>PDFs</h4><a href=https://www.isa-afp.org/browser_info/current/AFP/Store_Buffer_Reduction/outline.pdf>Proof
outline</a>
<a href=https://www.isa-afp.org/browser_info/current/AFP/Store_Buffer_Reduction/document.pdf>Proof
document</a>
<a href=https://www.isa-afp.org/browser_info/current/AFP/Store_Buffer_Reduction/session_graph.pdf>Dependencies</a></nav><div id=citePopUp class=overlay><a class=cancel href=#></a><div class=popup><h2>Cite</h2><a class=close href=#>&#215;</a><div><p style=display:none id=bibtexFileName>Store_Buffer_Reduction-AFP</p><pre id=copyText>@article{Store_Buffer_Reduction-AFP,
  author  = {Ernie Cohen and Norbert Schirmer},
  title   = {A Reduction Theorem for Store Buffers},
  journal = {Archive of Formal Proofs},
  month   = January,
  year    = 2019,
  note    = {\url{http://isa-afp.org/entries/Store_Buffer_Reduction.html},
            Formal proof development},
  ISSN    = {2150-914x},
}</pre><button id=copyBibtex>Copy</button> <a id=downloadBibtex>Download</a></div></div></div><div id=downloadPopUp class=overlay><a class=cancel href=#></a><div class=popup><h2>Download</h2><a class=close href=#>&#215;</a>
<a href=https://isa-afp.org/release/afp-Store_Buffer_Reduction-current.tar.gz download>Download latest</a><p>Older releases:</p><ul><li>Isabelle2019:
<a href=https://isa-afp.org/release/afp-Store_Buffer_Reduction-2019-06-11.tar.gz>afp-Store_Buffer_Reduction-2019-06-11.tar.gz</a></li><li>Isabelle2018:
<a href=https://isa-afp.org/release/afp-Store_Buffer_Reduction-2019-01-11.tar.gz>afp-Store_Buffer_Reduction-2019-01-11.tar.gz</a></li></ul></div></div></div></div></body></html>